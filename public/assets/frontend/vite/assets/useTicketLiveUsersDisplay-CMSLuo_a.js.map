{"version":3,"file":"useTicketLiveUsersDisplay-CMSLuo_a.js","sources":["../../../../../app/frontend/shared/entities/ticket/composables/useTicketLiveUsersDisplay.ts"],"sourcesContent":["// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { ref, type Ref, watch } from 'vue'\n\nimport { useReactiveNow } from '#shared/composables/useReactiveNow.ts'\n\nimport type { TicketLiveAppUser } from '../types.ts'\n\n// Default idle time from 5 minutes.\nconst IDLE_TIME_MS = 5 * 60 * 1000\n\nexport const useTicketLiveUsersDisplay = (\n  liveUserList: Ref<TicketLiveAppUser[]>,\n) => {\n  const liveUsers = ref<TicketLiveAppUser[]>([])\n  const viewingUsers = ref<TicketLiveAppUser[]>([])\n  const idleUsers = ref<TicketLiveAppUser[]>([])\n\n  const reactiveNow = useReactiveNow()\n\n  watch(\n    [liveUserList, reactiveNow],\n    () => {\n      const localLiveUsers: TicketLiveAppUser[] = []\n\n      liveUserList.value?.forEach((liveUser) => {\n        if (\n          liveUser.lastInteraction &&\n          new Date(liveUser.lastInteraction).getTime() + IDLE_TIME_MS <\n            reactiveNow.value.getTime()\n        ) {\n          localLiveUsers.push({\n            user: liveUser.user,\n            editing: liveUser.editing,\n            app: liveUser.app,\n            isIdle: true,\n          })\n        } else {\n          localLiveUsers.push({\n            user: liveUser.user,\n            editing: liveUser.editing,\n            app: liveUser.app,\n            isIdle: false,\n          })\n        }\n      })\n\n      liveUsers.value = localLiveUsers\n      viewingUsers.value = localLiveUsers.filter((user) => !user.isIdle)\n      idleUsers.value = localLiveUsers.filter((user) => user.isIdle)\n    },\n    { immediate: true },\n  )\n\n  return {\n    liveUsers,\n    viewingUsers,\n    idleUsers,\n  }\n}\n"],"names":["IDLE_TIME_MS","useTicketLiveUsersDisplay","liveUserList","liveUsers","ref","viewingUsers","idleUsers","reactiveNow","useReactiveNow","watch","localLiveUsers","_a","liveUser","user"],"mappings":"sFASA,MAAMA,EAAe,EAAI,GAAK,IAEjBC,EACXC,GACG,CACG,MAAAC,EAAYC,EAAyB,CAAA,CAAE,EACvCC,EAAeD,EAAyB,CAAA,CAAE,EAC1CE,EAAYF,EAAyB,CAAA,CAAE,EAEvCG,EAAcC,IAEpB,OAAAC,EACE,CAACP,EAAcK,CAAW,EAC1B,IAAM,OACJ,MAAMG,EAAsC,CAAA,GAE/BC,EAAAT,EAAA,QAAA,MAAAS,EAAO,QAASC,GAAa,CAEtCA,EAAS,iBACT,IAAI,KAAKA,EAAS,eAAe,EAAE,QAAA,EAAYZ,EAC7CO,EAAY,MAAM,UAEpBG,EAAe,KAAK,CAClB,KAAME,EAAS,KACf,QAASA,EAAS,QAClB,IAAKA,EAAS,IACd,OAAQ,EAAA,CACT,EAEDF,EAAe,KAAK,CAClB,KAAME,EAAS,KACf,QAASA,EAAS,QAClB,IAAKA,EAAS,IACd,OAAQ,EAAA,CACT,CACH,GAGFT,EAAU,MAAQO,EAClBL,EAAa,MAAQK,EAAe,OAAQG,GAAS,CAACA,EAAK,MAAM,EACjEP,EAAU,MAAQI,EAAe,OAAQG,GAASA,EAAK,MAAM,CAC/D,EACA,CAAE,UAAW,EAAK,CAAA,EAGb,CACL,UAAAV,EACA,aAAAE,EACA,UAAAC,CAAA,CAEJ"}