import{f as le,t as $,c as O,r as M,w as ae,k as se,a1 as re,m as a,D as m,y as ne,I as P,E as i,p as o,q as ie,u,M as v,H as c,W as S,L as g,J as x,x as j,Q as b,n as H}from"./vue-oicRkvo0.js";import{c as oe,d as ue,a as ce,bj as de}from"./overviewAttributes.api-C09LSZ8O.js";import{b as me}from"./routes-CgLO9M4y.js";import{_ as pe}from"./CommonDialog.vue_vue_type_script_setup_true_lang-CID2Z6MI.js";import{l as fe,p as he}from"./mobile-Bk4bKGxF.js";import{e as ve}from"./lodash-pFOI14f-.js";import"./vendor-C11O1Xx8.js";import"./commonjsHelpers-BosuxZz1.js";import"./apollo-Cj5TVUDk.js";import"./formkit-5nol1GBe.js";import"./vite-FJshFMF2.js";import"./pwa-THoW_3xc.js";import"./add.api-CxwFhgGn.js";import"./datepicker-BBNcWeHz.js";import"./date-B2UyDZN7.js";const ge={class:"w-full p-4"},xe=["aria-label"],be={class:"grow font-semibold text-white/80"},ye=["aria-label","aria-multiselectable"],ke=["id","aria-selected","aria-setsize","aria-posinset","data-value","aria-haspopup","aria-expanded","aria-disabled","onClick","onKeyup","onKeypress"],we={key:2,class:"relative flex h-[58px] items-center justify-center self-stretch px-4 py-5 text-base leading-[19px] text-white/50",role:"alert"},Le=le({__name:"FieldTreeSelectInputDialog",props:{context:{},name:{},currentPath:{},flatOptions:{},sortedOptions:{}},emits:["push","pop"],setup(U,{emit:q}){const s=U,{isCurrentValue:p}=oe($(s,"context")),F=q,T=me(),f=O(()=>s.currentPath[s.currentPath.length-1]??null),n=M(""),z=M(),y=()=>{n.value=""},k=()=>{he(s.name),y()},J=e=>{F("push",e)},Q=()=>{F("pop")},I=$(s,"context");ae(()=>I.value.noFiltering,y);const N=e=>{!e||!e.length||e[0].focus()},{dialog:D,getSelectedOptionLabel:W,selectOption:_,getDialogFocusTargets:V,getSelectedOption:G}=ue($(s,"flatOptions"),I),K=()=>{Q(),y(),H(()=>N(V(!0)))},R=e=>{e&&e.hasChildren&&(J(e),H(()=>N(V(!0))))};ce(()=>{var e;return(e=D.value)==null?void 0:e.parentElement},{filterOption:e=>e.tagName!=="INPUT",direction:"vertical",onArrowRight(){const e=document.activeElement,{value:l}=(e==null?void 0:e.dataset)||{},r=l?G(l):void 0;return R(r),!1},onArrowLeft(){return K(),!1}});const B=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),w=O(()=>{let e=s.sortedOptions;f.value&&(e=s.sortedOptions.filter(r=>{var h;return r.parents.includes((h=f.value)==null?void 0:h.value)}));const l=new RegExp(ve(B(n.value.trim())),"i");return e.filter(r=>l.test(B(r.label||String(r.value))))}),C=e=>{s.context.disabled||(_(e),s.context.multiple||k())},L=O(()=>f.value?s.sortedOptions.filter(e=>{var l;return e.parents.length&&e.parents[e.parents.length-1]===((l=f.value)==null?void 0:l.value)}):s.sortedOptions.filter(e=>{var l;return!((l=e.parents)!=null&&l.length)})),E=()=>{K()},X=e=>{s.context.disabled||R(e)},Y=e=>{s.context.disabled||(C(e),k())};se(()=>{var e;(e=z.value)==null||e.focus()});const Z=e=>s.flatOptions.findIndex(l=>l.value===e.value);return(e,l)=>{const r=re("CommonIcon");return a(),m(pe,{name:e.name,label:e.context.label,onClose:k},{default:ne(()=>{var h;return[P("div",ge,[e.context.noFiltering?i("",!0):(a(),m(de,{key:0,ref_key:"filterInput",ref:z,modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=t=>n.value=t)},null,8,["modelValue"]))]),e.currentPath.length?(a(),o("div",{key:0,class:c([{"px-6":!e.context.noFiltering},"focus:bg-blue-highlight flex h-[58px] cursor-pointer items-center self-stretch px-4 py-5 text-base leading-[19px] text-white focus:outline-hidden"]),tabindex:"0",role:"button","aria-label":e.$t("Back to previous page"),onClick:l[1]||(l[1]=t=>E()),onKeypress:l[2]||(l[2]=S(g(t=>E(),["prevent"]),["space"]))},[ie(r,{size:"base",class:"ltr:mr-3 rtl:ml-3",name:`chevron-${((h=u(T).localeData)==null?void 0:h.dir)==="rtl"?"right":"left"}`},null,8,["name"]),P("span",be,v(f.value.label||f.value.value),1)],42,xe)):i("",!0),(n.value?w.value.length:L.value.length)?(a(),o("div",{key:1,ref_key:"dialog",ref:D,class:c([{"border-t border-white/30":e.currentPath.length},"flex grow flex-col items-start self-stretch overflow-y-auto"]),"aria-label":e.$t("Select…"),role:"listbox","aria-multiselectable":e.context.multiple},[(a(!0),o(x,null,j(n.value?w.value:L.value,(t,ee)=>{var A;return a(),o("div",{id:`${e.name}-${t.value}`,key:String(t.value),class:c([{"px-6":!e.context.noFiltering,"pointer-events-none":t.disabled},"focus:bg-blue-highlight relative flex h-[58px] cursor-pointer items-center self-stretch px-4 py-5 text-base leading-[19px] text-white focus:outline-hidden"]),tabindex:"0",role:"option","aria-selected":t.disabled?void 0:u(p)(t.value),"aria-setsize":e.flatOptions.length,"aria-posinset":Z(t)+1,"data-value":t.value,"aria-haspopup":t.hasChildren&&!n.value?"menu":"false","aria-expanded":t.hasChildren&&!n.value?"false":void 0,"aria-disabled":t.disabled?"true":void 0,onClick:d=>C(t),onKeyup:S(g(d=>Y(t),["prevent"]),["enter"]),onKeypress:S(g(d=>C(t),["prevent"]),["space"])},[ee!==0?(a(),o("div",{key:0,class:c([{"ltr:left-4 rtl:right-4":!e.context.multiple&&!t.icon&&!t.status,"ltr:left-[50px] rtl:right-[50px]":!e.context.multiple&&t.icon&&!t.status,"ltr:left-[58px] rtl:right-[58px]":!e.context.multiple&&!t.icon&&t.status,"ltr:left-[60px] rtl:right-[60px]":e.context.multiple&&!t.icon&&!t.status,"ltr:left-[88px] rtl:right-[88px]":e.context.multiple&&t.icon&&!t.status,"ltr:left-[94px] rtl:right-[94px]":e.context.multiple&&!t.icon&&t.status},"absolute top-0 h-0 border-t border-white/10 ltr:right-4 rtl:left-4"])},null,2)):i("",!0),e.context.multiple?(a(),m(r,{key:1,class:c([{"!text-white":u(p)(t.value),"opacity-30":t.disabled},"text-white/50 ltr:mr-3 rtl:ml-3"]),name:u(p)(t.value)?"check-box-yes":"check-box-no",size:"base",decorative:""},null,8,["class","name"])):i("",!0),t.status?(a(),m(fe,{key:2,"color-code":t.status,label:t.label||String(t.value),class:c([{"opacity-30":t.disabled},"ltr:mr-[11px] rtl:ml-[11px]"])},null,8,["color-code","label","class"])):t.icon?(a(),m(r,{key:3,name:t.icon,class:c([{"!text-white":u(p)(t.value),"opacity-30":t.disabled},"text-white/80 ltr:mr-[11px] rtl:ml-[11px]"]),size:"small"},null,8,["name","class"])):i("",!0),P("span",{class:c([{"font-semibold !text-white":u(p)(t.value),"opacity-30":t.disabled},"grow text-white/80"])},[b(v(t.label||t.value)+" ",1),n.value?(a(!0),o(x,{key:0},j(t.parents,(d,te)=>(a(),o("span",{key:String(d),class:"text-gray"},[te===0?(a(),o(x,{key:0},[b(" — ")],64)):(a(),o(x,{key:1},[b(" › ")],64)),b(" "+v(u(W)(d)||e.i18n.t("%s (unknown)",d.toString())),1)]))),128)):i("",!0)],2),!e.context.multiple&&u(p)(t.value)?(a(),m(r,{key:4,class:c({"opacity-30":t.disabled,"ltr:mr-3 rtl:ml-3":t.hasChildren}),size:"tiny",decorative:"",name:"check"},null,8,["class"])):i("",!0),t.hasChildren&&!n.value?(a(),m(r,{key:5,class:"pointer-events-auto",size:"base",name:`chevron-${((A=u(T).localeData)==null?void 0:A.dir)==="rtl"?"left":"right"}`,role:"link",label:e.$t("Has submenu"),onClick:g(d=>X(t),["stop"])},null,8,["name","label","onClick"])):i("",!0)],42,ke)}),128))],10,ye)):i("",!0),n.value&&!w.value.length?(a(),o("div",we,v(e.$t("No results found")),1)):i("",!0)]}),_:1},8,["name","label"])}}});export{Le as default};
//# sourceMappingURL=FieldTreeSelectInputDialog-CtooeHyJ.js.map
