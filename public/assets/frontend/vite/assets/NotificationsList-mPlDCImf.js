import{f as C,t as S,a1 as A,u as o,m as s,D as f,y as w,I as c,q as g,F as T,E as h,p as _,H as $,c as b,r as D,x as I,J as L,M as x,W as O}from"./vue-oicRkvo0.js";import{a as Q,b as M,u as U}from"./useOnlineNotificationActions-CIHAkwwp.js";import{u as V}from"./useOnlineNotificationCount-CN5COmqb.js";import{Q as z}from"./apollo-Cj5TVUDk.js";import{_ as E,b7 as F,m as K,an as j}from"./overviewAttributes.api-C09LSZ8O.js";import{_ as q}from"./CommonLoader.vue_vue_type_script_setup_true_lang-BtrvaoyW.js";import{u as J}from"./useHeader-B3UlgUtw.js";import"./vendor-C11O1Xx8.js";import"./commonjsHelpers-BosuxZz1.js";import"./getUserDisplayName-Dg0PCZQh.js";import"./lodash-pFOI14f-.js";import"./routes-CgLO9M4y.js";import"./vite-FJshFMF2.js";import"./seen.api-DLK-LLmy.js";import"./formkit-5nol1GBe.js";const W={class:"flex items-center ltr:mr-4 rtl:ml-4"},G={class:"flex flex-col"},P=["innerHTML"],X={class:"text-gray mt-1 flex"},Y=C({__name:"ActivityMessage",props:{activity:{}},emits:["seen"],setup(p){const a=p,{builder:m,message:u,link:t}=Q(S(a,"activity"));return(e,r)=>{const d=A("CommonDateTime");return o(m)?(s(),f(T(o(t)?"CommonLink":"div"),{key:0,class:"flex flex-1 border-b border-white/10 py-4",link:o(t),onClick:r[0]||(r[0]=i=>e.activity.seen?void 0:e.$emit("seen"))},{default:w(()=>[c("div",W,[e.activity.createdBy?(s(),f(E,{key:0,entity:e.activity.createdBy,"no-indicator":""},null,8,["entity"])):(s(),f(F,{key:1,class:"bg-red-bright text-white",icon:"lock"}))]),c("div",G,[c("div",{class:"text-lg leading-5",innerHTML:o(K)(o(u))},null,8,P),c("div",X,[g(d,{"date-time":e.activity.createdAt,type:"relative"},null,8,["date-time"])])])]),_:1},8,["link"])):h("",!0)}}}),Z={class:"flex"},ee=["disabled"],te={class:"flex items-center ltr:pr-2 rtl:pl-2"},ie=["aria-label"],ne=C({__name:"NotificationItem",props:{activity:{}},emits:["remove","seen"],setup(p,{emit:a}){const m=p,u=a,{deleteNotification:t,deleteNotificationMutation:e}=M(),r=e.loading(),d=()=>(u("remove",m.activity.id),t(m.activity.id));return(i,l)=>{const v=A("CommonIcon");return s(),_("div",Z,[c("button",{class:$(["flex items-center ltr:pr-2 rtl:pl-2",{"cursor-pointer":!o(r),"opacity-50":o(r)}]),disabled:o(r),onClick:l[0]||(l[0]=k=>d())},[g(v,{name:"delete",class:"text-red",size:"tiny"})],10,ee),c("div",te,[c("div",{role:"status",class:$(["h-3 w-3 rounded-full",{"bg-blue":!i.activity.seen}]),"aria-label":i.activity.seen?i.$t("Notification read"):i.$t("Unread notification")},null,10,ie)]),g(Y,{activity:i.activity,onSeen:l[1]||(l[1]=k=>i.$emit("seen",i.activity.id))},null,8,["activity"])])}}}),oe={class:"ltr:pr-4 ltr:pl-3 rtl:pr-3 rtl:pl-4"},se={key:0,class:"px-4 py-3 text-center text-base"},he=C({__name:"NotificationsList",setup(p){const a=new z(U()),m=a.loading(),u=a.result();let t=!1;J({backUrl:"/",backAvoidHomeButton:!0,refetch:b(()=>m.value&&u.value!=null)});const e=b(()=>{var n;return j((n=u.value)==null?void 0:n.onlineNotifications)}),{seenNotification:r,markAllRead:d}=M(),i=n=>{t=!0,r(n)},l=D(!1),v=async()=>{l.value=!0;const n=e.value.filter(y=>!y.seen).map(y=>y.id);t=!0,await d(n),l.value=!1},k=()=>{t=!0},{unseenCount:B,notificationsCountSubscription:H}=V();H.watchOnResult(()=>{a.refetch(),t||a.refetch(),t=!1});const R=b(()=>B.value>0);return(n,y)=>(s(),f(q,{loading:!e.value.length&&o(m)},{default:w(()=>[c("div",oe,[(s(!0),_(L,null,I(e.value,N=>(s(),f(ne,{key:N.id,activity:N,onRemove:k,onSeen:i},null,8,["activity"]))),128)),e.value.length?h("",!0):(s(),_("div",se,x(n.$t("No entries")),1)),R.value?(s(),_("div",{key:1,class:$(["text-blue flex flex-1 cursor-pointer justify-center px-4 py-3 text-base",{"text-red":l.value}]),role:"button",tabindex:"0",onKeydown:O(v,["enter"]),onClick:v},x(n.$t("Mark all as read")),35)):h("",!0)])]),_:1},8,["loading"]))}});export{he as default};
//# sourceMappingURL=NotificationsList-mPlDCImf.js.map
