{"version":3,"file":"theme-Bv2ClBzZ.js","sources":["../../../../../app/frontend/shared/composables/useTransitionConfig.ts","../../../../../app/frontend/shared/components/CommonPopover/usePopoverInstances.ts","../../../../../app/frontend/shared/components/CommonPopover/CommonPopover.vue","../../../../../app/frontend/shared/components/CommonPopover/usePopover.ts","../../../../../app/frontend/apps/desktop/pages/personal-setting/graphql/mutations/userCurrentAppearance.api.ts","../../../../../app/frontend/apps/desktop/stores/theme.ts"],"sourcesContent":["// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { getAbstracts } from '#shared/initializer/initializeAbstracts.ts'\n\nexport const useTransitionConfig = () => {\n  const durations = {\n    normal: VITE_TEST_MODE ? undefined : getAbstracts().durations.normal,\n  }\n\n  const isTestMode = VITE_TEST_MODE\n\n  return { durations, isTestMode }\n}\n","// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { computed, ref } from 'vue'\n\nimport type { CommonPopoverInternalInstance } from './types.ts'\nimport type { ComputedRef } from 'vue'\n\nconst instances = ref(\n  new Set<CommonPopoverInternalInstance>(),\n) as unknown as ComputedRef<Set<CommonPopoverInternalInstance>>\n\nexport const usePopoverInstances = () => {\n  const isOpened = computed(() => {\n    for (const instance of instances.value) {\n      if (instance.isOpen.value) {\n        return true\n      }\n    }\n    return false\n  })\n\n  return {\n    isOpened,\n    instances,\n  }\n}\n","<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport {\n  onClickOutside,\n  onKeyUp,\n  useElementBounding,\n  useWindowSize,\n  type UseElementBoundingReturn,\n} from '@vueuse/core'\nimport {\n  type ComponentPublicInstance,\n  computed,\n  nextTick,\n  onMounted,\n  onUnmounted,\n  ref,\n  type UnwrapRef,\n  useTemplateRef,\n} from 'vue'\n\nimport { useTransitionConfig } from '#shared/composables/useTransitionConfig.ts'\nimport { useTrapTab } from '#shared/composables/useTrapTab.ts'\nimport { EnumTextDirection } from '#shared/graphql/types.ts'\nimport { getPopoverClasses } from '#shared/initializer/initializePopover.ts'\nimport { useLocaleStore } from '#shared/stores/locale.ts'\nimport stopEvent from '#shared/utils/events.ts'\nimport testFlags from '#shared/utils/testFlags.ts'\n\nimport { usePopoverInstances } from './usePopoverInstances.ts'\n\nimport type {\n  Placement,\n  CommonPopoverInternalInstance,\n  Orientation,\n} from './types.ts'\n\nexport interface Props {\n  owner: HTMLElement | ComponentPublicInstance | undefined\n  orientation?: Orientation\n  placement?: Placement\n  hideArrow?: boolean\n  id?: string\n  noAutoFocus?: boolean\n  persistent?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placement: 'start',\n  orientation: 'autoVertical',\n})\n\nconst emit = defineEmits<{\n  open: []\n  close: []\n}>()\n\nconst popoverElement = useTemplateRef('popover')\n\nconst showPopover = ref(false)\n\nconst targetElementBounds = ref<UnwrapRef<UseElementBoundingReturn>>()\nconst windowSize = useWindowSize()\n\nconst hasDirectionUp = computed(() => {\n  if (!targetElementBounds.value || !windowSize.height) return false\n  return targetElementBounds.value.y > windowSize.height.value / 2\n})\n\nconst hasDirectionRight = computed(() => {\n  if (!targetElementBounds.value || !windowSize.width) return false\n\n  return targetElementBounds.value.x < windowSize.width.value / 2\n})\n\nconst locale = useLocaleStore()\n\nconst autoOrientation = computed(() => {\n  if (props.orientation === 'autoVertical') {\n    return hasDirectionUp.value ? 'top' : 'bottom'\n  }\n\n  if (props.orientation === 'autoHorizontal') {\n    return hasDirectionRight.value ? 'right' : 'left'\n  }\n\n  if (locale.localeData?.dir === EnumTextDirection.Rtl) {\n    if (props.orientation === 'left') return 'right'\n    if (props.orientation === 'right') return 'left'\n  }\n\n  return props.orientation\n})\n\nconst verticalOrientation = computed(() => {\n  return autoOrientation.value === 'top' || autoOrientation.value === 'bottom'\n})\n\n// eslint-disable-next-line sonarjs/cognitive-complexity\nconst currentPlacement = computed(() => {\n  if (props.placement === 'arrowStart' || props.placement === 'arrowEnd') {\n    if (locale.localeData?.dir === EnumTextDirection.Rtl) {\n      if (props.placement === 'arrowStart') return 'arrowEnd'\n      return 'arrowStart'\n    }\n    return props.placement\n  }\n\n  if (verticalOrientation.value) {\n    if (locale.localeData?.dir === EnumTextDirection.Rtl) {\n      if (props.placement === 'start') return 'end'\n      if (props.placement === 'end') return 'start'\n      return props.hideArrow ? 'start' : 'arrowStart'\n    }\n    return props.placement\n  }\n  if (hasDirectionUp.value) return props.hideArrow ? 'end' : 'arrowEnd'\n  return props.hideArrow ? 'start' : 'arrowStart'\n})\n\nconst BORDER_OFFSET = 2\nconst PLACEMENT_OFFSET_WO_ARROW = 16\nconst PLACEMENT_OFFSET_WITH_ARROW = 30\nconst ORIENTATION_OFFSET_WO_ARROW = 6\nconst ORIENTATION_OFFSET_WITH_ARROW = 16\n\n// eslint-disable-next-line sonarjs/cognitive-complexity\nconst popoverStyle = computed(() => {\n  if (!targetElementBounds.value) return { top: 0, left: 0, maxHeight: 0 }\n\n  const maxHeight = hasDirectionUp.value\n    ? targetElementBounds.value.top\n    : windowSize.height.value - targetElementBounds.value.bottom\n\n  const style: Record<string, string> = {\n    maxHeight: `${verticalOrientation.value ? maxHeight - 24 : maxHeight + 34}px`,\n  }\n\n  const arrowOffset = props.hideArrow\n    ? PLACEMENT_OFFSET_WO_ARROW\n    : PLACEMENT_OFFSET_WITH_ARROW\n\n  const placementOffset = targetElementBounds.value.width / 2 - arrowOffset\n\n  if (verticalOrientation.value) {\n    if (currentPlacement.value === 'start') {\n      style.left = `${targetElementBounds.value.left - BORDER_OFFSET}px`\n    } else if (currentPlacement.value === 'arrowStart') {\n      style.left = `${targetElementBounds.value.left + placementOffset + BORDER_OFFSET}px`\n    } else if (currentPlacement.value === 'arrowEnd') {\n      style.right = `${windowSize.width.value - targetElementBounds.value.left + placementOffset - targetElementBounds.value.width - BORDER_OFFSET}px`\n    } else if (currentPlacement.value === 'end') {\n      style.right = `${windowSize.width.value - targetElementBounds.value.left - targetElementBounds.value.width - BORDER_OFFSET}px`\n    }\n  } else if (!verticalOrientation.value) {\n    if (currentPlacement.value === 'start') {\n      style.top = `${targetElementBounds.value.top - BORDER_OFFSET}px`\n    } else if (currentPlacement.value === 'arrowStart') {\n      style.top = `${targetElementBounds.value.bottom - targetElementBounds.value.height / 2 - arrowOffset + BORDER_OFFSET}px`\n    } else if (currentPlacement.value === 'arrowEnd') {\n      style.bottom = `${windowSize.height.value - targetElementBounds.value.bottom + targetElementBounds.value.height / 2 - arrowOffset - BORDER_OFFSET}px`\n    } else if (currentPlacement.value === 'end') {\n      style.bottom = `${windowSize.height.value - targetElementBounds.value.bottom - BORDER_OFFSET}px`\n    }\n  }\n\n  const orientationOffset = props.hideArrow\n    ? ORIENTATION_OFFSET_WO_ARROW\n    : ORIENTATION_OFFSET_WITH_ARROW\n\n  switch (autoOrientation.value) {\n    case 'top':\n      style.bottom = `${windowSize.height.value - targetElementBounds.value.top + orientationOffset}px`\n      break\n    case 'bottom':\n      style.top = `${\n        targetElementBounds.value.top +\n        targetElementBounds.value.height +\n        orientationOffset\n      }px`\n      break\n    case 'left':\n      style.right = `${windowSize.width.value - targetElementBounds.value.left + orientationOffset}px`\n      break\n    case 'right':\n      style.left = `${targetElementBounds.value.right + orientationOffset}px`\n      break\n    default:\n  }\n\n  return style\n})\n\nconst arrowPlacementClasses = computed(() => {\n  const classes: Record<string, boolean> = {\n    // eslint-disable-next-line zammad/zammad-tailwind-ltr\n    '-translate-x-1/2': verticalOrientation.value,\n    '-translate-y-1/2': !verticalOrientation.value,\n  }\n\n  switch (autoOrientation.value) {\n    case 'bottom':\n      Object.assign(classes, {\n        '-top-[11px]': true,\n        'border-l-0 border-b-0': true,\n      })\n      break\n    case 'top':\n      Object.assign(classes, {\n        '-bottom-[11px]': true,\n        'border-r-0 border-t-0': true,\n      })\n      break\n    case 'left':\n      Object.assign(classes, {\n        // eslint-disable-next-line zammad/zammad-tailwind-ltr\n        '-right-[11px]': true,\n        'border-t-0 border-l-0': true,\n      })\n      break\n    case 'right':\n      Object.assign(classes, {\n        // eslint-disable-next-line zammad/zammad-tailwind-ltr\n        '-left-[11px]': true,\n        'border-b-0 border-r-0': true,\n      })\n      break\n    default:\n  }\n\n  if (verticalOrientation.value) {\n    if (\n      currentPlacement.value === 'start' ||\n      currentPlacement.value === 'arrowStart'\n    ) {\n      // eslint-disable-next-line zammad/zammad-tailwind-ltr\n      classes['left-7'] = true\n    } else if (\n      currentPlacement.value === 'end' ||\n      currentPlacement.value === 'arrowEnd'\n    ) {\n      // eslint-disable-next-line zammad/zammad-tailwind-ltr\n      classes['right-2'] = true\n    }\n  } else if (!verticalOrientation.value) {\n    if (\n      currentPlacement.value === 'start' ||\n      currentPlacement.value === 'arrowStart'\n    ) {\n      classes['top-7'] = true\n    } else if (\n      currentPlacement.value === 'end' ||\n      currentPlacement.value === 'arrowEnd'\n    ) {\n      classes['bottom-2'] = true\n    }\n  }\n\n  return classes\n})\n\nconst { moveNextFocusToTrap } = useTrapTab(popoverElement)\n\nconst { instances } = usePopoverInstances()\n\nconst updateOwnerAriaExpandedState = () => {\n  const element = props.owner\n  if (!element) return\n\n  if ('ariaExpanded' in element) {\n    element.ariaExpanded = showPopover.value ? 'true' : 'false'\n  }\n}\n\nlet removeOnKeyUpEscapeHandler: () => void\n\nconst closePopover = (isInteractive = false) => {\n  if (!showPopover.value) return\n\n  showPopover.value = false\n  emit('close')\n  removeOnKeyUpEscapeHandler?.()\n\n  nextTick(() => {\n    if (!isInteractive && props.owner) {\n      // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n      '$el' in props.owner ? props.owner.$el?.focus?.() : props.owner?.focus?.()\n    }\n    updateOwnerAriaExpandedState()\n    testFlags.set('common-popover.closed')\n  })\n}\n\nconst openPopover = () => {\n  if (showPopover.value) return\n\n  targetElementBounds.value = useElementBounding(\n    props.owner,\n  ) as unknown as UnwrapRef<UseElementBoundingReturn>\n\n  instances.value.forEach((instance) => {\n    if (instance.isOpen.value) instance.closePopover()\n  })\n\n  showPopover.value = true\n  emit('open')\n\n  removeOnKeyUpEscapeHandler = onKeyUp('Escape', (e) => {\n    if (!showPopover.value) return\n\n    stopEvent(e)\n    closePopover()\n  })\n\n  onClickOutside(popoverElement, () => closePopover(true), {\n    ignore: [props.owner],\n  })\n\n  requestAnimationFrame(() => {\n    nextTick(() => {\n      if (!props.noAutoFocus) moveNextFocusToTrap()\n      updateOwnerAriaExpandedState()\n      testFlags.set('common-popover.opened')\n    })\n  })\n}\n\nconst togglePopover = (isInteractive = false) => {\n  if (showPopover.value) {\n    closePopover(isInteractive)\n  } else {\n    openPopover()\n  }\n}\n\nconst exposedInstance: CommonPopoverInternalInstance = {\n  isOpen: computed(() => showPopover.value),\n  openPopover,\n  closePopover,\n  togglePopover,\n}\n\ninstances.value.add(exposedInstance)\n\nonUnmounted(() => {\n  instances.value.delete(exposedInstance)\n  removeOnKeyUpEscapeHandler?.()\n})\n\ndefineExpose(exposedInstance)\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst { durations } = useTransitionConfig()\n\nconst classes = getPopoverClasses()\n\nonMounted(() => {\n  testFlags.set(\n    props.id ? `common-popover.mounted-${props.id}` : 'common-popover.mounted',\n  )\n})\n</script>\n\n<template>\n  <Teleport to=\"body\">\n    <Transition name=\"fade\" :duration=\"durations.normal\">\n      <div\n        v-if=\"persistent\"\n        v-show=\"showPopover\"\n        :id=\"id\"\n        ref=\"popover\"\n        role=\"region\"\n        class=\"popover fixed z-50 flex\"\n        :class=\"[classes.base]\"\n        :style=\"popoverStyle\"\n        :aria-labelledby=\"owner && '$el' in owner ? owner.$el?.id : owner?.id\"\n        v-bind=\"$attrs\"\n      >\n        <div class=\"w-full overflow-y-auto\">\n          <slot />\n        </div>\n        <div\n          v-if=\"!hideArrow\"\n          class=\"absolute -z-10 -rotate-45 transform\"\n          :class=\"[arrowPlacementClasses, classes.arrow]\"\n        />\n      </div>\n      <div\n        v-else-if=\"showPopover\"\n        :id=\"id\"\n        ref=\"popover\"\n        role=\"region\"\n        class=\"popover fixed z-50 flex\"\n        :class=\"[classes.base]\"\n        :style=\"popoverStyle\"\n        :aria-labelledby=\"owner && '$el' in owner ? owner.$el?.id : owner?.id\"\n        v-bind=\"$attrs\"\n      >\n        <div class=\"w-full overflow-y-auto\">\n          <slot />\n        </div>\n        <div\n          v-if=\"!hideArrow\"\n          class=\"absolute -z-10 -rotate-45 transform\"\n          :class=\"[arrowPlacementClasses, classes.arrow]\"\n        />\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n","// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { computed, shallowRef } from 'vue'\n\nimport type { CommonPopoverInstance } from './types.ts'\nimport type { ShallowRef, Ref } from 'vue'\n\nexport const usePopover = (\n  popoverRef?: Ref<CommonPopoverInstance | undefined>,\n) => {\n  const popover: ShallowRef<CommonPopoverInstance | undefined> =\n    popoverRef || shallowRef()\n  const popoverTarget: ShallowRef<HTMLDivElement | undefined> = shallowRef()\n\n  const isOpen = computed(() => popover.value?.isOpen)\n\n  const open = () => {\n    popover.value?.openPopover()\n  }\n\n  const close = () => {\n    popover.value?.closePopover()\n  }\n\n  const toggle = (isInteractive = false) => {\n    popover.value?.togglePopover(isInteractive)\n  }\n\n  return {\n    popover,\n    popoverTarget,\n    open,\n    close,\n    toggle,\n    isOpen,\n  }\n}\n","import * as Types from '#shared/graphql/types.ts';\n\nimport gql from 'graphql-tag';\nimport { ErrorsFragmentDoc } from '../../../../../../shared/graphql/fragments/errors.api';\nimport * as VueApolloComposable from '@vue/apollo-composable';\nimport * as VueCompositionApi from 'vue';\nexport type ReactiveFunction<TParam> = () => TParam;\n\nexport const UserCurrentAppearanceDocument = gql`\n    mutation userCurrentAppearance($theme: EnumAppearanceTheme!) {\n  userCurrentAppearance(theme: $theme) {\n    success\n    errors {\n      ...errors\n    }\n  }\n}\n    ${ErrorsFragmentDoc}`;\nexport function useUserCurrentAppearanceMutation(options: VueApolloComposable.UseMutationOptions<Types.UserCurrentAppearanceMutation, Types.UserCurrentAppearanceMutationVariables> | ReactiveFunction<VueApolloComposable.UseMutationOptions<Types.UserCurrentAppearanceMutation, Types.UserCurrentAppearanceMutationVariables>> = {}) {\n  return VueApolloComposable.useMutation<Types.UserCurrentAppearanceMutation, Types.UserCurrentAppearanceMutationVariables>(UserCurrentAppearanceDocument, options);\n}\nexport type UserCurrentAppearanceMutationCompositionFunctionResult = VueApolloComposable.UseMutationReturn<Types.UserCurrentAppearanceMutation, Types.UserCurrentAppearanceMutationVariables>;","// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { usePreferredColorScheme } from '@vueuse/core'\nimport { acceptHMRUpdate, defineStore } from 'pinia'\nimport { computed, ref, watch } from 'vue'\n\nimport { EnumAppearanceTheme } from '#shared/graphql/types.ts'\nimport MutationHandler from '#shared/server/apollo/handler/MutationHandler.ts'\nimport { useSessionStore } from '#shared/stores/session.ts'\n\nimport { useUserCurrentAppearanceMutation } from '#desktop/pages/personal-setting/graphql/mutations/userCurrentAppearance.api.ts'\n\ntype AppThemeName = EnumAppearanceTheme.Light | EnumAppearanceTheme.Dark\n\nconst getRoot = () => document.querySelector(':root') as HTMLElement\n\nconst getPreferredTheme = (): AppThemeName => {\n  return window.matchMedia('(prefers-color-scheme: dark)').matches\n    ? EnumAppearanceTheme.Dark\n    : EnumAppearanceTheme.Light\n}\n\nconst sanitizeTheme = (theme: string): AppThemeName => {\n  if (['dark', 'light'].includes(theme)) return theme as AppThemeName\n  return getPreferredTheme()\n}\n\nconst saveDOMTheme = (theme: AppThemeName) => {\n  const root = getRoot()\n\n  root.dataset.theme = theme\n  root.style.colorScheme = theme\n}\n\nexport const useThemeStore = defineStore('theme', () => {\n  const session = useSessionStore()\n\n  const savingTheme = ref(false)\n\n  const setThemeMutation = new MutationHandler(\n    useUserCurrentAppearanceMutation(),\n    {\n      errorNotificationMessage: __('The appearance could not be updated.'),\n    },\n  )\n\n  const saveTheme = (newTheme: AppThemeName) => {\n    const sanitizedTheme = sanitizeTheme(newTheme)\n    saveDOMTheme(sanitizedTheme)\n  }\n\n  const setTheme = async (theme: string) => {\n    const oldTheme = session.user?.preferences?.theme\n\n    session.setUserPreference('theme', theme)\n\n    return setThemeMutation\n      .send({ theme: theme as EnumAppearanceTheme })\n      .catch(() => {\n        session.setUserPreference('theme', oldTheme)\n      })\n  }\n\n  const currentTheme = computed<EnumAppearanceTheme>(\n    () => session.user?.preferences?.theme || EnumAppearanceTheme.Auto,\n  )\n\n  const preferredColorScheme = usePreferredColorScheme()\n\n  const isDarkMode = computed(() => {\n    if (currentTheme.value === EnumAppearanceTheme.Auto) {\n      return preferredColorScheme.value === 'no-preference'\n        ? false // if no system preference, default to light mode\n        : preferredColorScheme.value === EnumAppearanceTheme.Dark\n    }\n    return currentTheme.value === EnumAppearanceTheme.Dark\n  })\n\n  const updateTheme = async (value: EnumAppearanceTheme) => {\n    try {\n      if (value === session.user?.preferences?.theme || savingTheme.value)\n        return\n\n      savingTheme.value = true\n\n      await setTheme(value)\n    } finally {\n      savingTheme.value = false\n    }\n  }\n\n  // sync theme in case HTML value was not up-to-date when we loaded user preferences\n  const syncTheme = () => {\n    if (currentTheme.value !== 'auto') return saveDOMTheme(currentTheme.value)\n    const theme = getPreferredTheme()\n    saveDOMTheme(theme)\n  }\n\n  // Update based on global system level preference\n  watch(preferredColorScheme, (newTheme) => {\n    const theme = (currentTheme.value as AppThemeName) || newTheme\n    saveTheme(theme)\n  })\n\n  // in case user changes the theme in another tab\n  watch(\n    () => currentTheme.value,\n    (newTheme) => {\n      if (newTheme) {\n        saveTheme(newTheme as AppThemeName)\n      }\n    },\n  )\n\n  return {\n    savingTheme,\n    preferredColorScheme,\n    currentTheme,\n    isDarkMode,\n    updateTheme,\n    syncTheme,\n  }\n})\n\nif (import.meta.hot) {\n  import.meta.hot.accept(acceptHMRUpdate(useThemeStore, import.meta.hot))\n}\n"],"names":["useTransitionConfig","getAbstracts","instances","ref","usePopoverInstances","computed","instance","BORDER_OFFSET","PLACEMENT_OFFSET_WO_ARROW","PLACEMENT_OFFSET_WITH_ARROW","ORIENTATION_OFFSET_WO_ARROW","ORIENTATION_OFFSET_WITH_ARROW","props","__props","emit","__emit","popoverElement","useTemplateRef","showPopover","targetElementBounds","windowSize","useWindowSize","hasDirectionUp","hasDirectionRight","locale","useLocaleStore","autoOrientation","_a","EnumTextDirection","verticalOrientation","currentPlacement","_b","popoverStyle","maxHeight","style","arrowOffset","placementOffset","orientationOffset","arrowPlacementClasses","classes","moveNextFocusToTrap","useTrapTab","updateOwnerAriaExpandedState","element","removeOnKeyUpEscapeHandler","closePopover","isInteractive","nextTick","_d","_c","testFlags","openPopover","useElementBounding","onKeyUp","stopEvent","onClickOutside","togglePopover","exposedInstance","onUnmounted","__expose","durations","getPopoverClasses","onMounted","usePopover","popoverRef","popover","shallowRef","popoverTarget","isOpen","UserCurrentAppearanceDocument","gql","ErrorsFragmentDoc","useUserCurrentAppearanceMutation","options","VueApolloComposable.useMutation","getRoot","getPreferredTheme","EnumAppearanceTheme","sanitizeTheme","theme","saveDOMTheme","root","useThemeStore","defineStore","session","useSessionStore","savingTheme","setThemeMutation","MutationHandler","saveTheme","newTheme","sanitizedTheme","setTheme","oldTheme","currentTheme","preferredColorScheme","usePreferredColorScheme","isDarkMode","updateTheme","value","syncTheme","watch"],"mappings":"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"}