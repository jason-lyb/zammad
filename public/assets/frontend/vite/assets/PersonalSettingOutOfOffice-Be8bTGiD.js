import{n as q,u as E}from"./vendor-C11O1Xx8.js";import{e as B,M as U,N as k,c as D}from"./apollo-Cj5TVUDk.js";import{_ as G}from"./Form.vue_vue_type_script_setup_true_lang-B6L-6HzY.js";import{u as H}from"./useForm-CUKec4n5.js";import{X as L,Y as Q,Z as z}from"./overviewAttributes.api-C09LSZ8O.js";import{a as P}from"./routes-CgLO9M4y.js";import{c as V}from"./desktop-l0eJ1dZN.js";import{a as X}from"./LayoutContent.vue_vue_type_script_setup_true_lang-SafgfcNL.js";import{u as Y}from"./useBreadcrumb-DUhE6wbZ.js";import{b as g}from"./lodash-pFOI14f-.js";import{f as Z,c as J,w as K,d as W,m as ee,D as te,y as n,I as h,q as y,u as s,Q as ae,M as re}from"./vue-oicRkvo0.js";import"./commonjsHelpers-BosuxZz1.js";import"./formkit-5nol1GBe.js";import"./FormGroup.vue_vue_type_script_setup_true_lang-DIx-HUKU.js";import"./vite-FJshFMF2.js";import"./useCopyToClipboard-CjkPg__g.js";import"./theme-Bv2ClBzZ.js";import"./datepicker-BBNcWeHz.js";import"./date-B2UyDZN7.js";import"./autocompleteTags.api-CG5-cm_A.js";import"./autocompleteSearchTicket.api-DfOQWGlO.js";import"./ticketUpdates.api-BhGIG_Ti.js";import"./ticketAttributes.api-rqx5ITab.js";import"./useTicketCreateArticleType-D7iVcJ_6.js";import"./types-Cu-Nkl7K.js";import"./useTicketCreateView-HCH46SPv.js";import"./LayoutMain.vue_vue_type_script_setup_true_lang-DIWzj6-0.js";import"./LayoutSidebar.vue_vue_type_script_setup_true_lang-BO1pkKrb.js";import"./useResizeGridColumns-CieKHty_.js";const ie=q`
    mutation userCurrentOutOfOffice($input: OutOfOfficeInput!) {
  userCurrentOutOfOffice(input: $input) {
    success
    errors {
      ...errors
    }
  }
}
    ${L}`;function se(c={}){return B(ie,c)}const oe={class:"mb-4"},ne={class:"mt-5 flex items-center justify-end gap-2"},Be=Z({__name:"PersonalSettingOutOfOffice",setup(c){var m;const{user:t}=E(P()),{form:S,isDisabled:x,onChangedField:I,formReset:F,values:C,isDirty:A}=H(),N=Q([{isLayout:!0,component:"FormGroup",children:[{type:"text",name:"text",label:__("Reason for absence"),placeholder:__("e.g. Easter holiday")},{type:"date",name:"date_range",label:__("Start and end date"),props:{clearable:!0,range:!0}},{type:"agent",name:"replacement_id",label:__("Replacement agent"),props:{clearable:!0,belongsToObjectField:"outOfOfficeReplacement",exceptUserInternalId:(m=t.value)==null?void 0:m.internalId}},{type:"toggle",name:"enabled",label:__("Active"),props:{variants:{true:__("Active"),false:__("Inactive")}}}]}]),o=J(e=>{var r,i,l,d,p,_,O,b,v;const a={text:(i=(r=t.value)==null?void 0:r.preferences)==null?void 0:i.out_of_office_text,replacement_id:(d=(l=t.value)==null?void 0:l.outOfOfficeReplacement)==null?void 0:d.internalId,enabled:!!((p=t.value)!=null&&p.outOfOffice)};return(_=t.value)!=null&&_.outOfOfficeStartAt&&((O=t.value)!=null&&O.outOfOfficeEndAt)&&(a.date_range=[(b=t.value)==null?void 0:b.outOfOfficeStartAt,(v=t.value)==null?void 0:v.outOfOfficeEndAt]),e&&g(a,e)?e:a});K(o,e=>{g(C.value,e)&&!A.value||F({values:e,object:t.value})});const u=e=>({replacement_id:{required:e},date_range:{required:e}}),f=W(u(o.value.enabled));I("enabled",e=>{Object.assign(f,u(!!e))});const{breadcrumbItems:M}=Y(__("Out of Office")),$=e=>{var r,i;const a=e.replacement_id?z("User",e.replacement_id):void 0;return{enabled:e.enabled,text:e.text,startAt:(r=e.date_range)==null?void 0:r.at(0),endAt:(i=e.date_range)==null?void 0:i.at(1),replacementId:a}},{notify:j}=D(),w=()=>{j({id:"out-of-office-saved",type:k.Success,message:__("Out of Office settings have been saved successfully")})},R=new U(se(),{errorNotificationMessage:__("Out of Office settings could not be saved.")}),T=async e=>R.send({input:$(e)}).then(()=>w);return(e,a)=>(ee(),te(X,{"breadcrumb-items":s(M),width:"narrow"},{default:n(()=>[h("div",oe,[y(G,{ref_key:"form",ref:S,"initial-values":o.value,"initial-entity-object":s(t),schema:s(N),"change-fields":f,onSubmit:a[0]||(a[0]=r=>T(r))},{"after-fields":n(()=>[h("div",ne,[y(V,{variant:"submit",type:"submit",size:"medium",disabled:s(x)},{default:n(()=>[ae(re(e.$t("Save Out of Office")),1)]),_:1},8,["disabled"])])]),_:1},8,["initial-values","initial-entity-object","schema","change-fields"])])]),_:1},8,["breadcrumb-items"]))}});export{Be as default};
//# sourceMappingURL=PersonalSettingOutOfOffice-Be8bTGiD.js.map
