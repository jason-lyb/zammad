{"version":3,"file":"useLocaleUpdate-BuNp3bsA.js","sources":["../../../../../app/frontend/shared/entities/user/current/graphql/mutations/userCurrentLocale.api.ts","../../../../../app/frontend/shared/composables/useLocaleUpdate.ts"],"sourcesContent":["import * as Types from '#shared/graphql/types.ts';\n\nimport gql from 'graphql-tag';\nimport { ErrorsFragmentDoc } from '../../../../../graphql/fragments/errors.api';\nimport * as VueApolloComposable from '@vue/apollo-composable';\nimport * as VueCompositionApi from 'vue';\nexport type ReactiveFunction<TParam> = () => TParam;\n\nexport const UserCurrentLocaleDocument = gql`\n    mutation userCurrentLocale($locale: String!) {\n  userCurrentLocale(locale: $locale) {\n    success\n    errors {\n      ...errors\n    }\n  }\n}\n    ${ErrorsFragmentDoc}`;\nexport function useUserCurrentLocaleMutation(options: VueApolloComposable.UseMutationOptions<Types.UserCurrentLocaleMutation, Types.UserCurrentLocaleMutationVariables> | ReactiveFunction<VueApolloComposable.UseMutationOptions<Types.UserCurrentLocaleMutation, Types.UserCurrentLocaleMutationVariables>> = {}) {\n  return VueApolloComposable.useMutation<Types.UserCurrentLocaleMutation, Types.UserCurrentLocaleMutationVariables>(UserCurrentLocaleDocument, options);\n}\nexport type UserCurrentLocaleMutationCompositionFunctionResult = VueApolloComposable.UseMutationReturn<Types.UserCurrentLocaleMutation, Types.UserCurrentLocaleMutationVariables>;","// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { storeToRefs } from 'pinia'\nimport { computed, ref } from 'vue'\n\nimport {\n  NotificationTypes,\n  useNotifications,\n} from '#shared/components/CommonNotifications/index.ts'\nimport { useUserCurrentLocaleMutation } from '#shared/entities/user/current/graphql/mutations/userCurrentLocale.api.ts'\nimport { useLocaleStore } from '#shared/stores/locale.ts'\n\nimport MutationHandler from '../server/apollo/handler/MutationHandler.ts'\n\nconst ZAMMAD_TRANSLATION_LINK = 'https://translations.zammad.org/'\n\nexport const useLocaleUpdate = () => {\n  const isSavingLocale = ref(false)\n\n  const localeMutation = new MutationHandler(useUserCurrentLocaleMutation({}), {\n    errorNotificationMessage: __('The language could not be updated.'),\n  })\n\n  const { notify } = useNotifications()\n\n  const localeStore = useLocaleStore()\n  const { localeData, locales } = storeToRefs(localeStore)\n  const { setLocale } = localeStore\n\n  const modelCurrentLocale = computed({\n    get: () => localeData.value?.locale ?? 'en',\n    set: (locale) => {\n      if (!locale || localeData.value?.locale === locale) return\n      isSavingLocale.value = true\n      Promise.all([setLocale(locale), localeMutation.send({ locale })])\n        .then(() => {\n          notify({\n            id: 'locale-update',\n            message: __('Profile language updated successfully.'),\n            type: NotificationTypes.Success,\n          })\n        })\n        .finally(() => {\n          isSavingLocale.value = false\n        })\n    },\n  })\n\n  const localeOptions = computed(() => {\n    return (\n      locales?.value?.map((locale) => {\n        return { label: locale.name, value: locale.locale }\n      }) || []\n    )\n  })\n\n  return {\n    translation: {\n      link: ZAMMAD_TRANSLATION_LINK,\n    },\n    isSavingLocale,\n    modelCurrentLocale,\n    localeOptions,\n  }\n}\n"],"names":["UserCurrentLocaleDocument","gql","ErrorsFragmentDoc","useUserCurrentLocaleMutation","options","VueApolloComposable.useMutation","ZAMMAD_TRANSLATION_LINK","useLocaleUpdate","isSavingLocale","ref","localeMutation","MutationHandler","notify","useNotifications","localeStore","useLocaleStore","localeData","locales","storeToRefs","setLocale","modelCurrentLocale","computed","_a","locale","NotificationTypes","localeOptions"],"mappings":"6PAQO,MAAMA,EAA4BC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASnCC,CAAiB,GACP,SAAAC,EAA6BC,EAAmQ,GAAI,CAC3S,OAAAC,EAA2GL,EAA2BI,CAAO,CACtJ,CCNA,MAAME,EAA0B,mCAEnBC,EAAkB,IAAM,CAC7B,MAAAC,EAAiBC,EAAI,EAAK,EAE1BC,EAAiB,IAAIC,EAAgBR,EAA6B,CAAE,CAAA,EAAG,CAC3E,yBAA0B,GAAG,oCAAoC,CAAA,CAClE,EAEK,CAAE,OAAAS,GAAWC,IAEbC,EAAcC,IACd,CAAE,WAAAC,EAAY,QAAAC,CAAQ,EAAIC,EAAYJ,CAAW,EACjD,CAAE,UAAAK,CAAc,EAAAL,EAEhBM,EAAqBC,EAAS,CAClC,IAAK,IAAM,OAAA,QAAAC,EAAAN,EAAW,QAAX,YAAAM,EAAkB,SAAU,MACvC,IAAMC,GAAW,OACX,CAACA,KAAUD,EAAAN,EAAW,QAAX,YAAAM,EAAkB,UAAWC,IAC5Cf,EAAe,MAAQ,GACvB,QAAQ,IAAI,CAACW,EAAUI,CAAM,EAAGb,EAAe,KAAK,CAAE,OAAAa,CAAQ,CAAA,CAAC,CAAC,EAC7D,KAAK,IAAM,CACHX,EAAA,CACL,GAAI,gBACJ,QAAS,GAAG,wCAAwC,EACpD,KAAMY,EAAkB,OAAA,CACzB,CAAA,CACF,EACA,QAAQ,IAAM,CACbhB,EAAe,MAAQ,EAAA,CACxB,EACL,CAAA,CACD,EAEKiB,EAAgBJ,EAAS,IAAM,OACnC,QACEC,EAAAL,GAAA,YAAAA,EAAS,QAAT,YAAAK,EAAgB,IAAKC,IACZ,CAAE,MAAOA,EAAO,KAAM,MAAOA,EAAO,YACvC,CAAA,CAAC,CAEV,EAEM,MAAA,CACL,YAAa,CACX,KAAMjB,CACR,EACA,eAAAE,EACA,mBAAAY,EACA,cAAAK,CAAA,CAEJ"}