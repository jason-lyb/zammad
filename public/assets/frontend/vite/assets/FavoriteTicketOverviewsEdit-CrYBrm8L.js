import{d as E,a as q,u as H}from"./index-DwuY2HL4.js";import{n as Q,q as R,u as U}from"./vendor-C11O1Xx8.js";import{u as K,Q as L,N as x,c as V}from"./apollo-Cj5TVUDk.js";import{a3 as P,aS as j}from"./overviewAttributes.api-C09LSZ8O.js";import{T as W,g as Z,h as J,f as G,b as B}from"./mobile-Bk4bKGxF.js";import{u as X}from"./useHeader-B3UlgUtw.js";import{k as Y}from"./lodash-pFOI14f-.js";import{c as m,r as _,ah as ee,aq as te,f as z,a1 as N,m as a,p as w,I as O,q as T,H as ie,W as se,M as $,D as y,y as C,E as g,w as oe,u as h,J as I,x as A}from"./vue-oicRkvo0.js";import"./commonjsHelpers-BosuxZz1.js";import"./routes-CgLO9M4y.js";import"./vite-FJshFMF2.js";import"./formkit-5nol1GBe.js";import"./pwa-THoW_3xc.js";import"./add.api-CxwFhgGn.js";import"./datepicker-BBNcWeHz.js";import"./date-B2UyDZN7.js";const ne=Q`
    query ticketOverviewOrder($withTicketCount: Boolean = false) {
  ticketOverviews(ignoreUserConditions: true) {
    ...overviewAttributes
    viewColumns {
      key
      value
    }
    orderColumns {
      key
      value
    }
  }
}
    ${P}`;function ae(u={},l={}){return K(ne,u,l)}const re=R("ticketOverviewOrder",()=>{const u=new L(ae());u.subscribeToMore({document:W,variables:{ignoreUserConditions:!0,withTicketCount:!1},updateQuery(t,{subscriptionData:r}){var b;const k=(b=r.data.ticketOverviewUpdates)==null?void 0:b.ticketOverviews;return k?{ticketOverviews:k}:null}});const l=u.result(),c=u.loading(),i=m(()=>{var t;return(t=l.value)!=null&&t.ticketOverviews?l.value.ticketOverviews.filter(r=>r==null?void 0:r.id):[]}),p=m(()=>Y(i.value,"id")),v=Z(),n=_(new Set(v.getOverviews())),o=m(()=>[...n.value].map(t=>p.value[t]).filter(Boolean)),e=t=>{const r=t.map(({id:k})=>k);v.saveOverviews(r),n.value=new Set(r)},d=t=>{t.forEach(r=>{n.value.add(r.id)}),e(t)};return n.value.size||(i.value.length?d(i.value):ee(i,d)),te(()=>{u.stop()}),{overviews:i,initializing:u.operationResult.forceDisabled.value,loading:c,includedOverviews:o,includedIds:n,overviewsByKey:p,saveOverviews:e}}),le=["draggable"],ve={class:"flex flex-1 items-center gap-2"},ue={class:"truncate"},D=z({__name:"TicketOverviewEditItem",props:{action:{},draggable:{type:Boolean},overview:{}},emits:["action","action-active"],setup(u,{emit:l}){const c=u,i=l,p=m(()=>c.action==="add"?{name:"plus",class:"text-green"}:{name:"minus",class:"text-red"}),v=m(()=>c.overview.organizationShared||c.overview.outOfOffice),n=m(()=>{const o=[];return c.overview.organizationShared&&o.push({type:"text",label:__("This overview is visible only when you are a shared organization member.")}),c.overview.outOfOffice&&o.push({type:"text",label:__("This overview is visible only when you are an out of office replacement.")}),o});return(o,e)=>{const d=N("CommonIcon");return a(),w("div",{class:"flex min-h-[54px] cursor-move items-center gap-2 border-b border-gray-300 p-3 last:border-0",draggable:o.draggable?"true":void 0},[O("div",{class:ie(["shrink-0 cursor-pointer items-center justify-center",p.value.class]),role:"button",tabindex:"0",onKeydown:e[0]||(e[0]=se(t=>i("action"),["enter"])),onClick:e[1]||(e[1]=t=>i("action")),onMousedown:e[2]||(e[2]=t=>i("action-active",!0)),onMouseup:e[3]||(e[3]=t=>i("action-active",!1)),onMouseout:e[4]||(e[4]=t=>i("action-active",!1)),onFocusout:e[5]||(e[5]=t=>i("action-active",!1)),onBlur:e[6]||(e[6]=t=>i("action-active",!1)),onTouchstart:e[7]||(e[7]=t=>i("action-active",!0)),onTouchend:e[8]||(e[8]=t=>i("action-active",!1)),onTouchcancel:e[9]||(e[9]=t=>i("action-active",!1))},[T(d,{name:p.value.name,size:"base"},null,8,["name"])],34),O("div",ve,[O("span",ue,$(o.$t(o.overview.name)),1),v.value?(a(),y(J,{key:0,class:"shrink-0",name:"visibility",messages:n.value,heading:o.__("Limited Visibility")},{default:C(()=>[T(d,{name:"tooltip",size:"small"})]),_:1},8,["messages","heading"])):g("",!0)]),o.draggable?(a(),y(d,{key:0,name:"change-order",size:"small",class:"text-gray shrink-0"})):g("",!0)],8,le)}}}),ce={class:"mx-4 mt-6"},de={key:0,class:"flex items-center justify-center"},me={key:0,class:"ms-3 flex min-h-[54px] items-center"},pe={key:0,class:"ms-3 flex min-h-[54px] items-center"},Ae=z({__name:"FavoriteTicketOverviewsEdit",setup(u){const l=re(),{overviews:c,loading:i,overviewsByKey:p}=U(l),v=_(new Set(l.includedIds.values()));oe(()=>l.includedIds,s=>{v.value=s});const n=m({get:()=>[...v.value].map(s=>p.value[s]).filter(Boolean),set:s=>{v.value=new Set(s.map(S=>S.id))}}),o=_();E({parent:o,values:n,plugins:[q()],dropZoneClass:"opacity-0",touchDropZoneClass:"opacity-0"});const{notify:e}=V(),d=j();X({title:__("Ticket Overview"),backUrl:"/",backAvoidHomeButton:!0,actionTitle:__("Save"),onAction(){if(!n.value.length){e({id:"no-overview",message:__("Please select at least one ticket overview"),type:x.Error});return}l.saveOverviews(n.value),G().updateOverviews(n.value),e({id:"overview-save",message:__("Ticket Overview settings are saved."),type:x.Success}),d.back("/")}});const t=m(()=>c.value.filter(s=>!v.value.has(s.id))),r=s=>{v.value.delete(s)},k=s=>{v.value.add(s)},b=s=>{H(o.value,{disabled:s})};return(s,S)=>{const F=N("CommonIcon");return a(),w("div",ce,[h(i)?(a(),w("div",de,[T(F,{name:"loading",animation:"spin"})])):g("",!0),h(i)?g("",!0):(a(),y(B,{key:1,"header-label":s.__("Included ticket overviews")},{default:C(()=>[O("div",{ref_key:"dndParentRef",ref:o},[(a(!0),w(I,null,A(n.value,f=>(a(),y(D,{key:f.id,action:"delete",overview:f,draggable:"",onAction:M=>r(f.id),onActionActive:b},null,8,["overview","onAction"]))),128))],512),n.value.length?g("",!0):(a(),w("div",me,[O("p",null,$(s.$t("No entries")),1)]))]),_:1},8,["header-label"])),h(i)?g("",!0):(a(),y(B,{key:2,"header-label":s.__("More ticket overviews")},{default:C(()=>[(a(!0),w(I,null,A(t.value,f=>(a(),y(D,{key:f.id,action:"add",overview:f,onAction:M=>k(f.id)},null,8,["overview","onAction"]))),128)),t.value.length?g("",!0):(a(),w("div",pe,[O("p",null,$(s.$t("No entries")),1)]))]),_:1},8,["header-label"]))])}}});export{Ae as default};
//# sourceMappingURL=FavoriteTicketOverviewsEdit-CrYBrm8L.js.map
