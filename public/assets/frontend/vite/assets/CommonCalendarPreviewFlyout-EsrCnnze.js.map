{"version":3,"file":"CommonCalendarPreviewFlyout-EsrCnnze.js","sources":["../../../../../app/frontend/apps/desktop/entities/calendar/ics-file/graphql/queries/events.api.ts","../../../../../app/frontend/apps/desktop/components/CommonCalendarPreviewFlyout/CommonCalendarPreviewFlyout.vue"],"sourcesContent":["import * as Types from '#shared/graphql/types.ts';\n\nimport gql from 'graphql-tag';\nimport * as VueApolloComposable from '@vue/apollo-composable';\nimport * as VueCompositionApi from 'vue';\nexport type ReactiveFunction<TParam> = () => TParam;\n\nexport const CalendarIcsFileEventsDocument = gql`\n    query calendarIcsFileEvents($fileId: ID!) {\n  calendarIcsFileEvents(fileId: $fileId) {\n    title\n    location\n    startDate\n    endDate\n    organizer\n    attendees\n    description\n  }\n}\n    `;\nexport function useCalendarIcsFileEventsQuery(variables: Types.CalendarIcsFileEventsQueryVariables | VueCompositionApi.Ref<Types.CalendarIcsFileEventsQueryVariables> | ReactiveFunction<Types.CalendarIcsFileEventsQueryVariables>, options: VueApolloComposable.UseQueryOptions<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables> | VueCompositionApi.Ref<VueApolloComposable.UseQueryOptions<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables>> | ReactiveFunction<VueApolloComposable.UseQueryOptions<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables>> = {}) {\n  return VueApolloComposable.useQuery<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables>(CalendarIcsFileEventsDocument, variables, options);\n}\nexport function useCalendarIcsFileEventsLazyQuery(variables?: Types.CalendarIcsFileEventsQueryVariables | VueCompositionApi.Ref<Types.CalendarIcsFileEventsQueryVariables> | ReactiveFunction<Types.CalendarIcsFileEventsQueryVariables>, options: VueApolloComposable.UseQueryOptions<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables> | VueCompositionApi.Ref<VueApolloComposable.UseQueryOptions<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables>> | ReactiveFunction<VueApolloComposable.UseQueryOptions<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables>> = {}) {\n  return VueApolloComposable.useLazyQuery<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables>(CalendarIcsFileEventsDocument, variables, options);\n}\nexport type CalendarIcsFileEventsQueryCompositionFunctionResult = VueApolloComposable.UseQueryReturn<Types.CalendarIcsFileEventsQuery, Types.CalendarIcsFileEventsQueryVariables>;","<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nimport { getAttachmentLinks } from '#shared/composables/getAttachmentLinks.ts'\nimport { getIdFromGraphQLId } from '#shared/graphql/utils.ts'\nimport QueryHandler from '#shared/server/apollo/handler/QueryHandler.ts'\nimport { useApplicationStore } from '#shared/stores/application.ts'\nimport getUuid from '#shared/utils/getUuid.ts'\nimport openExternalLink from '#shared/utils/openExternalLink.ts'\n\nimport CommonFlyout from '#desktop/components/CommonFlyout/CommonFlyout.vue'\nimport CommonLoader from '#desktop/components/CommonLoader/CommonLoader.vue'\nimport CommonSimpleTable from '#desktop/components/CommonTable/CommonSimpleTable.vue'\nimport type { TableSimpleHeader } from '#desktop/components/CommonTable/types'\nimport { useCalendarIcsFileEventsQuery } from '#desktop/entities/calendar/ics-file/graphql/queries/events.api.ts'\n\ninterface Props {\n  fileId: string\n  fileType: string\n  fileName: string\n}\n\nconst props = defineProps<Props>()\n\nconst calendarEventsQuery = new QueryHandler(\n  useCalendarIcsFileEventsQuery({\n    fileId: props.fileId,\n  }),\n)\nconst calendarEventsQueryResult = calendarEventsQuery.result()\nconst calendarEventsQueryLoading = calendarEventsQuery.loading()\n\nconst tableHeaders: TableSimpleHeader[] = [\n  {\n    key: 'summary',\n    label: __('Event Summary'),\n  },\n  {\n    key: 'location',\n    label: __('Event Location'),\n  },\n  {\n    key: 'start',\n    label: __('Event Starting'),\n    type: 'timestamp_absolute',\n  },\n  {\n    key: 'end',\n    label: __('Event Ending'),\n    type: 'timestamp_absolute',\n  },\n]\n\nconst tableItems = computed(() => {\n  if (!calendarEventsQueryResult.value?.calendarIcsFileEvents) return []\n\n  return calendarEventsQueryResult.value?.calendarIcsFileEvents.map(\n    (event) => ({\n      id: getUuid(),\n      summary: event.title,\n      location: event.location,\n      start: event.startDate,\n      end: event.endDate,\n    }),\n  )\n})\n\nconst downloadCalendar = () => {\n  const application = useApplicationStore()\n\n  const { downloadUrl } = getAttachmentLinks(\n    {\n      internalId: getIdFromGraphQLId(props.fileId),\n      type: props.fileType,\n    },\n    application.config.api_path,\n  )\n\n  openExternalLink(downloadUrl, '_blank', props.fileName)\n}\n</script>\n\n<template>\n  <CommonFlyout\n    :header-title=\"__('Preview Calendar')\"\n    :footer-action-options=\"{\n      actionLabel: __('Download'),\n      actionButton: { variant: 'primary' },\n    }\"\n    name=\"common-calendar-preview\"\n    no-close-on-action\n    @action=\"downloadCalendar\"\n  >\n    <CommonLoader :loading=\"calendarEventsQueryLoading\">\n      <CommonSimpleTable\n        :caption=\"__('Preview Calendar')\"\n        class=\"mb-4 w-full\"\n        :headers=\"tableHeaders\"\n        :items=\"tableItems\"\n      />\n    </CommonLoader>\n  </CommonFlyout>\n</template>\n"],"names":["CalendarIcsFileEventsDocument","gql","useCalendarIcsFileEventsQuery","variables","options","VueApolloComposable.useQuery","props","__props","calendarEventsQuery","QueryHandler","calendarEventsQueryResult","calendarEventsQueryLoading","tableHeaders","tableItems","computed","_a","_b","event","getUuid","downloadCalendar","application","useApplicationStore","downloadUrl","getAttachmentLinks","getIdFromGraphQLId","openExternalLink"],"mappings":"y3CAOO,MAAMA,EAAgCC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAatC,SAASC,EAA8BC,EAAuLC,EAA2Y,GAAI,CAClnB,OAAOC,EAA0GL,EAA+BG,EAAWC,CAAO,CACpK,qGCEA,MAAME,EAAQC,EAERC,EAAsB,IAAIC,EAC9BP,EAA8B,CAC5B,OAAQI,EAAM,MAAA,CACf,CAAA,EAEGI,EAA4BF,EAAoB,SAChDG,EAA6BH,EAAoB,UAEjDI,EAAoC,CACxC,CACE,IAAK,UACL,MAAO,GAAG,eAAe,CAC3B,EACA,CACE,IAAK,WACL,MAAO,GAAG,gBAAgB,CAC5B,EACA,CACE,IAAK,QACL,MAAO,GAAG,gBAAgB,EAC1B,KAAM,oBACR,EACA,CACE,IAAK,MACL,MAAO,GAAG,cAAc,EACxB,KAAM,oBACR,CAAA,EAGIC,EAAaC,EAAS,IAAM,SAChC,OAAKC,EAAAL,EAA0B,QAA1B,MAAAK,EAAiC,uBAE/BC,EAAAN,EAA0B,QAA1B,YAAAM,EAAiC,sBAAsB,IAC3DC,IAAW,CACV,GAAIC,EAAQ,EACZ,QAASD,EAAM,MACf,SAAUA,EAAM,SAChB,MAAOA,EAAM,UACb,IAAKA,EAAM,OAAA,IARqD,CAAA,CAUpE,CACD,EAEKE,EAAmB,IAAM,CAC7B,MAAMC,EAAcC,IAEd,CAAE,YAAAC,GAAgBC,EACtB,CACE,WAAYC,EAAmBlB,EAAM,MAAM,EAC3C,KAAMA,EAAM,QACd,EACAc,EAAY,OAAO,QAAA,EAGJK,EAAAH,EAAa,SAAUhB,EAAM,QAAQ,CAAA"}