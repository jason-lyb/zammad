{"version":3,"file":"TicketInformationCustomer-0foE0w7F.js","sources":["../../../../../app/frontend/apps/mobile/pages/ticket/views/TicketInformation/TicketInformationCustomer.vue"],"sourcesContent":["<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport { watchEffect, computed } from 'vue'\n\nimport CommonUserAvatar from '#shared/components/CommonUserAvatar/CommonUserAvatar.vue'\nimport ObjectAttributes from '#shared/components/ObjectAttributes/ObjectAttributes.vue'\nimport { useUserDetail } from '#shared/entities/user/composables/useUserDetail.ts'\nimport { useErrorHandler } from '#shared/errors/useErrorHandler.ts'\n\nimport CommonButton from '#mobile/components/CommonButton/CommonButton.vue'\nimport CommonLoader from '#mobile/components/CommonLoader/CommonLoader.vue'\nimport CommonOrganizationsList from '#mobile/components/CommonOrganizationsList/CommonOrganizationsList.vue'\nimport CommonTicketStateList from '#mobile/components/CommonTicketStateList/CommonTicketStateList.vue'\nimport { useUserEdit } from '#mobile/entities/user/composables/useUserEdit.ts'\nimport { useUsersTicketsCount } from '#mobile/entities/user/composables/useUserTicketsCount.ts'\n\nimport { useTicketInformation } from '../../composable/useTicketInformation.ts'\n\ninterface Props {\n  internalId: number\n}\n\ndefineProps<Props>()\n\nconst { ticket, updateRefetchingStatus } = useTicketInformation()\n\nconst { createQueryErrorHandler } = useErrorHandler()\n\nconst errorCallback = createQueryErrorHandler({\n  notFound: __(\n    'User with specified ID was not found. Try checking the URL for errors.',\n  ),\n  forbidden: __('You have insufficient rights to view this user.'),\n})\n\nconst customerInternalId = computed(() => ticket.value?.customer.internalId)\n\nconst {\n  user,\n  loading,\n  objectAttributes,\n  secondaryOrganizations,\n  loadAllSecondaryOrganizations,\n} = useUserDetail(customerInternalId, errorCallback)\n\nwatchEffect(() => {\n  updateRefetchingStatus(loading.value && user.value != null)\n})\n\nconst { openEditUserDialog } = useUserEdit()\n\nconst { getTicketData } = useUsersTicketsCount()\nconst ticketsData = computed(() => getTicketData(user.value))\n</script>\n\n<template>\n  <CommonLoader :loading=\"loading && !user\">\n    <div v-if=\"user\" class=\"mb-3 flex items-center gap-3\">\n      <CommonUserAvatar aria-hidden=\"true\" size=\"normal\" :entity=\"user\" />\n      <div>\n        <h2 class=\"text-lg font-semibold\">\n          {{ user.fullname }}\n        </h2>\n        <h3 v-if=\"user.organization\">\n          <CommonLink\n            :link=\"`/organizations/${user.organization.internalId}`\"\n            class=\"text-blue\"\n          >\n            {{ user.organization.name }}\n          </CommonLink>\n        </h3>\n      </div>\n    </div>\n  </CommonLoader>\n  <div v-if=\"user\">\n    <ObjectAttributes\n      :attributes=\"objectAttributes\"\n      :object=\"user\"\n      :skip-attributes=\"['firstname', 'lastname']\"\n      :always-show-after-fields=\"user.policy.update\"\n    >\n      <template v-if=\"user.policy.update\" #after-fields>\n        <CommonButton\n          class=\"p-4\"\n          variant=\"primary\"\n          transparent-background\n          @click=\"openEditUserDialog(user!)\"\n        >\n          {{ $t('Edit Customer') }}\n        </CommonButton>\n      </template>\n    </ObjectAttributes>\n    <CommonOrganizationsList\n      :organizations=\"secondaryOrganizations.array\"\n      :total-count=\"secondaryOrganizations.totalCount\"\n      :disable-show-more=\"loading\"\n      :label=\"__('Secondary organizations')\"\n      @show-more=\"loadAllSecondaryOrganizations()\"\n    />\n    <CommonTicketStateList\n      v-if=\"ticketsData\"\n      :counts=\"ticketsData.count\"\n      :tickets-link-query=\"ticketsData.query\"\n    />\n  </div>\n</template>\n"],"names":["ticket","updateRefetchingStatus","useTicketInformation","createQueryErrorHandler","useErrorHandler","errorCallback","customerInternalId","computed","_a","user","loading","objectAttributes","secondaryOrganizations","loadAllSecondaryOrganizations","useUserDetail","watchEffect","openEditUserDialog","useUserEdit","getTicketData","useUsersTicketsCount","ticketsData"],"mappings":"04CAyBA,KAAM,CAAE,OAAAA,EAAQ,uBAAAC,CAAuB,EAAIC,EAAqB,EAE1D,CAAE,wBAAAC,GAA4BC,IAE9BC,EAAgBF,EAAwB,CAC5C,SAAU,GACR,wEACF,EACA,UAAW,GAAG,iDAAiD,CAAA,CAChE,EAEKG,EAAqBC,EAAS,IAAM,OAAA,OAAAC,EAAAR,EAAO,QAAP,YAAAQ,EAAc,SAAS,WAAU,EAErE,CACJ,KAAAC,EACA,QAAAC,EACA,iBAAAC,EACA,uBAAAC,EACA,8BAAAC,CAAA,EACEC,EAAcR,EAAoBD,CAAa,EAEnDU,EAAY,IAAM,CAChBd,EAAuBS,EAAQ,OAASD,EAAK,OAAS,IAAI,CAAA,CAC3D,EAEK,KAAA,CAAE,mBAAAO,GAAuBC,IAEzB,CAAE,cAAAC,GAAkBC,IACpBC,EAAcb,EAAS,IAAMW,EAAcT,EAAK,KAAK,CAAC"}