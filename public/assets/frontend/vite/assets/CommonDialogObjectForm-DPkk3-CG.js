import{_ as M}from"./Form.vue_vue_type_script_setup_true_lang-B6L-6HzY.js";import{u as O}from"./useForm-CUKec4n5.js";import{at as V,a2 as N}from"./overviewAttributes.api-C09LSZ8O.js";import{u as $}from"./useObjectAttributeFormData-BTXeBYyl.js";import{M as S}from"./apollo-Cj5TVUDk.js";import{_ as l,p as f}from"./mobile-Bk4bKGxF.js";import{_ as L}from"./CommonDialog.vue_vue_type_script_setup_true_lang-CID2Z6MI.js";import{f as B,m as I,D as U,y as o,q as s,Q as d,M as p,u as q}from"./vue-oicRkvo0.js";import"./formkit-5nol1GBe.js";import"./routes-CgLO9M4y.js";import"./vite-FJshFMF2.js";import"./vendor-C11O1Xx8.js";import"./commonjsHelpers-BosuxZz1.js";import"./lodash-pFOI14f-.js";import"./FormGroup.vue_vue_type_script_setup_true_lang-DIx-HUKU.js";import"./pwa-THoW_3xc.js";import"./add.api-CxwFhgGn.js";import"./datepicker-BBNcWeHz.js";import"./date-B2UyDZN7.js";const rt=B({__name:"CommonDialogObjectForm",props:{name:{},object:{},title:{},type:{},formUpdaterId:{},formChangeFields:{},errorNotificationMessage:{},mutation:{},schema:{}},emits:["success","error","changed-field"],setup(b,{emit:g}){var n,m;const e=b,r=g,h=new S(e.mutation({}),{errorNotificationMessage:e.errorNotificationMessage}),{form:j,isDirty:_,canSubmit:y}=O(),C=((m=(n=e.object)==null?void 0:n.objectAttributeValues)==null?void 0:m.reduce((t,a)=>(t[a.attribute.name]=a.value,t),{}))||{},A={...e.object,...C},{attributesLookup:F}=V(e.type),{waitForConfirmation:k}=N(),v=async()=>{_.value&&!await k(__("Are you sure? You have unsaved changes that will get lost."),{buttonLabel:__("Discard changes"),buttonVariant:"danger"})||f(e.name)},w=(t,a,i)=>{r("changed-field",t,a,i)},D=async t=>{var u;const{internalObjectAttributeValues:a,additionalObjectAttributeValues:i}=$(F.value,t),c=await h.send({id:(u=e.object)==null?void 0:u.id,input:{...a,objectAttributeValues:i}});c?(r("success",c),f(e.name)):r("error")};return(t,a)=>(I(),U(L,{class:"w-full","no-autofocus":"",name:t.name},{"before-label":o(()=>[s(l,{"transparent-background":"",onClick:v},{default:o(()=>[d(p(t.$t("Cancel")),1)]),_:1})]),"after-label":o(()=>[s(l,{form:t.name,disabled:!q(y),variant:"primary",type:"submit","transparent-background":""},{default:o(()=>[d(p(t.$t("Save")),1)]),_:1},8,["form","disabled"])]),default:o(()=>[s(M,{id:t.name,ref_key:"form",ref:j,class:"w-full p-4","should-autofocus":"",schema:t.schema,"initial-entity-object":A,"change-fields":t.formChangeFields,"use-object-attributes":"","form-updater-id":t.formUpdaterId,onChanged:w,onSubmit:D},null,8,["id","schema","change-fields","form-updater-id"])]),_:1},8,["name"]))}});export{rt as default};
//# sourceMappingURL=CommonDialogObjectForm-DPkk3-CG.js.map
