import{f as A,m as i,p as m,x as Z,D as z,K as _e,H as w,J as P,a7 as $e,r as K,c as h,aS as Ee,a8 as Ie,U as de,I as T,u as p,av as Be,a1 as O,q as f,y as B,Q,M as V,aa as ke,w as ye,k as Me,ab as De,t as we,aV as je,aW as He,aJ as Ke,z as Y,W as re,L as ae,E,C as ue,a9 as Oe,T as Ve,a4 as Ue,n as qe}from"./vue-oicRkvo0.js";import{_ as he}from"./ObjectAttribute.vue_vue_type_script_setup_true_lang-S7kCEp8d.js";import{at as Ge,l as Ne}from"./overviewAttributes.api-C09LSZ8O.js";import{b as Fe,c as Xe,Y as J,i as be,q as Ye}from"./routes-CgLO9M4y.js";import{r as Je,s as Qe,t as Ze,b as Ae,v as et}from"./desktop-l0eJ1dZN.js";import{g as tt}from"./apollo-Cj5TVUDk.js";import{b as ot}from"./LayoutSidebar.vue_vue_type_script_setup_true_lang-BO1pkKrb.js";import{j as nt,q as xe}from"./lodash-pFOI14f-.js";import{_ as Re}from"./CommonSkeleton.vue_vue_type_script_setup_true_lang-CNAAMgPI.js";const ze=A({__name:"CommonTableRowsSkeleton",props:{rows:{default:10}},setup(R){return(v,o)=>(i(!0),m(P,null,Z(v.rows,(k,l)=>(i(),z(Re,{key:k,style:_e({"animation-delay":`${k*.1}s`}),class:w(["h-10",{invisible:l%2}])},null,8,["style","class"]))),128))}}),H=50,Ce=600,rt=["aria-describedby"],at=["id","aria-valuenow","aria-valuemin"],st=A({__name:"HeaderResizeLine",emits:["resize","reset"],setup(R,{emit:v}){const o=v,k=$e("resize-line"),l=K(!1),u=h(()=>{var r;return(r=k.value)==null?void 0:r.parentElement}),x=h(()=>{var r;return(r=u.value)==null?void 0:r.nextElementSibling}),b=K(0),S=K(0),U=()=>{!u.value||!x.value||(b.value=u.value.clientWidth,S.value=x.value.clientWidth)},C=r=>{!u.value||!x.value||(b.value+r<H&&(r=-(b.value-H)),S.value-r<H&&(r=S.value-H),u.value.style.width=`${b.value+r}px`,x.value.style.width=`${S.value-r}px`)},se=Ee(),L=(r,$)=>{se.value===k.value&&(r.preventDefault(),U(),C($),o("resize"))},_=K(0),{startResizing:q}=ot(r=>{var W;if(!u.value||!x.value)return;let $=r-_.value;((W=Fe().localeData)==null?void 0:W.dir)===Xe.Rtl&&($=_.value-r),C($)},k,L,{orientation:"vertical"}),ee=r=>{Be(r,()=>{l.value=!1,o("resize")},{once:!0})},G=r=>{l.value=!0,_.value=r.pageX,ee("mouseup"),U(),q(r)},M=r=>{l.value=!0,r.targetTouches[0]?_.value=r.targetTouches[0].pageX:_.value=r.changedTouches[r.changedTouches.length-1].pageX,ee("touchend"),U(),q(r)},le=()=>{var r;o("reset"),(r=k.value)==null||r.blur()},N=tt();return(r,$)=>{var te;const W=Ie("tooltip");return de((i(),m("button",{ref:"resize-line","aria-describedby":p(N),tabindex:"0",class:w(["absolute end-0 top-1/2 h-5 w-1 -translate-y-2.5 cursor-col-resize! rounded-xs bg-neutral-100 hover:bg-blue-600 focus:outline-none focus-visible:bg-blue-800! dark:bg-gray-200 dark:hover:bg-blue-900",{"!bg-blue-800":l.value}]),onMousedown:G,onBlur:$[0]||($[0]=F=>l.value=!1),onTouchstart:M,onDblclick:le},[T("span",{id:p(N),role:"separator",class:"invisible absolute -z-20","aria-orientation":"horizontal","aria-valuenow":(te=u.value)==null?void 0:te.clientWidth,"aria-valuemin":p(H)},null,8,at)],42,rt)),[[W,r.$t("Resize column")]])}}}),lt={class:"group"},it=["colspan"],ct={class:"h-10 p-2.5"},ut=A({__name:"TableRowGroupBy",props:{item:{},attribute:{},tableColumnLength:{},groupByValueIndex:{},groupByRowCounts:{},remainingItems:{}},setup(R){const v=R,o=h(()=>{var l;return(l=v.groupByRowCounts)==null?void 0:l[v.groupByValueIndex].length}),k=h(()=>{var l;return v.remainingItems===0?!0:v.groupByValueIndex!==(((l=v.groupByRowCounts)==null?void 0:l.length)||0)-1});return(l,u)=>{const x=O("CommonBadge"),b=O("CommonLabel");return i(),m("tr",lt,[T("td",{colspan:l.tableColumnLength},[f(Je,{class:"mt-2 mb-1 group-first:mt-0"}),T("div",ct,[f(b,{class:"cursor-default truncate text-stone-200! dark:text-neutral-500!"},{default:B(()=>[f(he,{mode:"table",attribute:l.attribute,object:l.item},null,8,["attribute","object"]),f(x,{class:"ms-0.5 leading-snug font-bold",rounded:"",size:"xs",variant:"info"},{default:B(()=>[Q(V(o.value)+V(k.value?"":"+"),1)]),_:1})]),_:1})])],8,it)])}}}),dt=["id"],ht=["role","tabindex","aria-label","onClick","onKeydown"],mt={key:0,class:"h-10 w-0 p-2.5 text-center"},vt=["inert"],pt={key:0,class:"h-10 p-2.5 text-center"},ft=A({__name:"CommonAdvancedTable",props:ke({items:{},headers:{},attributes:{},attributeExtensions:{},object:{},selectedRowId:{},hasCheckboxColumn:{type:Boolean},totalItems:{},maxItems:{default:1e3},onClickRow:{},reachedScrollTop:{type:Boolean,default:!0},onLoadMore:{},storageKeyId:{},scrollContainer:{},groupBy:{},orderBy:{},orderDirection:{},isSorting:{type:Boolean},actions:{},caption:{},showCaption:{type:Boolean}},{checkedRows:{required:!1,default:R=>R.items.filter(v=>v.checked)},checkedRowsModifiers:{}}),emits:ke(["click-row","sort"],["update:checkedRows"]),setup(R,{emit:v}){const o=R,k=v,l={right:"justify-end text-end",center:"justify-center text-center",left:"justify-start text-left"},{attributesLookup:u}=o.object?Ge(o.object):{attributesLookup:null},x=h(()=>{var n;const e=new Map;return(n=o.attributes)==null||n.forEach(s=>e.set(s.name,s)),e}),b=(e,n)=>(n==null?void 0:n.get(e))||(n==null?void 0:n.get(`${e}_id`))||(n==null?void 0:n.get(`${e}_ids`)),S=h(()=>o.groupBy?o.headers.filter(e=>e!==o.groupBy):o.headers),U=["date","datetime","integer"],C=h(()=>{const e=[];return S.value.forEach(n=>{var y;const s=b(n,x.value),a=u!=null&&u.value?b(n,u.value):null;if(!s&&!a)return;const g=(y=o.attributeExtensions)==null?void 0:y[n],d=a?nt({name:a.name,label:a.display,dataType:a.dataType,dataOption:a.dataOption||{},headerPreferences:{},columnPreferences:{}},g):s;U.includes(d.dataType)&&!d.columnPreferences.alignContent&&(d.columnPreferences.alignContent="right"),e.push(d)}),e}),se=h(()=>C.value.length+(o.actions?1:0)),L=$e("table");let _=K({});const q=e=>{if(!L.value||!L.value.parentElement)return;const n=L.value.parentElement.clientWidth,s=n<Ce?Ce:n;L.value.style.width=`${s}px`;let a=e;C.value.length!==Object.keys(_.value).length&&(a=!0),C.value.forEach(g=>{const d=document.getElementById(`${g.name}-header`);if(!d)return;if(a){g.headerPreferences.displayWidth?d.style.width=`${g.headerPreferences.displayWidth}px`:d.style.width="";return}const y=_.value[g.name],t=g.headerPreferences.displayWidth??Math.max(H,y*s);d.style.width=`${t}px`})},ee=e=>{const n=Object.keys(e).reduce((s,a)=>(L.value&&(s[a]=e[a]/L.value.clientWidth),s),{});_.value=n},G=()=>{const e={};C.value.forEach(n=>{var a;const s=(a=document.getElementById(`${n.name}-header`))==null?void 0:a.clientWidth;s&&(e[n.name]=s)}),ee(e)},M=e=>{e&&(_=Ue(e,{})),qe(()=>{q(),xe(G,500)})},le=()=>{q(!0),xe(G,500)};ye(()=>o.storageKeyId,M),ye(S,()=>{M()}),Me(()=>{o.storageKeyId&&M(o.storageKeyId)}),Be("resize",()=>M());const N=(e,n)=>n.headerPreferences.truncate?e[n.name]:void 0,r=De(R,"checkedRows"),{hasCheckboxId:$,allCheckboxRowsSelected:W,selectAllRowCheckboxes:te,handleCheckboxUpdate:F}=Qe(r,we(o,"items")),Te=h(()=>o.onClickRow||o.hasCheckboxColumn?{"click-row":e=>{o.onClickRow&&o.onClickRow(e),o.hasCheckboxColumn&&F(e)}}:{}),D=h(()=>o.items.slice(0,o.maxItems)),ie=h(()=>(o.totalItems>=o.maxItems?o.maxItems:o.totalItems)-D.value.length),ce=e=>{const n=o.orderBy===e&&o.orderDirection===J.Ascending?J.Descending:J.Ascending;k("sort",e,n)},me=e=>o.orderBy===e,Le=h(()=>o.orderDirection===J.Ascending?"arrow-up-short":"arrow-down-short");let j=-1;const I=h(()=>{if(!o.groupBy)return null;const e=b(o.groupBy,x.value),n=u!=null&&u.value?b(o.groupBy,u.value):null;return e||n}),ve=h(()=>{var e;if(I.value)return((e=I.value.dataOption)==null?void 0:e.belongs_to)||I.value.name}),oe=h(()=>{var g;if(!I.value||!ve.value)return;const e=ve.value,n=!!((g=I.value.dataOption)!=null&&g.relation);let s=0,a;return D.value.reduce((d,y)=>{const t=n&&y[e]?y[e].id:y[e];return a&&t!==a&&(s+=1),d[s]||(d[s]=[]),d[s].push(y.id),a=t,d},[])}),Pe=(e,n)=>{var s,a;return((a=(s=oe.value)==null?void 0:s[e])==null?void 0:a.findIndex(g=>g===n))||0},Se=e=>{if(!I.value||!oe.value)return!1;e.id===D.value[0].id&&(j=-1);const n=j===-1||!oe.value[j].includes(e.id);return n&&(j+=1),n},ne=K(!1);je(()=>{ne.value=!1});const{isLoading:pe}=He(we(o,"scrollContainer"),async()=>{var e;ne.value=!0,await((e=o.onLoadMore)==null?void 0:e.call(o))},{distance:100,canLoadMore:()=>ie.value>0,eventListenerOptions:{passive:!0}});Ke(pe,()=>{ne.value=!0},{once:!0});const fe=h(()=>!ne.value||ie.value!==0?"":o.totalItems>o.maxItems?be.t("You reached the table limit of %s tickets (%s remaining).",o.maxItems,o.totalItems-D.value.length):be.t("You don't have more tickets to load.")),We=e=>{var n;if(o.object!==Ye.Ticket)return"";switch((n=e.priority)==null?void 0:n.uiColor){case"high-priority":return"text-red-500 dark:text-red-500";case"low-priority":return"text-stone-200 dark:text-neutral-500";default:return""}};return(e,n)=>{const s=O("FormKit"),a=O("CommonLabel"),g=O("CommonIcon"),d=O("CommonLink"),y=Ie("tooltip");return i(),m(P,null,[T("table",ue(e.$attrs,{ref:"table",class:"relative table-fixed pb-3"}),[f(Ze,{show:e.showCaption},{default:B(()=>[Q(V(e.caption),1)]),_:1},8,["show"]),T("thead",{class:w(["sticky top-0 z-10 bg-neutral-50 dark:bg-gray-500",{"border-shadow-b":!e.reachedScrollTop}])},[T("tr",null,[(i(!0),m(P,null,Z(C.value,(t,X)=>(i(),m("th",{id:`${t.name}-header`,key:t.name,class:w(["relative h-10 p-2.5 text-xs",[t.headerPreferences.headerClass,l[t.columnPreferences.alignContent??"left"]]])},[e.hasCheckboxColumn&&t.name==="checkbox"?(i(),z(s,{key:0,name:"checkbox-all-rows","aria-label":p(W)?e.$t("Deselect all entries"):e.$t("Select all entries"),type:"checkbox","model-value":p(W),"onUpdate:modelValue":p(te)},null,8,["aria-label","model-value","onUpdate:modelValue"])):Y(e.$slots,`column-header-${t.name}`,{key:1,attribute:t},()=>[T("div",{class:w(["flex items-center gap-1",[l[t.columnPreferences.alignContent||"left"],{"hover:cursor-pointer focus-visible:rounded-xs focus-visible:outline-1 focus-visible:outline-offset-2 focus-visible:outline-blue-800":!t.headerPreferences.noSorting}]]),role:t.headerPreferences.noSorting?void 0:"button",tabindex:t.headerPreferences.noSorting?void 0:"0","aria-label":e.orderDirection===p(J).Ascending?e.$t("Sorted ascending"):e.$t("Sorted descending"),onClick:c=>t.headerPreferences.noSorting?void 0:ce(t.name),onKeydown:[re(ae(c=>t.headerPreferences.noSorting?void 0:ce(t.name),["prevent"]),["enter"]),re(ae(c=>t.headerPreferences.noSorting?void 0:ce(t.name),["prevent"]),["space"])]},[f(a,{class:w(["relative block! truncate font-normal text-gray-100! select-none dark:text-neutral-400!",[t.headerPreferences.labelClass,{"sr-only":t.headerPreferences.hideLabel,"text-black! dark:text-white!":me(t.name),"hover:text-black! dark:hover:text-white!":!t.headerPreferences.noSorting}]]),size:"small"},{default:B(()=>[Q(V(e.$t(t.label,...t.labelPlaceholder||[])),1)]),_:2},1032,["class"]),!t.headerPreferences.noSorting&&me(t.name)?(i(),z(g,{key:0,class:"shrink-0 text-blue-800",name:Le.value,size:"xs",decorative:""},null,8,["name"])):E("",!0)],42,ht)],!0),Y(e.$slots,`header-suffix-${t.name}`,{item:t},void 0,!0),!t.headerPreferences.noResize&&X!==C.value.length-1?(i(),z(st,{key:2,onResize:G,onReset:le})):E("",!0)],10,dt))),128)),e.actions?(i(),m("th",mt,[f(a,{class:"font-normal text-stone-200! dark:text-neutral-500!",size:"small"},{default:B(()=>[Q(V(e.$t("Actions")),1)]),_:1})])):E("",!0)])],2),T("tbody",{class:w(["relative",{"opacity-50 before:absolute before:z-20 before:h-full before:w-full":e.isSorting}]),inert:e.isSorting},[(i(!0),m(P,null,Z(D.value,t=>(i(),m(P,{key:t.id},[I.value&&Se(t)?(i(),z(ut,{key:0,item:t,attribute:I.value,"table-column-length":se.value,"group-by-value-index":p(j),"group-by-row-counts":oe.value,"remaining-items":ie.value},null,8,["item","attribute","table-column-length","group-by-value-index","group-by-row-counts","remaining-items"])):E("",!0),f(et,ue({item:t,"is-row-selected":!e.hasCheckboxColumn&&t.id===o.selectedRowId,tabindex:"-1","has-checkbox":e.hasCheckboxColumn,"no-auto-striping":!!I.value,"is-striped":!!I.value&&Pe(p(j),t.id)%2===0},Oe(Te.value)),{default:B(({isRowSelected:X})=>[(i(!0),m(P,null,Z(C.value,c=>(i(),m("td",{key:`${t.id}-${c.name}`,class:w(["h-10 p-2.5 text-sm",[l[c.columnPreferences.alignContent||"left"],{"max-w-32 truncate text-black dark:text-white":c.headerPreferences.truncate}]])},[e.hasCheckboxColumn&&c.name==="checkbox"?(i(),z(s,{key:`checkbox-${t.id}-${c.name}`,name:`checkbox-${t.id}`,"aria-label":p($)(t.id)?e.$t("Deselect this entry"):e.$t("Select this entry"),type:"checkbox","alternative-background":!0,classes:{decorator:"group-active:formkit-checked:border-white group-hover:dark:border-white group-hover:group-active:border-white group-hover:group-active:peer-hover:border-white group-hover:formkit-checked:border-black group-hover:dark:formkit-checked:border-white group-hover:dark:peer-hover:border-white  ltr:group-hover:dark:group-hover:peer-hover:formkit-checked:border-white ltr:group-hover:peer-hover:dark:border-white rtl:group-hover:peer-hover:dark:border-white ltr:group-hover:peer-hover:border-black rtl:group-hover:peer-hover:border-black  group-hover:border-black",decoratorIcon:"group-active:formkit-checked:text-white group-hover:formkit-checked:text-black group-hover:formkit-checked:dark:text-white"},disabled:!!t.disabled,"model-value":p($)(t.id),onClick:ge=>p(F)(t),onKeydown:[re(ge=>p(F)(t),["enter"]),re(ge=>p(F)(t),["space"])]},null,8,["name","aria-label","disabled","model-value","onClick","onKeydown"])):(i(),m(P,{key:1},[Y(e.$slots,`column-cell-${c.name}`,{item:t,isRowSelected:X,attribute:c},()=>[c.columnPreferences.link?de((i(),z(d,{key:0,link:c.columnPreferences.link.getLink(t,c),"open-in-new-tab":c.columnPreferences.link.openInNewTab,internal:c.columnPreferences.link.internal,class:w([[{"text-black dark:text-white":X},We(t)],"block! truncate text-sm group-hover:text-black group-focus-visible:text-white group-active:text-white hover:no-underline! group-hover:dark:text-white"]),onClick:n[0]||(n[0]=ae(()=>{},["stop"])),onKeydown:n[1]||(n[1]=ae(()=>{},["stop"]))},{default:B(()=>[f(he,{mode:"table",attribute:c,object:t},null,8,["attribute","object"])]),_:2},1032,["link","open-in-new-tab","internal","class"])),[[y,N(t,c),void 0,{truncate:!0}]]):de((i(),z(a,{key:1,class:w(["block! truncate text-gray-100! group-hover:text-black! group-focus-visible:text-white! group-active:text-white! dark:text-neutral-400! group-hover:dark:text-white!",[{"text-black! dark:text-white!":X}]])},{default:B(()=>[f(he,{mode:"table",attribute:c,object:t},null,8,["attribute","object"])]),_:2},1032,["class"])),[[y,N(t,c),void 0,{truncate:!0}]])],!0),Y(e.$slots,`item-suffix-${c.name}`,{item:t},void 0,!0)],64))],2))),128)),e.actions?(i(),m("td",pt,[Y(e.$slots,"actions",ue({ref_for:!0},{actions:e.actions,item:t}),()=>[f(Ae,{class:"flex! items-center justify-center",actions:e.actions,entity:t,"button-size":"medium"},null,8,["actions","entity"])],!0)])):E("",!0)]),_:2},1040,["item","is-row-selected","has-checkbox","no-auto-striping","is-striped"])],64))),128)),f(Ve,{"leave-active-class":"absolute"},{default:B(()=>[p(pe)?(i(),m("div",{key:0,class:w([{"pt-10":D.value.length%2!==0},"absolute w-full pb-4"])},[f(ze,{rows:3})],2)):E("",!0)]),_:1})],10,vt)],16),fe.value?(i(),z(a,{key:0,class:"py-2.5 text-stone-200! dark:text-neutral-500!",size:"small"},{default:B(()=>[Q(V(fe.value),1)]),_:1})):E("",!0)],64)}}}),Bt=Ne(ft,[["__scopeId","data-v-05df1305"]]),gt={class:"flex justify-between gap-3 px-2.5 py-3"},Rt=A({__name:"CommonTableSkeleton",props:{rows:{}},setup(R){const v={1:"w-5 flex-shrink-0",2:"w-36",3:"w-5",4:"w-24",5:"w-16",6:"w-20",7:"w-32"};return(o,k)=>(i(),m("div",null,[T("div",gt,[(i(),m(P,null,Z(7,l=>f(Re,{key:l,style:_e({"animation-delay":`${l*.1}s`}),class:w(["h-3",v[l]])},null,8,["style","class"])),64))]),f(ze,{rows:o.rows||10},null,8,["rows"])]))}});export{Bt as C,Rt as _};
//# sourceMappingURL=CommonTableSkeleton.vue_vue_type_script_setup_true_lang-DxqYsGJE.js.map
