{"version":3,"file":"GuidedSetupStart-DCCCkLzH.js","sources":["../../../../../app/frontend/apps/desktop/pages/guided-setup/graphql/mutations/systemSetupLock.api.ts","../../../../../app/frontend/apps/desktop/pages/guided-setup/views/GuidedSetupStart.vue"],"sourcesContent":["import * as Types from '#shared/graphql/types.ts';\n\nimport gql from 'graphql-tag';\nimport { ErrorsFragmentDoc } from '../../../../../../shared/graphql/fragments/errors.api';\nimport * as VueApolloComposable from '@vue/apollo-composable';\nimport * as VueCompositionApi from 'vue';\nexport type ReactiveFunction<TParam> = () => TParam;\n\nexport const SystemSetupLockDocument = gql`\n    mutation systemSetupLock($ttl: Int) {\n  systemSetupLock(ttl: $ttl) {\n    resource\n    value\n    errors {\n      ...errors\n    }\n  }\n}\n    ${ErrorsFragmentDoc}`;\nexport function useSystemSetupLockMutation(options: VueApolloComposable.UseMutationOptions<Types.SystemSetupLockMutation, Types.SystemSetupLockMutationVariables> | ReactiveFunction<VueApolloComposable.UseMutationOptions<Types.SystemSetupLockMutation, Types.SystemSetupLockMutationVariables>> = {}) {\n  return VueApolloComposable.useMutation<Types.SystemSetupLockMutation, Types.SystemSetupLockMutationVariables>(SystemSetupLockDocument, options);\n}\nexport type SystemSetupLockMutationCompositionFunctionResult = VueApolloComposable.UseMutationReturn<Types.SystemSetupLockMutation, Types.SystemSetupLockMutationVariables>;","<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport { useRouter } from 'vue-router'\n\nimport {\n  EnumSystemSetupInfoStatus,\n  EnumSystemSetupInfoType,\n} from '#shared/graphql/types.ts'\nimport MutationHandler from '#shared/server/apollo/handler/MutationHandler.ts'\n\nimport CommonButton from '#desktop/components/CommonButton/CommonButton.vue'\nimport LayoutPublicPage from '#desktop/components/layout/LayoutPublicPage/LayoutPublicPage.vue'\n\nimport { useSystemSetupLockMutation } from '../graphql/mutations/systemSetupLock.api.ts'\nimport { systemSetupBeforeRouteEnterGuard } from '../router/guards/systemSetupBeforeRouteEnterGuard.ts'\nimport { useSystemSetupInfoStore } from '../stores/systemSetupInfo.ts'\n\ndefineOptions({\n  beforeRouteEnter: systemSetupBeforeRouteEnterGuard,\n})\n\nconst router = useRouter()\n\nconst systemSetupInfoStore = useSystemSetupInfoStore()\n\nconst startSetup = (type: EnumSystemSetupInfoType) => {\n  const lockMutation = new MutationHandler(useSystemSetupLockMutation())\n\n  lockMutation\n    .send()\n    .then((data) => {\n      systemSetupInfoStore.systemSetupInfo = {\n        lockValue: data?.systemSetupLock?.value || '',\n        type,\n        status: EnumSystemSetupInfoStatus.InProgress,\n      }\n\n      router.push(`/guided-setup/${type}`)\n    })\n    .catch(() => {})\n}\n</script>\n\n<template>\n  <LayoutPublicPage box-size=\"medium\" :title=\"__('Welcome!')\" show-logo>\n    <CommonAlert\n      v-if=\"systemSetupInfoStore.systemSetupAlreadyStarted\"\n      variant=\"warning\"\n      >{{\n        $t(\n          'The setup has already been started. Please wait until it is finished.',\n        )\n      }}</CommonAlert\n    >\n\n    <template v-if=\"!systemSetupInfoStore.systemSetupAlreadyStarted\">\n      <div class=\"mt-10 mb-14 text-center\">\n        <CommonButton\n          type=\"submit\"\n          variant=\"primary\"\n          size=\"large\"\n          @click=\"startSetup(EnumSystemSetupInfoType.Manual)\"\n        >\n          {{ $t('Set up a new system') }}\n        </CommonButton>\n      </div>\n\n      <div class=\"text-center\">\n        <CommonButton\n          type=\"submit\"\n          variant=\"secondary\"\n          size=\"large\"\n          @click=\"startSetup(EnumSystemSetupInfoType.Import)\"\n        >\n          {{ $t('Or migrate from another system') }}\n        </CommonButton>\n      </div>\n    </template>\n  </LayoutPublicPage>\n</template>\n"],"names":["SystemSetupLockDocument","gql","ErrorsFragmentDoc","useSystemSetupLockMutation","options","VueApolloComposable.useMutation","router","useRouter","systemSetupInfoStore","useSystemSetupInfoStore","startSetup","type","MutationHandler","data","_a","EnumSystemSetupInfoStatus"],"mappings":"w5CAQO,MAAMA,EAA0BC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUjCC,CAAiB,GACP,SAAAC,EAA2BC,EAA2P,GAAI,CACjS,OAAAC,EAAuGL,EAAyBI,CAAO,CAChJ,+HCCA,MAAME,EAASC,IAETC,EAAuBC,IAEvBC,EAAcC,GAAkC,CAC/B,IAAIC,EAAgBT,EAA4B,CAAA,EAGlE,KAAK,EACL,KAAMU,GAAS,OACdL,EAAqB,gBAAkB,CACrC,YAAWM,EAAAD,GAAA,YAAAA,EAAM,kBAAN,YAAAC,EAAuB,QAAS,GAC3C,KAAAH,EACA,OAAQI,EAA0B,UAAA,EAG7BT,EAAA,KAAK,iBAAiBK,CAAI,EAAE,CAAA,CACpC,EACA,MAAM,IAAM,CAAA,CAAE,CAAA"}