{"version":3,"file":"IssueTrackerLinkFlyout-C7Kc7G8o.js","sources":["../../../../../app/frontend/apps/desktop/pages/ticket/components/TicketSidebar/TicketSidebarExternalReferences/TicketSidebarExternalIssueTracker/IssueTrackerLinkFlyout.vue"],"sourcesContent":["<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport Form from '#shared/components/Form/Form.vue'\nimport { useForm } from '#shared/components/Form/useForm.ts'\n\nimport CommonFlyout from '#desktop/components/CommonFlyout/CommonFlyout.vue'\nimport { closeFlyout } from '#desktop/components/CommonFlyout/useFlyout.ts'\nimport type { SubmitData } from '#desktop/pages/ticket/components/TicketSidebar/TicketSidebarExternalReferences/types.ts'\n\nimport type { FormKitNode } from '@formkit/core'\n\ninterface Props {\n  name: string\n  icon: string\n  label: string\n  inputPlaceholder: string\n  issueLinks: string[]\n  onSubmit: (link: string) => Promise<unknown>\n}\n\nconst props = defineProps<Props>()\n\nconst { form } = useForm()\n\nconst validationRuleUrlAlreadyExists = (node: FormKitNode) => {\n  if (!node.value) return true\n\n  return !props.issueLinks.includes(node.value as string)\n}\n\nconst linkSchema = [\n  {\n    name: 'link',\n    type: 'url',\n    placeholder: props.inputPlaceholder,\n    label: __('Issue URL'),\n    validationRules: {\n      validationRuleUrlAlreadyExists,\n    },\n    validation: 'validationRuleUrlAlreadyExists|url',\n    validationMessages: {\n      validationRuleUrlAlreadyExists: __('The issue reference already exists.'),\n    },\n    required: true,\n  },\n]\n\nconst submitLink = async (data: SubmitData) => {\n  const { link } = data\n\n  await props.onSubmit(link)\n\n  return () => closeFlyout(props.name)\n}\n</script>\n\n<template>\n  <CommonFlyout\n    :header-icon=\"icon\"\n    :header-title=\"label\"\n    :name=\"name\"\n    no-close-on-action\n    :footer-action-options=\"{\n      actionButton: {\n        type: 'submit',\n      },\n      actionLabel: $t('Link Issue'),\n      form: form,\n    }\"\n  >\n    <Form\n      ref=\"form\"\n      :schema=\"linkSchema\"\n      should-autofocus\n      @submit=\"submitLink($event as SubmitData)\"\n    />\n  </CommonFlyout>\n</template>\n"],"names":["props","__props","form","useForm","validationRuleUrlAlreadyExists","node","linkSchema","submitLink","data","link","closeFlyout"],"mappings":"k2CAqBA,MAAMA,EAAQC,EAER,CAAE,KAAAC,GAASC,IAEXC,EAAkCC,GACjCA,EAAK,MAEH,CAACL,EAAM,WAAW,SAASK,EAAK,KAAe,EAF9B,GAKpBC,EAAa,CACjB,CACE,KAAM,OACN,KAAM,MACN,YAAaN,EAAM,iBACnB,MAAO,GAAG,WAAW,EACrB,gBAAiB,CACf,+BAAAI,CACF,EACA,WAAY,qCACZ,mBAAoB,CAClB,+BAAgC,GAAG,qCAAqC,CAC1E,EACA,SAAU,EACZ,CAAA,EAGIG,EAAa,MAAOC,GAAqB,CACvC,KAAA,CAAE,KAAAC,CAAS,EAAAD,EAEX,aAAAR,EAAM,SAASS,CAAI,EAElB,IAAMC,EAAYV,EAAM,IAAI,CAAA"}