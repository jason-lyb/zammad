{"version":3,"file":"dom-0wVl69Vp.js","sources":["../../../../../app/frontend/shared/utils/dom.ts"],"sourcesContent":["// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { type MaybeRef, toValue } from 'vue'\n\nimport type { FormFieldValue } from '#shared/components/Form/types.ts'\n\nexport const domFrom = (html: string, document_ = document) => {\n  const dom = document_.createElement('div')\n  dom.innerHTML = html\n  return dom\n}\n\nexport const removeSignatureFromBody = (input: FormFieldValue) => {\n  if (!input || typeof input !== 'string') {\n    return input\n  }\n\n  const dom = domFrom(input)\n\n  dom\n    .querySelectorAll('div[data-signature=\"true\"]')\n    .forEach((elem) => elem.remove())\n\n  return dom.innerHTML\n}\n\n/**\n * Queries all images in the container and waits for them to load.\n * */\nexport const waitForImagesToLoad = async (container: MaybeRef) => {\n  const inlineImages: HTMLImageElement[] =\n    toValue(container).querySelectorAll('img')\n\n  if (inlineImages.length > 0) {\n    return Promise.allSettled<null>(\n      Array.from(inlineImages).map((image) => {\n        return new Promise((resolve, reject) => {\n          const cleanup = () => {\n            image.onload = null\n            image.onerror = null\n          }\n\n          const handleLoad = () => {\n            cleanup()\n            resolve(null)\n          }\n\n          const handleError = () => {\n            cleanup()\n            reject()\n          }\n\n          image.onload = handleLoad\n          image.onerror = handleError\n        })\n      }),\n    )\n  }\n\n  return Promise.allSettled<null>([])\n}\n"],"names":["domFrom","html","document_","dom","removeSignatureFromBody","input","elem","waitForImagesToLoad","container","inlineImages","toValue","image","resolve","reject","cleanup","handleLoad","handleError"],"mappings":"sCAMO,MAAMA,EAAU,CAACC,EAAcC,EAAY,WAAa,CACvD,MAAAC,EAAMD,EAAU,cAAc,KAAK,EACzC,OAAAC,EAAI,UAAYF,EACTE,CACT,EAEaC,EAA2BC,GAA0B,CAChE,GAAI,CAACA,GAAS,OAAOA,GAAU,SACtB,OAAAA,EAGH,MAAAF,EAAMH,EAAQK,CAAK,EAGtB,OAAAF,EAAA,iBAAiB,4BAA4B,EAC7C,QAASG,GAASA,EAAK,QAAQ,EAE3BH,EAAI,SACb,EAKaI,EAAsB,MAAOC,GAAwB,CAChE,MAAMC,EACJC,EAAQF,CAAS,EAAE,iBAAiB,KAAK,EAEvC,OAAAC,EAAa,OAAS,EACjB,QAAQ,WACb,MAAM,KAAKA,CAAY,EAAE,IAAKE,GACrB,IAAI,QAAQ,CAACC,EAASC,IAAW,CACtC,MAAMC,EAAU,IAAM,CACpBH,EAAM,OAAS,KACfA,EAAM,QAAU,IAAA,EAGZI,EAAa,IAAM,CACfD,IACRF,EAAQ,IAAI,CAAA,EAGRI,EAAc,IAAM,CAChBF,IACDD,GAAA,EAGTF,EAAM,OAASI,EACfJ,EAAM,QAAUK,CAAA,CACjB,CACF,CAAA,EAIE,QAAQ,WAAiB,CAAA,CAAE,CACpC"}