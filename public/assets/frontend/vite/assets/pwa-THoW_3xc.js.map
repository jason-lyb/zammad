{"version":3,"file":"pwa-THoW_3xc.js","sources":["../../../../../app/frontend/shared/utils/pwa.ts"],"sourcesContent":["// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport { computed, shallowRef } from 'vue'\n\nexport const isStandalone = () =>\n  (('standalone' in window.navigator &&\n    window.navigator.standalone) as boolean) ||\n  window.matchMedia('(display-mode: standalone)').matches\n\ninterface InstallEvent extends Event {\n  prompt(): Promise<void>\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>\n}\n\nconst deferredPrompt = shallowRef<InstallEvent | null>(null)\n\nexport const usePWASupport = () => {\n  const canInstallPWA = computed(() => deferredPrompt.value !== null)\n\n  const installPWA = async () => {\n    if (!deferredPrompt.value) return\n\n    deferredPrompt.value.prompt()\n\n    const { outcome } = await deferredPrompt.value.userChoice\n    if (outcome === 'accepted') {\n      deferredPrompt.value = null\n    }\n  }\n\n  return {\n    canInstallPWA,\n    installPWA,\n  }\n}\n\nexport const registerPWAHooks = () => {\n  // this only works in Chrome, for iOS Safari users have to do it manually\n  // for iOS we are showing a short guide on how to do it\n  window.addEventListener('beforeinstallprompt', (e) => {\n    deferredPrompt.value = e as InstallEvent\n  })\n  window.addEventListener('appinstalled', () => {\n    deferredPrompt.value = null\n  })\n}\n\nif (import.meta.env.DEV) {\n  import('./testSw.ts')\n}\n"],"names":["isStandalone","deferredPrompt","shallowRef","usePWASupport","computed","outcome","registerPWAHooks","e"],"mappings":"6CAIa,MAAAA,EAAe,IACxB,eAAgB,OAAO,WACvB,OAAO,UAAU,YACnB,OAAO,WAAW,4BAA4B,EAAE,QAO5CC,EAAiBC,EAAgC,IAAI,EAE9CC,EAAgB,KAcpB,CACL,cAdoBC,EAAS,IAAMH,EAAe,QAAU,IAAI,EAehE,WAbiB,SAAY,CACzB,GAAA,CAACA,EAAe,MAAO,OAE3BA,EAAe,MAAM,SAErB,KAAM,CAAE,QAAAI,CAAY,EAAA,MAAMJ,EAAe,MAAM,WAC3CI,IAAY,aACdJ,EAAe,MAAQ,KACzB,CAKA,GAISK,EAAmB,IAAM,CAG7B,OAAA,iBAAiB,sBAAwBC,GAAM,CACpDN,EAAe,MAAQM,CAAA,CACxB,EACM,OAAA,iBAAiB,eAAgB,IAAM,CAC5CN,EAAe,MAAQ,IAAA,CACxB,CACH"}