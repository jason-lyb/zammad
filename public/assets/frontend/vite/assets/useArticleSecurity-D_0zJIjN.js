import{M as h,N as c,c as E}from"./apollo-Cj5TVUDk.js";import{v as A}from"./overviewAttributes.api-C09LSZ8O.js";import{f as P}from"./ticketArticleRetrySecurityProcess.api-pSAexXXb.js";import{i as f}from"./routes-CgLO9M4y.js";import{c as n}from"./vue-oicRkvo0.js";const R=e=>{const{notify:u}=E(),a=n(()=>{var t,s;return(s=(t=e.value)==null?void 0:t.securityState)==null?void 0:s.signingSuccess}),v=n(()=>{var t,s;return(s=(t=e.value)==null?void 0:t.securityState)==null?void 0:s.signingMessage}),o=n(()=>{var t,s;return(s=(t=e.value)==null?void 0:t.securityState)==null?void 0:s.encryptionSuccess}),d=n(()=>{var t,s;return(s=(t=e.value)==null?void 0:t.securityState)==null?void 0:s.encryptionMessage}),y=n(()=>{var t,s,i;return((t=e.value.securityState)==null?void 0:t.encryptionSuccess)||((s=e.value.securityState)==null?void 0:s.encryptionSuccess)===!1&&((i=e.value.securityState)==null?void 0:i.encryptionMessage)}),g=n(()=>{var t,s,i;return((t=e.value.securityState)==null?void 0:t.signingSuccess)||((s=e.value.securityState)==null?void 0:s.signingSuccess)===!1&&((i=e.value.securityState)==null?void 0:i.signingMessage)}),m=n(()=>e.value.securityState&&(y.value||g.value)),l=n(()=>{var t,s,i,r;return e.value.securityState?((t=e==null?void 0:e.value.securityState)==null?void 0:t.signingSuccess)===!1&&((s=e==null?void 0:e.value.securityState)!=null&&s.signingMessage)?!0:!!(((i=e==null?void 0:e.value.securityState)==null?void 0:i.encryptionSuccess)===!1&&((r=e==null?void 0:e.value.securityState)!=null&&r.encryptionMessage)):!1}),_=async()=>{var r,S,p;const s=await new h(P(()=>({variables:{articleId:e.value.id}}))).send(),i=(r=s==null?void 0:s.ticketArticleRetrySecurityProcess)==null?void 0:r.retryResult;if(!i)return u({id:"retry-security-error",type:c.Error,message:__("The retried security process failed!"),timeout:2e3});if(i.type!==((p=(S=e.value)==null?void 0:S.securityState)==null?void 0:p.type))return u({id:"security-mechanism-error",type:c.Error,message:__("Article uses different security mechanism."),timeout:2e3});i.signingSuccess?u({id:"signature-verified",type:c.Success,message:__("The signature was successfully verified.")}):i.signingMessage&&u({id:"signature-verification-failed",type:c.Error,message:__("Signature verification failed! %s"),messagePlaceholder:[f.t(i.signingMessage)],timeout:2e3}),i.encryptionSuccess?u({id:"decryption-success",type:c.Success,message:__("Decryption was successful.")}):i.encryptionMessage&&u({id:"decryption-failed",type:c.Error,message:__("Decryption failed! %s"),messagePlaceholder:[f.t(i.encryptionMessage)],timeout:2e3})},M=n(()=>{var t,s,i,r;if((s=(t=e.value)==null?void 0:t.securityState)!=null&&s.type)return A((r=(i=e.value)==null?void 0:i.securityState)==null?void 0:r.type)});return{hasError:l,signingSuccess:a,signingMessage:v,encryptionSuccess:o,encryptionMessage:d,isEncrypted:y,isSigned:g,hasSecurityAttribute:m,typeLabel:M,signingIcon:n(()=>a.value?"signing-success":"signing-fail"),encryptionIcon:n(()=>o.value?"encryption-success":"encryption-fail"),signedStatusMessage:n(()=>a.value?__("Signed"):__("Sign error")),encryptedStatusMessage:n(()=>o.value?__("Encrypted"):__("Encryption error")),retrySecurityProcess:_}};export{R as u};
//# sourceMappingURL=useArticleSecurity-D_0zJIjN.js.map
