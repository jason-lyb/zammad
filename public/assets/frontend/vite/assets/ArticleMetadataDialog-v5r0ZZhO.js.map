{"version":3,"file":"ArticleMetadataDialog-v5r0ZZhO.js","sources":["../../../../../app/frontend/shared/entities/ticket-article/composables/getArticleChannelIcon.ts","../../../../../app/frontend/apps/mobile/pages/ticket/components/TicketDetailView/ArticleMetadataAddress.vue","../../../../../app/frontend/apps/mobile/pages/ticket/components/TicketDetailView/ArticleMetadataDialog.vue"],"sourcesContent":["// Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/\n\nimport channelIconsMap from './channelIconsMap.json'\n\nexport const getArticleChannelIcon = (\n  articleType: string,\n): string | undefined => {\n  const typeGroup = articleType.split(' ')[0]\n  return (channelIconsMap as Record<string, string>)[typeGroup]\n}\n","<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nimport type { TicketArticle } from '#shared/entities/ticket/types.ts'\n\nimport CommonSectionMenuItem from '#mobile/components/CommonSectionMenu/CommonSectionMenuItem.vue'\n\ninterface Props {\n  address?: TicketArticle['from']\n  label: string\n}\n\nconst props = defineProps<Props>()\n\nconst show = computed(() => {\n  const { address } = props\n  if (!address) return false\n  return (address.raw && address.raw !== '-  <>') || address.parsed?.length\n})\n</script>\n\n<template>\n  <CommonSectionMenuItem v-if=\"address && show\" :label=\"label\">\n    <div v-if=\"!address.parsed\">{{ address.raw }}</div>\n    <div\n      v-for=\"(contact, idx) of address.parsed || []\"\n      :key=\"idx\"\n      data-test-id=\"metadataAddress\"\n    >\n      <div>{{ contact.name }}</div>\n      <div class=\"text-sm text-white/75\">\n        &lt;{{ contact.emailAddress }}&gt;\n      </div>\n    </div>\n  </CommonSectionMenuItem>\n</template>\n","<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport { computed, toRef } from 'vue'\n\nimport ObjectAttributeContent from '#shared/components/ObjectAttributes/ObjectAttribute.vue'\nimport { useArticleSecurity } from '#shared/composables/useArticleSecurity.ts'\nimport { useObjectAttributes } from '#shared/entities/object-attributes/composables/useObjectAttributes.ts'\nimport { useWhatsapp } from '#shared/entities/ticket/channel/composables/useWhatsapp.ts'\nimport type { TicketArticle } from '#shared/entities/ticket/types.ts'\nimport { getArticleChannelIcon } from '#shared/entities/ticket-article/composables/getArticleChannelIcon.ts'\nimport { translateArticleSecurity } from '#shared/entities/ticket-article/composables/translateArticleSecurity.ts'\nimport { EnumObjectManagerObjects } from '#shared/graphql/types.ts'\n\nimport CommonDialog from '#mobile/components/CommonDialog/CommonDialog.vue'\nimport CommonSectionMenu from '#mobile/components/CommonSectionMenu/CommonSectionMenu.vue'\nimport CommonSectionMenuItem from '#mobile/components/CommonSectionMenu/CommonSectionMenuItem.vue'\n\nimport ArticleMetadataAddress from './ArticleMetadataAddress.vue'\n\ninterface Props {\n  name: string\n  article: TicketArticle\n  ticketInternalId: number\n}\n\nconst props = defineProps<Props>()\n\nconst channelIcon = computed(() => {\n  const name = props.article.type?.name\n  if (name) return getArticleChannelIcon(name)\n  return undefined\n})\n\nconst { articleDeliveryStatus } = useWhatsapp(toRef(props.article))\n\nconst links = computed(() => {\n  const { article } = props\n  // Example for usage: https://github.com/zammad/zammad/blob/develop/app/jobs/communicate_twitter_job.rb#L65\n  const links = [...(article.preferences?.links || [])]\n  if (article.type?.name === 'email') {\n    links.push({\n      label: __('Raw'),\n      api: true,\n      url: `/ticket_article_plain/${article.internalId}`,\n      target: '_blank',\n    })\n  }\n  article.attachmentsWithoutInline.forEach((file) => {\n    if (file.preferences?.['original-format'] !== true) {\n      return\n    }\n    const articleInternalId = props.article.internalId\n    const attachmentInternalId = file.internalId\n    const { ticketInternalId } = props\n    const url = `/ticket_attachment/${ticketInternalId}/${articleInternalId}/${attachmentInternalId}?disposition=attachment`\n    links.push({\n      label: __('Original Formatting'),\n      api: true,\n      url,\n      target: '_blank',\n    })\n  })\n  return links\n})\n\nconst {\n  signingIcon,\n  signingMessage,\n  encryptionMessage,\n  isEncrypted,\n  isSigned,\n  hasSecurityAttribute,\n  encryptionIcon,\n  encryptedStatusMessage,\n  signedStatusMessage,\n} = useArticleSecurity(toRef(props.article))\n\nconst { attributesLookup } = useObjectAttributes(\n  EnumObjectManagerObjects.TicketArticle,\n)\n\nconst detectedLanguageAttribute = computed(() =>\n  attributesLookup.value.get('detected_language'),\n)\n</script>\n\n<template>\n  <CommonDialog :label=\"__('Meta Data')\" :name=\"name\" class=\"p-4\">\n    <CommonSectionMenu>\n      <ArticleMetadataAddress :address=\"article.from\" :label=\"__('From')\" />\n      <ArticleMetadataAddress\n        :address=\"article.replyTo\"\n        :label=\"__('Reply-To')\"\n      />\n      <ArticleMetadataAddress :address=\"article.to\" :label=\"__('To')\" />\n      <ArticleMetadataAddress :address=\"article.cc\" :label=\"__('CC')\" />\n      <CommonSectionMenuItem v-if=\"article.subject\" :label=\"__('Subject')\">\n        <div>{{ article.subject }}</div>\n      </CommonSectionMenuItem>\n      <CommonSectionMenuItem\n        v-if=\"article.detectedLanguage\"\n        :label=\"__('Detected language')\"\n      >\n        <ObjectAttributeContent\n          v-if=\"detectedLanguageAttribute\"\n          :attribute=\"detectedLanguageAttribute\"\n          :object=\"article\"\n        />\n        <div v-else>{{ article.detectedLanguage }}</div>\n      </CommonSectionMenuItem>\n      <CommonSectionMenuItem v-if=\"article.type?.name\" :label=\"__('Channel')\">\n        <span class=\"inline-flex items-center gap-1\">\n          <CommonIcon\n            v-if=\"channelIcon\"\n            :name=\"channelIcon\"\n            size=\"tiny\"\n            class=\"inline\"\n          />\n          {{ $t(article.type.name) }}\n        </span>\n        <div class=\"leading-3\">\n          <CommonLink\n            v-for=\"{ url, api, label, target } of links\"\n            :key=\"url\"\n            :link=\"url\"\n            :rest-api=\"api\"\n            :target=\"target\"\n            class=\"text-sm text-white/75 after:inline after:content-['|'] last:after:hidden ltr:mr-1 ltr:after:ml-1 rtl:ml-1 rtl:after:mr-1\"\n          >\n            {{ $t(label) }}\n          </CommonLink>\n        </div>\n      </CommonSectionMenuItem>\n      <CommonSectionMenuItem\n        v-if=\"articleDeliveryStatus\"\n        :label=\"__('Message Status')\"\n      >\n        <CommonIcon\n          :name=\"articleDeliveryStatus.icon\"\n          size=\"tiny\"\n          class=\"inline\"\n        />\n        {{ $t(articleDeliveryStatus.message) }}\n      </CommonSectionMenuItem>\n      <CommonSectionMenuItem :label=\"__('Created')\">\n        <CommonDateTime :date-time=\"article.createdAt\" type=\"absolute\" />\n      </CommonSectionMenuItem>\n      <CommonSectionMenuItem\n        v-if=\"hasSecurityAttribute\"\n        :label=\"__('Security')\"\n      >\n        <div class=\"flex flex-col gap-1\">\n          <span v-if=\"article.securityState?.type\">\n            {{ translateArticleSecurity(article.securityState.type) }}\n          </span>\n\n          <span v-if=\"isEncrypted\">\n            <CommonIcon\n              class=\"mb-1 inline\"\n              size=\"tiny\"\n              :name=\"encryptionIcon\"\n            />\n            {{ $t(encryptedStatusMessage) }}\n            <div v-if=\"encryptionMessage\" class=\"ms-5 break-all\">\n              {{ $t(encryptionMessage) }}\n            </div>\n          </span>\n\n          <span v-if=\"isSigned\">\n            <CommonIcon class=\"mb-1 inline\" size=\"tiny\" :name=\"signingIcon\" />\n            {{ $t(signedStatusMessage) }}\n            <div v-if=\"signingMessage\" class=\"ms-5 break-all\">\n              {{ $t(signingMessage) }}\n            </div>\n          </span>\n        </div>\n      </CommonSectionMenuItem>\n    </CommonSectionMenu>\n  </CommonDialog>\n</template>\n"],"names":["getArticleChannelIcon","articleType","typeGroup","channelIconsMap","props","__props","show","computed","address","_a","channelIcon","name","articleDeliveryStatus","useWhatsapp","toRef","links","article","_b","file","articleInternalId","attachmentInternalId","ticketInternalId","url","signingIcon","signingMessage","encryptionMessage","isEncrypted","isSigned","hasSecurityAttribute","encryptionIcon","encryptedStatusMessage","signedStatusMessage","useArticleSecurity","attributesLookup","useObjectAttributes","EnumObjectManagerObjects","detectedLanguageAttribute"],"mappings":"09CAIaA,GACXC,GACuB,CACvB,MAAMC,EAAYD,EAAY,MAAM,GAAG,EAAE,CAAC,EAC1C,OAAQE,GAA2CD,CAAS,CAC9D,0HCKA,MAAME,EAAQC,EAERC,EAAOC,EAAS,IAAM,OACpB,KAAA,CAAE,QAAAC,CAAY,EAAAJ,EAChB,OAACI,EACGA,EAAQ,KAAOA,EAAQ,MAAQ,WAAYC,EAAAD,EAAQ,SAAR,YAAAC,EAAgB,QAD9C,EAC8C,CACpE,onBCMD,MAAML,EAAQC,EAERK,EAAcH,EAAS,IAAM,OAC3B,MAAAI,GAAOF,EAAAL,EAAM,QAAQ,OAAd,YAAAK,EAAoB,KAC7B,GAAAE,EAAa,OAAAX,GAAsBW,CAAI,CACpC,CACR,EAEK,CAAE,sBAAAC,CAAsB,EAAIC,EAAYC,EAAMV,EAAM,OAAO,CAAC,EAE5DW,EAAQR,EAAS,IAAM,SACrB,KAAA,CAAE,QAAAS,CAAY,EAAAZ,EAEdW,EAAQ,CAAC,KAAIN,EAAAO,EAAQ,cAAR,YAAAP,EAAqB,QAAS,CAAA,CAAG,EAChD,QAAAQ,EAAAD,EAAQ,OAAR,YAAAC,EAAc,QAAS,SACzBF,EAAM,KAAK,CACT,MAAO,GAAG,KAAK,EACf,IAAK,GACL,IAAK,yBAAyBC,EAAQ,UAAU,GAChD,OAAQ,QAAA,CACT,EAEKA,EAAA,yBAAyB,QAASE,GAAS,OACjD,KAAIT,EAAAS,EAAK,cAAL,YAAAT,EAAmB,sBAAuB,GAC5C,OAEI,MAAAU,EAAoBf,EAAM,QAAQ,WAClCgB,EAAuBF,EAAK,WAC5B,CAAE,iBAAAG,CAAqB,EAAAjB,EACvBkB,EAAM,sBAAsBD,CAAgB,IAAIF,CAAiB,IAAIC,CAAoB,0BAC/FL,EAAM,KAAK,CACT,MAAO,GAAG,qBAAqB,EAC/B,IAAK,GACL,IAAAO,EACA,OAAQ,QAAA,CACT,CAAA,CACF,EACMP,CAAA,CACR,EAEK,CACJ,YAAAQ,EACA,eAAAC,EACA,kBAAAC,EACA,YAAAC,EACA,SAAAC,EACA,qBAAAC,EACA,eAAAC,EACA,uBAAAC,EACA,oBAAAC,CACE,EAAAC,EAAmBlB,EAAMV,EAAM,OAAO,CAAC,EAErC,CAAE,iBAAA6B,GAAqBC,EAC3BC,EAAyB,aAAA,EAGrBC,EAA4B7B,EAAS,IACzC0B,EAAiB,MAAM,IAAI,mBAAmB,CAAA"}