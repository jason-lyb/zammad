const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TicketChangeCustomerFlyout-fDcamutV.js","assets/Form.vue_vue_type_script_setup_true_lang-B6L-6HzY.js","assets/vue-oicRkvo0.js","assets/vendor-C11O1Xx8.js","assets/commonjsHelpers-BosuxZz1.js","assets/formkit-5nol1GBe.js","assets/apollo-Cj5TVUDk.js","assets/lodash-pFOI14f-.js","assets/overviewAttributes.api-C09LSZ8O.js","assets/routes-CgLO9M4y.js","assets/vite-FJshFMF2.js","assets/overviewAttributes-r_4zXopK.css","assets/FormGroup.vue_vue_type_script_setup_true_lang-DIx-HUKU.js","assets/Form-BSACsGR2.css","assets/useForm-CUKec4n5.js","assets/useTicketChangeCustomer-gjGu9BEY.js","assets/ticketAttributes.api-rqx5ITab.js","assets/useTicketFormOrganizationHandler-DLoRMaF_.js","assets/CommonFlyout.vue_vue_type_script_setup_true_lang-Cr1ukr3s.js","assets/desktop-l0eJ1dZN.js","assets/useCopyToClipboard-CjkPg__g.js","assets/theme-Bv2ClBzZ.js","assets/datepicker-BBNcWeHz.js","assets/date-B2UyDZN7.js","assets/autocompleteTags.api-CG5-cm_A.js","assets/autocompleteSearchTicket.api-DfOQWGlO.js","assets/ticketUpdates.api-BhGIG_Ti.js","assets/useTicketCreateArticleType-D7iVcJ_6.js","assets/types-Cu-Nkl7K.js","assets/useTicketCreateView-HCH46SPv.js","assets/desktop-BAkSnNV9.css","assets/CommonOverlayContainer.vue_vue_type_script_setup_true_lang-CxyKmNUC.js","assets/LayoutSidebar.vue_vue_type_script_setup_true_lang-BO1pkKrb.js","assets/useFlyout-KZXqW5RR.js","assets/IssueTrackerLinkFlyout-C7Kc7G8o.js","assets/IdoitFlyout-DyMAwuk1.js","assets/useDebouncedLoading-D3djd3bz.js","assets/CommonError.vue_vue_type_script_setup_true_lang-B76hdJ4v.js","assets/LayoutMain.vue_vue_type_script_setup_true_lang-DIWzj6-0.js","assets/index-DwuY2HL4.js","assets/CommonInlineEdit.vue_vue_type_script_setup_true_lang-Blo3VlqB.js","assets/useHtmlLinks-53b5zJaG.js","assets/pwa-THoW_3xc.js","assets/useBaseUrl-BsZiEKQE.js","assets/useUserDetail-C29_PwWz.js","assets/user.api-BwewaCks.js","assets/ObjectAttributes.vue_vue_type_script_setup_true_lang-B0DrxGTz.js","assets/useDisplayObjectAttributes-sspS-pHp.js","assets/useTicketView-CMOCBKg-.js","assets/CommonSectionCollapse.vue_vue_type_script_setup_true_lang-B-hHJAEI.js","assets/NavigationMenuList.vue_vue_type_script_setup_true_lang-CYOBePFr.js","assets/useTicketAccountedTime-CSL2Xls9.js","assets/useTicketSubscribe-CmWzZx1x.js","assets/useOrganizationDetail-CenI9U-0.js","assets/dom-0wVl69Vp.js","assets/useAttachments-0IU6Vvzp.js","assets/getAttachmentLinks-Dz1qdLDp.js","assets/TicketLinksFlyout-D2di-eBe.js","assets/useTargetTicketOptions-Dw9uFPEv.js","assets/getTicketNumber-CTSsSeKd.js","assets/TicketMergeFlyout-DexMxunL.js","assets/merge.api-B2JVH7J2.js","assets/TicketHistoryFlyout-BhLoj9zT.js","assets/CommonTranslateRenderer.vue_vue_type_script_setup_true_lang-B8a5B2Eg.js","assets/TicketSharedDraftFlyout-D8RqO8NH.js","assets/CommonCalendarPreviewFlyout-EsrCnnze.js","assets/openExternalLink-B2ZtqYBi.js"])))=>i.map(i=>d[i]);
import{c as y,$ as gt,i as Je,w as ee,f as U,ar as vt,r as q,aX as ht,m as u,D as g,y as h,q as T,z as Pe,E,aZ as Kt,d as Ht,a1 as R,a8 as $e,p as w,U as ae,H as Q,Q as j,M as O,G as Zt,J as F,a7 as ge,u as b,x as ie,aF as Wt,T as ut,aa as se,ab as oe,k as Le,a0 as Yt,I as G,n as et,b as he,F as yt,K as Xt,t as le,L as we,aV as Jt,V as qe,W as ei,a$ as ti,b0 as ii,v as si,C as ni}from"./vue-oicRkvo0.js";import{Q as Fe,a as It,d as ai,i as tt,e as ye,a3 as Be,a4 as Te,a5 as xe,b as oi,c as ri}from"./routes-CgLO9M4y.js";import{E as dt,a as li,S as ci,u as re,Q as de,U as ui,c as ze,N as _e,e as W,M as J,f as De,g as di,G as mi}from"./apollo-Cj5TVUDk.js";import{_ as ki}from"./CommonError.vue_vue_type_script_setup_true_lang-B76hdJ4v.js";import{_ as pi,u as fi}from"./LayoutMain.vue_vue_type_script_setup_true_lang-DIWzj6-0.js";import{u as it,n as P}from"./vendor-C11O1Xx8.js";import{g as Ge,B as bi,c as H,C as gi,f as vi,b as Tt,a as Ke,D as hi,d as Ee,r as yi,_ as Ii}from"./desktop-l0eJ1dZN.js";import{b as Me,a as Ce}from"./lodash-pFOI14f-.js";import{a5 as Ti,Z as Ue,aR as Re,X as te,a2 as He,i as _t,_ as st,ap as nt,aV as _i,aW as Ci}from"./overviewAttributes.api-C09LSZ8O.js";import{T as $i}from"./ticketAttributes.api-rqx5ITab.js";import{T as Si,R as at}from"./ticketUpdates.api-BhGIG_Ti.js";import{d as wi,a as Di}from"./index-DwuY2HL4.js";import{_ as Ze}from"./CommonInlineEdit.vue_vue_type_script_setup_true_lang-Blo3VlqB.js";import{u as Ct,_ as $t,b as Li}from"./theme-Bv2ClBzZ.js";import{u as Ei}from"./useUserDetail-C29_PwWz.js";import{_ as ce}from"./vite-FJshFMF2.js";import{_ as St}from"./ObjectAttributes.vue_vue_type_script_setup_true_lang-B0DrxGTz.js";import{u as wt}from"./useTicketView-CMOCBKg-.js";import{u as ue}from"./useFlyout-KZXqW5RR.js";import{_ as ve}from"./CommonSectionCollapse.vue_vue_type_script_setup_true_lang-B-hHJAEI.js";import{_ as Vi,N as Oi}from"./NavigationMenuList.vue_vue_type_script_setup_true_lang-CYOBePFr.js";import{u as Ai}from"./useForm-CUKec4n5.js";import{u as ji}from"./useTicketAccountedTime-CSL2Xls9.js";import{u as Ui}from"./useTicketSubscribe-CmWzZx1x.js";import{g as Dt,a as Ri}from"./formkit-5nol1GBe.js";import{u as Pi}from"./useOrganizationDetail-CenI9U-0.js";import{u as zi}from"./user.api-BwewaCks.js";import{r as Lt}from"./dom-0wVl69Vp.js";import{u as Mi}from"./useAttachments-0IU6Vvzp.js";const Et=Symbol("current-taskbar-tab"),Ni=s=>{const{taskbarTabListByTabEntityKey:t}=it(Ge()),a=y(o=>{if(s)return o&&Me(o,t.value[s])?o:t.value[s]}),e=y(()=>{var o;return(o=a.value)==null?void 0:o.entityAccess}),i=y(()=>{var o;return(o=a.value)==null?void 0:o.taskbarTabId}),n=y(()=>{var o;return((o=a.value)==null?void 0:o.formId)||void 0}),l=y(()=>{var o;return!!((o=a.value)!=null&&o.formNewArticlePresent)});return{currentTaskbarTab:a,currentTaskbarTabEntityAccess:e,currentTaskbarTabId:i,currentTaskbarTabFormId:n,currentTaskbarTabNewArticlePresent:l}},Fi=s=>{gt(Et,s)},co=s=>{const{taskbarTabContexts:t}=it(Ge()),{currentTaskbarTab:a,currentTaskbarTabId:e,currentTaskbarTabFormId:i,currentTaskbarEntityKey:n,currentTaskbarTabNewArticlePresent:l}=Je(Et),{updateTaskbarTab:o,deleteTaskbarTab:r}=Ge();return s&&ee(s,k=>{var f;(f=a.value)!=null&&f.tabEntityKey&&(t.value[a.value.tabEntityKey]=k)},{immediate:!0}),ee(()=>{var k;return a.value&&((k=t.value[a.value.tabEntityKey])==null?void 0:k.formIsDirty)},k=>{var f;k===void 0||!((f=a.value)!=null&&f.taskbarTabId)||a.value.dirty!==k&&o(a.value.taskbarTabId,{...a.value,dirty:k})}),{currentTaskbarTab:a,currentTaskbarEntityKey:n,currentTaskbarTabId:e,currentTaskbarTabFormId:i,currentTaskbarTabNewArticlePresent:l,currentTaskbarTabDelete:()=>{e.value&&r(e.value)}}},uo=U({__name:"LayoutTaskbarTabContent",setup(s){const{path:t,meta:a}=vt(),e=q(a.taskbarTabEntityKey),{currentTaskbarTabEntityAccess:i,currentTaskbarTabId:n,...l}=Ni(e.value);ht(()=>{e.value||(e.value=a.taskbarTabEntityKey)}),ee(n,d=>{!d&&e&&(e.value=void 0)});const o=y(()=>!!(n.value&&e.value));ee(o,(d,k)=>{k&&!d&&bi(t)});const r=y(()=>{if(!e.value)return null;if(i.value!==void 0)switch(i.value){case Fe.Forbidden:return{statusCode:dt.Forbidden,title:__("Forbidden"),message:a.messageForbidden??__("You have insufficient rights to view this object.")};case Fe.NotFound:return{statusCode:dt.NotFound,title:__("Not Found"),message:a.messageNotFound??__("Object with specified ID was not found. Try checking the URL for errors.")};case Fe.Granted:default:return null}});return Fi({currentTaskbarTabId:n,currentTaskbarEntityKey:e.value,...l}),(d,k)=>o.value&&r.value?(u(),g(pi,{key:0,class:"flex grow flex-col items-center justify-center gap-4 bg-blue-50 dark:bg-gray-800"},{default:h(()=>[T(ki,{options:r.value,authenticated:""},null,8,["options"])]),_:1})):o.value&&r.value!==void 0?Pe(d.$slots,"default",{key:1}):E("",!0)}}),mo=s=>{const t=q(!0),a=y(()=>!t.value),{metaTitle:e}=s;let i;const{setViewTitle:n}=Ti();return ht(()=>{t.value=!0,e&&(i=ee(e,l=>{n(l)},{immediate:!0}))}),Kt(()=>{t.value=!1,i==null||i()}),{pageActive:t,pageInactive:a}},Bi=P`
    subscription userCurrentTaskbarItemStateUpdates($taskbarItemId: ID!) {
  userCurrentTaskbarItemStateUpdates(taskbarItemId: $taskbarItemId) {
    stateChanged
  }
}
    `;function xi(s,t={}){return li(Bi,s,t)}const ko=(s,t,a)=>{const e=q(!1),i=q(!1),n=o=>{if(o&&i.value){e.value=!1;return}e.value=o},l=new ci(xi(()=>({taskbarItemId:s.value}),()=>({enabled:!!s.value})));return l.onSubscribed().then(()=>{l.onResult(o=>{var d,k;let r;s.value&&!e.value&&((d=o.data)!=null&&d.userCurrentTaskbarItemStateUpdates.stateChanged)&&(r=(k=t.value)==null?void 0:k.formNode.on("message-removed",({payload:f})=>{var I;!r||f.key!=="formUpdaterProcessing"||(i.value=!1,(I=t.value)==null||I.formNode.off(r))}),i.value=!0,a({includeDirtyFields:!0,additionalParams:{taskbarId:s.value,applyTaskbarState:!0}})),n(!1)})}),{setSkipNextStateUpdate:n}};var N=(s=>(s.TicketCreate="ticket-create",s.TicketDetailView="ticket-detail-view",s))(N||{}),ne=(s=>(s.Info="info",s.Warning="warning",s.Danger="danger",s))(ne||{});const me=()=>({persistentStates:Ht({})}),Qi=P`
    query ticket($ticketId: ID, $ticketInternalId: Int, $ticketNumber: String) {
  ticket(
    ticket: {ticketId: $ticketId, ticketInternalId: $ticketInternalId, ticketNumber: $ticketNumber}
  ) {
    ...ticketAttributes
    createArticleType {
      id
      name
    }
    mentions(first: 20) {
      totalCount
      edges {
        node {
          ...ticketMention
        }
        cursor
      }
    }
    checklist {
      id
      completed
      incomplete
      total
      complete
    }
    referencingChecklistTickets {
      ...referencingTicket
    }
  }
}
    ${$i}
${Si}
${at}`;function qi(s={},t={}){return re(Qi,s,t)}const Vt=Symbol("ticket"),po=s=>{const t=y(()=>Ue("Ticket",s.value)),e=new de(qi(()=>({ticketId:t.value}),{fetchPolicy:"cache-first"})).result();return{ticket:y(()=>{var n;return(n=e.value)==null?void 0:n.ticket}),ticketId:t,ticketInternalId:s}},fo=s=>{gt(Vt,s)},Ve=()=>Je(Vt),Gi={class:"relative"},Ki=U({__name:"TicketSidebarButton",props:{name:{},label:{},icon:{},selected:{type:Boolean},badge:{},updateIndicator:{type:Boolean}},emits:["click"],setup(s){const t=s,a=y(()=>{var n;const i=(n=t.badge)==null?void 0:n.value;if(i)return typeof i!="number"?i:i>99?"99+":i}),e=y(()=>{var i;switch((i=t.badge)==null?void 0:i.type){case ne.Warning:return"bg-yellow-500 text-yellow-100";case ne.Danger:return"bg-red-500 text-pink-100";case ne.Info:default:return"bg-pink-500 text-white"}});return(i,n)=>{const l=R("CommonLabel"),o=$e("tooltip");return u(),w("div",Gi,[ae(T(H,{class:Q({"text-black outline-1 outline-offset-1 outline-blue-800 focus:outline-1 focus:outline-offset-1 focus:outline-blue-800 dark:text-white":i.selected}),size:"large",variant:"neutral",icon:i.icon,"aria-label":i.$t(i.label),onClick:n[0]||(n[0]=r=>i.$emit("click",i.name))},null,8,["class","icon","aria-label"]),[[o,i.$t(i.label)]]),!i.selected&&i.updateIndicator?(u(),g(gi,{key:0})):E("",!0),i.badge?(u(),g(l,{key:1,size:"xs",class:Q(["pointer-events-none absolute -bottom-2 block! max-w-10 min-w-4 truncate rounded-full border-2 border-white px-0.5 py-0.5 text-center font-bold text-white ltr:-right-1.5 rtl:-left-1.5 dark:border-gray-500",[e.value]]),"aria-label":i.$t(i.badge.label),role:"status"},{default:h(()=>[j(O(a.value),1)]),_:1},8,["class","aria-label"])):E("",!0)])}}}),ke=U({__name:"TicketSidebarWrapper",props:{badge:{},updateIndicator:{type:Boolean},sidebar:{},selected:{type:Boolean},sidebarPlugin:{}},emits:["click"],setup(s){return(t,a)=>(u(),w("div",null,[(u(),g(Ki,{key:t.sidebar,name:t.sidebar,label:t.sidebarPlugin.title,icon:t.sidebarPlugin.icon,badge:t.badge,selected:t.selected,"update-indicator":t.updateIndicator,onClick:a[0]||(a[0]=e=>t.$emit("click",e))},null,8,["name","label","icon","badge","selected","update-indicator"])),t.selected?(u(),g(Zt,{key:0,to:"#ticketSidebar"},[Pe(t.$slots,"default")])):E("",!0)]))}}),be=s=>{s instanceof ui&&ze().notify({id:s.userErrorId,message:s.getFirstErrorMessage(),type:_e.Error})},Hi=U({__name:"ChecklistEmptyTemplates",setup(s){const{hasPermission:t}=It(),a=y(()=>t("admin.checklist"));return(e,i)=>{const n=R("CommonLabel"),l=R("CommonLink");return u(),w(F,null,[T(n,{tag:"p"},{default:h(()=>[j(O(e.$t("No checklist templates have been created yet.")),1)]),_:1}),T(n,{tag:"p"},{default:h(()=>[j(O(e.$t("With checklist templates you can pre-fill your checklists.")),1)]),_:1}),a.value?(u(),g(l,{key:0,link:"/#manage/checklists",size:"medium"},{default:h(()=>[j(O(e.$t("Create a new checklist template in the admin interface.")),1)]),_:1})):E("",!0)],64)}}}),Zi={key:0,class:"flex grow items-center gap-2"},ot=U({__name:"CommonTicketLabel",props:{ticket:{},unauthorized:{type:Boolean},classes:{}},setup(s){const t=s,a=y(()=>{var n;return`ticket-${(n=t.ticket)==null?void 0:n.internalId}`}),e=y(()=>{var n,l;return((l=(n=t.ticket)==null?void 0:n.state)==null?void 0:l.name)||""}),i=y(()=>{var n;return((n=t.ticket)==null?void 0:n.stateColorCode)||ai.Open});return(n,l)=>{var k;const o=R("CommonIcon"),r=R("CommonLabel"),d=R("CommonLink");return n.unauthorized?(u(),w("div",Zi,[T(o,{class:"shrink-0 text-red-500",size:"tiny",name:"x-lg"}),T(r,{class:"text-black dark:text-white"},{default:h(()=>[j(O(n.$t("Access denied")),1)]),_:1})])):(u(),g(d,{key:1,class:"flex! grow items-start gap-2 rounded-md break-words group-hover/tab:bg-blue-600 hover:no-underline! focus-visible:rounded-md focus-visible:outline-hidden group-hover/tab:dark:bg-blue-900",style:{"word-break":"break-word"},link:`/tickets/${(k=n.ticket)==null?void 0:k.internalId}`,internal:""},{default:h(()=>{var f,I;return[T(vi,{class:Q(["ms-0.5 mt-1 shrink-0",((f=n.classes)==null?void 0:f.indicator)||""]),"color-code":i.value,label:e.value,"aria-labelledby":a.value,"icon-size":"tiny"},null,8,["class","color-code","label","aria-labelledby"]),T(r,{id:a.value,class:Q(["mt-0.5 text-blue-800",(I=n.classes)==null?void 0:I.label])},{default:h(()=>{var p;return[j(O((p=n.ticket)==null?void 0:p.title),1)]}),_:1},8,["id","class"])]}),_:1},8,["link"]))}}}),Wi=U({__name:"ChecklistItem",props:{item:{},isReordering:{type:Boolean},isUpdating:{type:Boolean},onEditItem:{type:Function}},emits:["remove-item","set-item-checked"],setup(s,{expose:t,emit:a}){const e=s,i=a,n=y(()=>!!e.item.ticketReference),l=y(()=>{var p;return!((p=e.item.ticketReference)!=null&&p.ticket)}),o=ge("inline-edit"),r=()=>{i("remove-item",e.item)},d=p=>{e.item.checked!==p&&i("set-item-checked",{...e.item,checked:p})},k=async p=>e.onEditItem({...e.item,text:p}),f=q(!1),I=[{key:"check",label:__("Check item"),icon:"check2-square",onClick:()=>d(!0),show:p=>!(p!=null&&p.checked)&&!n.value},{key:"uncheck",label:__("Uncheck item"),icon:"check2-square",onClick:()=>d(!1),show:p=>(p==null?void 0:p.checked)&&!n.value},{key:"edit",icon:"pencil",label:__("Edit item"),show:()=>!n.value,onClick:()=>{var p;return(p=o.value)==null?void 0:p.activateEditing()}},{key:"remove",label:__("Remove item"),variant:"danger",icon:"trash3",onClick:()=>r()}];return t({focusInput:()=>{var p;return(p=o.value)==null?void 0:p.activateEditing()},quitEditing:()=>{f.value=!1}}),(p,c)=>{var m,v;const C=R("CommonIcon"),D=R("FormKit");return u(),w("li",{class:Q(["flex min-h-10 gap-2 overflow-x-clip rounded-lg bg-blue-200 p-2 text-stone-200 dark:bg-gray-700 dark:text-neutral-500",{"items-center":f.value}])},[p.isReordering?(u(),w(F,{key:0},[T(C,{name:"grip-vertical",class:"mt-1.5 inline-block shrink-0",size:"xs"}),n.value?E("",!0):(u(),g(C,{key:0,tabindex:"0",class:"mt-1.5 shrink-0 text-gray-100 outline-hidden focus-visible:outline-1 focus-visible:outline-offset-1 focus-visible:outline-blue-800 dark:text-neutral-400",size:"xs",role:"checkbox","aria-readonly":"true","aria-checked":p.item.checked,"aria-labelledby":`checklist-item-${b(Re)(p.item.id)}`,name:p.item.checked?"check-square-fill":"square-fill"},null,8,["aria-checked","aria-labelledby","name"]))],64)):(u(),w(F,{key:1},[n.value?E("",!0):(u(),g(D,{key:0,id:`checked_${p.item.id}`,type:"checkbox",classes:{outer:"flex items-center shrink-0 self-start mt-0.5",inner:"rtl:!ml-0 ltr:!mr-0"},"model-value":p.item.checked,name:`checkbox-checklist-item-${b(Re)(p.item.id)}`,"aria-label":p.item.text,"onUpdate:modelValue":c[0]||(c[0]=_=>d(_))},null,8,["id","model-value","name","aria-label"]))],64)),n.value?(u(),g(ot,{key:2,classes:{indicator:p.isReordering?"-ms-0.5":""},unauthorized:l.value,ticket:(m=p.item.ticketReference)==null?void 0:m.ticket},null,8,["classes","unauthorized","ticket"])):(u(),g(Ze,{key:3,ref:"inline-edit",editing:f.value,"onUpdate:editing":c[1]||(c[1]=_=>f.value=_),"detect-links":"","alternative-background":"",block:"",loading:p.isUpdating,value:p.item.text,placeholder:p.$t("Text or ticket identifier"),class:Q({"pointer-events-none":p.isReordering}),classes:{label:"dark:text-white text-black",input:"dark:text-white text-black"},disabled:p.isReordering,onSubmitEdit:k},null,8,["editing","loading","value","placeholder","class","disabled"])),!((v=b(o))!=null&&v.isEditing)&&!p.isReordering?(u(),g(Tt,{key:4,"button-size":"small",class:"mt-0.5 flex!",placement:"arrowEnd",actions:I,entity:p.item},null,8,["entity"])):E("",!0)],2)}}}),Yi={class:"grid grid-cols-2 gap-x-2"},Xi={key:0,class:"flex gap-2 py-2"},Ji=U({__name:"ChecklistItems",props:{title:{},items:{},readOnly:{type:Boolean},isUpdatingOrder:{type:Boolean},isEditingNewItem:{type:Boolean},isUpdatingChecklistTitle:{type:Boolean},noDefaultTitle:{type:Boolean},updatingItemIds:{},onEditItem:{type:Function},onUpdateTitle:{type:Function}},emits:["add-item","remove-item","set-item-checked","save-order"],setup(s,{expose:t,emit:a}){const e=a,i=s,n=q(!1),l=q([]),o=y({get:()=>n.value?l.value:[...i.items],set:m=>{l.value=m}}),r=ge("checklist"),d=ge("container"),k=ge("title");wi({parent:d,values:l,plugins:[Di()],draggable:m=>(m.setAttribute("draggable",n.value.toString()),n.value),dropZoneClass:"opacity-0"});const f=()=>{var m,v;(v=(m=r.value)==null?void 0:m.at(-1))==null||v.focusInput()},I=()=>{e("add-item")},p=async m=>i.onEditItem(m),c=()=>{n.value=!1,l.value=[]},C=()=>{e("save-order",l.value,c)},D=()=>{n.value=!0,l.value=i.items};return t({focusTitle:()=>{var m;return(m=k.value)==null?void 0:m.activateEditing()},quitItemEditing:m=>{var v,_;return(_=(v=r.value)==null?void 0:v.at(m))==null?void 0:_.quitEditing()},quitReordering:c,focusNewItem:f}),(m,v)=>{const _=R("CommonIcon"),A=R("CommonLabel"),$=$e("tooltip");return u(),w("div",Yi,[T(Ze,{id:"checklistTitle",ref:"title",class:Q([{"pointer-events-none opacity-60":m.isUpdatingChecklistTitle},"col-span-2 mb-3 w-full"]),value:m.title,"initial-edit-value":m.noDefaultTitle?m.title:"",block:"",disabled:m.readOnly,loading:m.isUpdatingChecklistTitle,"aria-disabled":m.isUpdatingChecklistTitle,"label-attrs":{role:"heading","aria-level":"3"},label:m.$t("Edit checklist title"),onSubmitEdit:m.onUpdateTitle},null,8,["class","value","initial-edit-value","disabled","loading","aria-disabled","label","onSubmitEdit"]),o.value.length?(u(),g(Wt,{key:0,ref:"container",tag:"ul",name:"none",class:Q(["col-span-2 mb-2 space-y-2",{"pointer-events-none opacity-60":m.isUpdatingOrder}])},{default:h(()=>[(u(!0),w(F,null,ie(o.value,L=>(u(),w(F,{key:L.id},[m.readOnly?(u(),w("li",Xi,[L.ticketReference?(u(),g(ot,{key:1,unauthorized:!L.ticketReference.ticket,ticket:L.ticketReference.ticket},null,8,["unauthorized","ticket"])):(u(),w(F,{key:0},[T(_,{tabindex:"0",class:"ms-1 me-0.5 mt-1 text-gray-100 outline-hidden focus-visible:outline-1 focus-visible:outline-offset-1 focus-visible:outline-blue-800 dark:text-neutral-400",size:"xs",role:"checkbox","aria-readonly":"true","aria-checked":L.checked,"aria-labelledby":`checklist-item-${b(Re)(L.id)}`,name:L.checked?"check-square-fill":"square-fill"},null,8,["aria-checked","aria-labelledby","name"]),T(Ze,{id:`checklist-item-${b(Re)(L.id)}`,"detect-links":"",classes:{label:"dark:text-white text-black"},disabled:"",value:L.text||"-"},null,8,["id","value"])],64))])):(u(),g(Wi,{key:1,ref_for:!0,ref:"checklist",item:L,class:Q({"cursor-grab active:cursor-grabbing":n.value,"pointer-events-none opacity-60":m.updatingItemIds.has(L.id)}),"is-updating":m.updatingItemIds.has(L.id),"data-test-id":L.id,"aria-disabled":m.updatingItemIds.has(L.id),"is-reordering":n.value,onRemoveItem:v[0]||(v[0]=z=>m.$emit("remove-item",z)),onSetItemChecked:v[1]||(v[1]=z=>m.$emit("set-item-checked",z)),onEditItem:p},null,8,["item","class","is-updating","data-test-id","aria-disabled","is-reordering"]))],64))),128))]),_:1},8,["class"])):(u(),g(A,{key:1,class:"col-span-2 text-neutral-500",size:"small"},{default:h(()=>[j(O(m.$t("No checklist items yet")),1)]),_:1})),o.value.length>1&&!m.readOnly?(u(),g(ut,{key:2,mode:"out-in"},{default:h(()=>[n.value?(u(),g(H,{key:1,"prefix-icon":n.value?"check2":"list",disabled:m.isUpdatingOrder,onClick:c},{default:h(()=>[j(O(m.$t("Cancel")),1)]),_:1},8,["prefix-icon","disabled"])):(u(),g(H,{key:0,"prefix-icon":"list",disabled:m.isEditingNewItem,onClick:D},{default:h(()=>[j(O(m.$t("Reorder")),1)]),_:1},8,["disabled"]))]),_:1})):E("",!0),m.readOnly?E("",!0):(u(),g(ut,{key:3,mode:"out-in"},{default:h(()=>[n.value?(u(),g(H,{key:1,size:"small",variant:"submit",class:"col-end-3 justify-self-end",disabled:m.isUpdatingOrder,onClick:C},{default:h(()=>[j(O(m.$t("Save")),1)]),_:1},8,["disabled"])):ae((u(),g(H,{key:0,size:"medium",disabled:m.isEditingNewItem,class:"col-end-3 justify-self-end ltr:mr-2 rtl:ml-2",icon:"plus-square-fill",onClick:I},null,8,["disabled"])),[[$,m.$t("Create a new checklist item")]])]),_:1}))])}}}),es=U({__name:"ChecklistTemplates",props:{templates:{}},setup(s){const{popover:t,popoverTarget:a,toggle:e}=Ct();return(i,n)=>{const l=R("CommonLabel");return u(),w(F,null,[T(l,{class:"mx-auto text-center",tag:"p"},{default:h(()=>[j(O(i.$t("Or choose a checklist template.")),1)]),_:1}),T($t,{ref_key:"popover",ref:t,owner:b(a),placement:"end",orientation:"autoVertical"},{default:h(()=>[T(Ke,{popover:b(t),items:i.templates},null,8,["popover","items"])]),_:1},8,["owner"]),T(H,{ref_key:"popoverTarget",ref:a,class:"mx-auto",size:"medium","suffix-icon":"chevron-down",variant:"secondary",onClick:n[0]||(n[0]=o=>b(e)(!0))},{default:h(()=>[j(O(i.$t("Add From a Template")),1)]),_:1},512)],64)}}}),ts=P`
    query checklistTemplates($onlyActive: Boolean = false) {
  checklistTemplates(onlyActive: $onlyActive) {
    id
    name
    active
  }
}
    `;function is(s={},t={}){return re(ts,s,t)}const ss=P`
    subscription checklistTemplateUpdates($onlyActive: Boolean = false) {
  checklistTemplateUpdates(onlyActive: $onlyActive) {
    checklistTemplates {
      id
      name
      active
    }
  }
}
    `,ns=s=>{const t=new de(is({onlyActive:!0},{fetchPolicy:"cache-and-network"})),a=t.loading(),e=t.result(),i=y(()=>e.value!==void 0?!1:a.value);t.subscribeToMore({document:ss,variables:{onlyActive:!0},updateQuery:(o,{subscriptionData:r})=>{var d;return(d=r.data)!=null&&d.checklistTemplateUpdates.checklistTemplates?{checklistTemplates:r.data.checklistTemplateUpdates.checklistTemplates}:null}});const n=async o=>{await s({templateId:o.id},{focusLastItem:!1})};return{checklistTemplatesMenuItems:y(()=>{var o,r;return((r=(o=e.value)==null?void 0:o.checklistTemplates)==null?void 0:r.map(d=>({label:d.name,key:d.id,onClick:()=>n(d)})))||null}),isLoadingTemplates:i}},as=P`
    query ticketChecklist($ticketId: ID, $ticketInternalId: Int, $ticketNumber: String) {
  ticketChecklist(
    ticket: {ticketId: $ticketId, ticketInternalId: $ticketInternalId, ticketNumber: $ticketNumber}
  ) {
    id
    name
    completed
    incomplete
    items {
      id
      text
      checked
      ticketReference {
        ticket {
          ...referencingTicket
        }
      }
    }
  }
}
    ${at}`;function os(s={},t={}){return re(as,s,t)}const rs=P`
    subscription ticketChecklistUpdates($ticketId: ID!) {
  ticketChecklistUpdates(ticketId: $ticketId) {
    ticketChecklist {
      id
      name
      completed
      incomplete
      items {
        id
        text
        checked
        ticketReference {
          ticket {
            ...referencingTicket
          }
        }
      }
    }
    removedTicketChecklist
  }
}
    ${at}`,ls=(s,t)=>{const a=new de(os(()=>({ticketId:s.value})));a.subscribeToMore(()=>({document:rs,variables:{ticketId:s.value},updateQuery:(r,{subscriptionData:d})=>{if(!d.data.ticketChecklistUpdates.ticketChecklist&&!d.data.ticketChecklistUpdates.removedTicketChecklist)return null;const{ticketChecklist:k}=d.data.ticketChecklistUpdates;return!k||r.ticketChecklist===null?{ticketChecklist:k}:null}}));const e=a.result(),i=a.loading(),n=y(()=>{var r;return(r=e==null?void 0:e.value)==null?void 0:r.ticketChecklist}),l=y(()=>t.value?n.value!==void 0?!1:i.value:!0),o=y(()=>{var r;return(r=n.value)==null?void 0:r.incomplete});return{checklist:n,incompleteItemCount:o,isLoadingChecklist:l}},cs={class:"flex w-full gap-2 p-3"},us={ref:"scroll-container",class:"flex h-full flex-col gap-3 overflow-y-auto p-3"},pe=U({__name:"TicketSidebarContent",props:se({title:{},icon:{},entity:{},actions:{}},{modelValue:{required:!0,default:0},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=oe(s,"modelValue"),a=ge("scroll-container");return fi(a),Le(()=>{a!=null&&a.value&&(a.value.scrollTop=t.value)}),Yt(()=>{a!=null&&a.value&&(t.value=a.value.scrollTop)}),(e,i)=>{const n=R("CommonLabel");return u(),w(F,null,[G("div",cs,[T(n,{tag:"h2",class:"min-h-7 grow gap-1.5",size:"large","prefix-icon":e.icon,"icon-color":"text-stone-200 dark:text-neutral-500"},{default:h(()=>[j(O(e.$t(e.title)),1)]),_:1},8,["prefix-icon"]),e.actions?(u(),g(Tt,{key:0,class:"text-gray-100 dark:text-neutral-400","no-single-action-mode":"",placement:"arrowEnd",entity:e.entity,actions:e.actions},null,8,["entity","actions"])):E("",!0)]),G("div",us,[Pe(e.$slots,"default")],512)],64)}}}),ds=P`
    mutation ticketChecklistAdd($ticketId: ID!, $templateId: ID) {
  ticketChecklistAdd(ticketId: $ticketId, templateId: $templateId) {
    checklist {
      id
      name
      items {
        id
        text
        checked
      }
    }
    errors {
      ...errors
    }
  }
}
    ${te}`;function ms(s={}){return W(ds,s)}const ks=P`
    mutation ticketChecklistDelete($checklistId: ID!) {
  ticketChecklistDelete(checklistId: $checklistId) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function ps(s={}){return W(ks,s)}const fs=P`
    mutation ticketChecklistItemDelete($checklistId: ID!, $checklistItemId: ID!) {
  ticketChecklistItemDelete(
    checklistId: $checklistId
    checklistItemId: $checklistItemId
  ) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function bs(s={}){return W(fs,s)}const gs=P`
    mutation ticketChecklistItemOrderUpdate($checklistId: ID!, $order: [ID!]!) {
  ticketChecklistItemOrderUpdate(checklistId: $checklistId, order: $order) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function vs(s={}){return W(gs,s)}const hs=P`
    mutation ticketChecklistItemUpsert($checklistId: ID!, $checklistItemId: ID, $input: TicketChecklistItemInput!) {
  ticketChecklistItemUpsert(
    checklistId: $checklistId
    checklistItemId: $checklistItemId
    input: $input
  ) {
    checklistItem {
      id
      text
      checked
      ticketReference {
        ticket {
          id
          internalId
          number
          title
          state {
            id
            name
          }
          stateColorCode
        }
      }
    }
    errors {
      ...errors
    }
  }
}
    ${te}`;function mt(s={}){return W(hs,s)}const ys=P`
    mutation ticketChecklistTitleUpdate($checklistId: ID!, $title: String) {
  ticketChecklistTitleUpdate(checklistId: $checklistId, title: $title) {
    checklist {
      id
      name
    }
    errors {
      ...errors
    }
  }
}
    ${te}`;function Is(s={}){return W(ys,s)}const Ts={class:"flex flex-col gap-3"},_s=U({__name:"TicketSidebarChecklistContent",props:se({context:{},sidebarPlugin:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=oe(s,"modelValue"),a=ge("checklist-items"),{cache:e}=De(),{ticket:i,ticketId:n,isTicketEditable:l}=Ve(),{ticketNumberWithTicketHook:o}=hi(i),{checklist:r,isLoadingChecklist:d}=ls(n,i),k=y(()=>{var S;return((S=r.value)==null?void 0:S.name)||tt.t("%s Checklist",o.value)}),f=new J(ms()),I=async(S,V={focusLastItem:!0})=>{var M;if((M=i.value)!=null&&M.id)return f.send({...S,ticketId:i.value.id}).then(()=>{V.focusLastItem&&et(()=>{var X;return(X=a.value)==null?void 0:X.focusNewItem()})}).catch(be)},p=new J(Is()),c=new J(ps()),C=async()=>{var M;const{waitForVariantConfirmation:S}=He();await S("delete")&&await c.send({checklistId:(M=r.value)==null?void 0:M.id}).catch(be)},D=async S=>{var V;return p.send({title:S,checklistId:(V=r.value)==null?void 0:V.id}).then(()=>{}).catch(be)},m=new J(mt({update:(S,{data:V})=>{var K;if(!V||!r.value)return;const{ticketChecklistItemUpsert:M}=V;!(M!=null&&M.checklistItem)||(K=r.value)!=null&&K.items.find(Z=>{var fe;return Z.id===((fe=M.checklistItem)==null?void 0:fe.id)})||S.modify({id:S.identify(r.value),fields:{items(Z,{toReference:fe}){return[...Z,fe(M.checklistItem)]},complete(Z){return Z+1},total(Z){return Z+1},incomplete(Z){return Z+1}}})}}),{errorNotificationMessage:__("Failed to add new checklist item.")}),v=new J(vs(),{errorNotificationMessage:__("Failed to save checklist order.")}),_=new J(mt(),{errorNotificationMessage:__("Failed to update checklist item.")}),A=new J(bs(),{errorNotificationMessage:__("Failed to delete checklist item.")}),$=v.loading(),L=m.loading(),z=f.loading(),B=p.loading(),x=q(new Set),Y=S=>{x.value.delete(S)},Se=S=>{x.value.add(S)},rt=S=>{const V=r.value,M=V.incomplete,X=V.completed;let K=V.incomplete??0;S?K+=1:K-=1,K<0||!V.items?K=0:K>V.items.length&&(K=V.items.length);const Z=e.identify(V);return e.modify({id:Z,fields:{incomplete(){return K},total(){return V.items.length},completed(){return K===0},complete(){return V.items.length-K}}}),()=>{e.modify({id:Z,fields:{incomplete(){return M},completed(){return X},total(){return V.items.length},complete(){return V.items.length-M}}})}},Mt=S=>{const V=e.identify(S);e.modify({id:V,fields:{checked(){return S.checked}}});const M=rt(!S.checked);return()=>{M(),e.modify({id:V,fields:{checked(){return!S.checked}}})}},lt=S=>{const V=r.value,M=e.identify(V);e.modify({id:M,fields:{items(X,{toReference:K}){return S.map(Z=>K(Z,!0))}}})},ct=async(S,V)=>{var M;return Se(S),_.send({checklistId:(M=r.value)==null?void 0:M.id,checklistItemId:S,input:V}).finally(()=>{Y(S)})},Nt=async S=>{const V=Mt(S);Se(S.id),await ct(S.id,{checked:S.checked}).catch(M=>{V(),be(M)}).finally(()=>{Y(S.id)})},Ft=async()=>{var S;return m.send({checklistId:(S=r.value)==null?void 0:S.id,input:{text:"",checked:!1}}).then(()=>{var V;(V=a.value)==null||V.focusNewItem()}).catch(be)},Bt=async S=>(Se(S.id),ct(S.id,{text:S.text}).then(()=>{}).catch(be).finally(()=>{Y(S.id)})),xt=(S,V)=>{var M;v.send({checklistId:(M=r.value)==null?void 0:M.id,order:S.map(X=>X.id)}).then(()=>{lt(S),V()}).catch(be)},Qt=async S=>{var X,K,Z;if((X=S.text)!=null&&X.length){const{waitForVariantConfirmation:fe}=He();if(!await fe("delete"))return}const V=Ce(((K=r.value)==null?void 0:K.items)||[]);e.evict({id:e.identify(S)}),e.gc();const M=rt(!1);return Se(S.id),A.send({checklistId:(Z=r.value)==null?void 0:Z.id,checklistItemId:S.id}).catch(fe=>(lt(V),M(),be(fe))).finally(()=>{Y(S.id)})},qt=[{key:"rename",label:__("Rename checklist"),icon:"input-cursor-text",onClick:()=>{var S;return(S=a.value)==null?void 0:S.focusTitle()},show:()=>!!r.value},{key:"remove",label:__("Remove checklist"),variant:"danger",icon:"trash3",onClick:()=>C(),show:()=>!!r.value}],{isLoadingTemplates:Gt,checklistTemplatesMenuItems:Ne}=ns(I);return(S,V)=>{const M=R("CommonLabel");return u(),g(pe,{modelValue:t.value.scrollPosition,"onUpdate:modelValue":V[1]||(V[1]=X=>t.value.scrollPosition=X),actions:b(l)?qt:void 0,title:S.sidebarPlugin.title,icon:S.sidebarPlugin.icon},{default:h(()=>[T(Ee,{loading:b(d)},{default:h(()=>{var X;return[G("div",Ts,[b(r)?(u(),g(Ji,{key:0,ref:"checklist-items","no-default-title":!!b(r).name,"updating-item-ids":x.value,title:k.value,items:b(r).items,"read-only":!b(l),"is-updating-order":b($),"is-editing-new-item":b(L),"is-updating-checklist-title":b(B),onAddItem:Ft,onRemoveItem:Qt,onSetItemChecked:Nt,onEditItem:Bt,onSaveOrder:xt,onUpdateTitle:D},null,8,["no-default-title","updating-item-ids","title","items","read-only","is-updating-order","is-editing-new-item","is-updating-checklist-title"])):b(l)?(u(),w(F,{key:1},[T(H,{variant:"primary",size:"medium",block:"",disabled:b(z),onClick:V[0]||(V[0]=K=>I())},{default:h(()=>[j(O(S.$t("Add Empty Checklist")),1)]),_:1},8,["disabled"]),b(Ne)&&((X=b(Ne))==null?void 0:X.length)>0?(u(),g(es,{key:0,templates:b(Ne)},null,8,["templates"])):b(Gt)?E("",!0):(u(),g(Hi,{key:1}))],64)):(u(),g(M,{key:2},{default:h(()=>[j(O(S.$t("No checklist added to this ticket yet.")),1)]),_:1}))])]}),_:1},8,["loading"])]),_:1},8,["modelValue","actions","title","icon"])}}}),Cs=U({__name:"TicketSidebarChecklist",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const{persistentStates:a}=me(),e=t,{ticket:i}=Ve(),n=y(()=>{var o,r;return(r=(o=i.value)==null?void 0:o.checklist)==null?void 0:r.incomplete}),l=y(()=>{const o=__("Incomplete checklist items");if(n.value)return{type:ne.Info,value:n.value,label:o}});return Le(()=>{e("show")}),(o,r)=>(u(),g(ke,{key:o.sidebar,sidebar:o.sidebar,"sidebar-plugin":o.sidebarPlugin,selected:o.selected,badge:l.value},{default:h(()=>[T(_s,{modelValue:b(a),"onUpdate:modelValue":r[0]||(r[0]=d=>he(a)?a.value=d:null),context:o.context,"sidebar-plugin":o.sidebarPlugin},null,8,["modelValue","context","sidebar-plugin"])]),_:1},8,["sidebar","sidebar-plugin","selected","badge"]))}}),$s={title:__("Checklist"),component:Cs,permissions:["ticket.agent"],screens:[N.TicketDetailView],icon:"checklist",order:8e3,available:()=>{const{config:s}=ye();return!!s.checklist}},Ot=U({__name:"CommonShowMoreButton",props:{entities:{},totalCount:{},disabled:{type:Boolean}},setup(s){return(t,a)=>t.entities.length<t.totalCount?(u(),g(H,{key:0,type:"button",disabled:t.disabled},{default:h(()=>[j(O(t.$t("Show %s more",t.totalCount-t.entities.length)),1)]),_:1},8,["disabled"])):E("",!0)}}),Ss=U({__name:"OrganizationEntity",props:{entity:{}},setup(s){return(t,a)=>{const e=R("CommonLabel"),i=R("CommonLink");return u(),g(i,{link:`/organizations/${t.entity.internalId}`,class:"flex gap-2 hover:no-underline!"},{default:h(()=>[T(_t,{entity:t.entity,size:"small"},null,8,["entity"]),T(e,{class:"text-blue-800! hover:underline dark:text-neutral-400!"},{default:h(()=>[j(O(t.entity.name),1)]),_:1})]),_:1},8,["link"])}}});var Oe=(s=>(s.User="User",s.Organization="Organization",s))(Oe||{});const ws={type:Oe.Organization,component:Ss,emptyMessage:__("No organizations found")},Ds=U({__name:"UserEntity",props:{entity:{}},setup(s){return(t,a)=>{const e=R("CommonLabel"),i=R("CommonLink");return u(),g(i,{link:`/user/profile/${t.entity.internalId}`,class:"flex gap-2 hover:no-underline"},{default:h(()=>[T(st,{entity:t.entity,size:"small"},null,8,["entity"]),T(e,{class:"text-blue-800! hover:underline dark:text-neutral-400!"},{default:h(()=>[j(O(`${t.entity.fullname}`),1)]),_:1})]),_:1},8,["link"])}}}),Ls={type:Oe.User,component:Ds,emptyMessage:__("No members found")},Es=Object.assign({"./organization.ts":ws,"./user.ts":Ls}),Vs=Object.entries(Es).reduce((s,[t,a])=>(s[a.type]=a,s),{}),Os={key:0,class:"flex flex-col gap-1.5"},At=U({__name:"CommonSimpleEntityList",props:se({id:{},entity:{},type:{},label:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:se(["load-more"],["update:modelValue"]),setup(s){const t=s,a=oe(s,"modelValue"),e=y(()=>{const{component:i,...n}=Vs[t.type];return{component:i,context:n,array:t.entity.array}});return(i,n)=>{const l=R("CommonLabel");return u(),g(ve,{id:i.id,modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=o=>a.value=o),title:i.label,"no-header":!i.label},{default:h(()=>{var o,r;return[(o=i.entity.array)!=null&&o.length?(u(),w("ul",Os,[(u(!0),w(F,null,ie(e.value.array,d=>(u(),w("li",{key:`entity-${d.id}`},[(u(),g(yt(e.value.component),{entity:d,context:e.value.context},null,8,["entity","context"]))]))),128))])):E("",!0),(r=i.entity.array)!=null&&r.length?E("",!0):(u(),g(l,{key:1,class:"block"},{default:h(()=>[j(O(e.value.context.emptyMessage),1)]),_:1})),i.entity?(u(),g(Ot,{key:2,class:"self-end",entities:i.entity.array,"total-count":i.entity.totalCount,onClick:n[0]||(n[0]=d=>i.$emit("load-more"))},null,8,["entities","total-count"])):E("",!0)]}),_:1},8,["id","modelValue","title","no-header"])}}}),As={class:"flex gap-2"},js={class:"flex flex-col justify-center gap-px"},kt="ticket-change-customer",Us=U({__name:"TicketSidebarCustomerContent",props:se({customer:{},secondaryOrganizations:{},objectAttributes:{},context:{},sidebarPlugin:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:se(["load-more-secondary-organizations"],["update:modelValue"]),setup(s){const t=s,a=oe(s,"modelValue"),{open:e}=ue({name:kt,component:()=>ce(()=>import("./TicketChangeCustomerFlyout-fDcamutV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]))});let i,n,l;t.context.screenType===N.TicketDetailView&&({ticket:i}=Ve(),{isTicketAgent:n,isTicketEditable:l}=wt(i));const o=y(()=>[{key:kt,label:__("Change customer"),icon:"person",show:()=>i&&n.value&&l.value,onClick:()=>e({ticket:i})}]);return(r,d)=>{const k=R("CommonLabel"),f=R("CommonLink");return u(),g(pe,{modelValue:a.value.scrollPosition,"onUpdate:modelValue":d[3]||(d[3]=I=>a.value.scrollPosition=I),title:r.sidebarPlugin.title,icon:r.sidebarPlugin.icon,entity:r.customer,actions:o.value},{default:h(()=>{var I,p;return[G("div",As,[r.customer?(u(),g(st,{key:0,entity:r.customer,size:"normal"},null,8,["entity"])):E("",!0),G("div",js,[T(k,{size:"large",class:"text-gray-300! dark:text-neutral-400!"},{default:h(()=>{var c;return[j(O((c=r.customer)==null?void 0:c.fullname),1)]}),_:1}),(I=r.customer)!=null&&I.organization?(u(),g(f,{key:0,link:`/organizations/${(p=r.customer.organization)==null?void 0:p.internalId}`,class:"text-sm leading-snug"},{default:h(()=>{var c;return[j(O((c=r.customer)==null?void 0:c.organization.name),1)]}),_:1},8,["link"])):E("",!0)])]),T(St,{attributes:r.objectAttributes,object:r.customer,"skip-attributes":["firstname","lastname"]},null,8,["attributes","object"]),r.secondaryOrganizations.totalCount?(u(),g(At,{key:0,id:"customer-secondary-organizations",modelValue:a.value.collapseOrganizations,"onUpdate:modelValue":d[0]||(d[0]=c=>a.value.collapseOrganizations=c),type:b(Oe).Organization,label:r.__("Secondary organizations"),entity:r.secondaryOrganizations,onLoadMore:d[1]||(d[1]=c=>r.$emit("load-more-secondary-organizations"))},null,8,["modelValue","type","label","entity"])):E("",!0),T(ve,{id:"customer-tickets",modelValue:a.value.collapseTickets,"onUpdate:modelValue":d[2]||(d[2]=c=>a.value.collapseTickets=c),title:r.__("Tickets")},{default:h(()=>{var c,C,D,m;return[T(Vi,{class:"mt-1",density:b(Oi).Dense,items:[{label:r.__("open tickets"),icon:"check-circle-no",iconColor:"fill-yellow-500",count:((C=(c=r.customer)==null?void 0:c.ticketsCount)==null?void 0:C.open)||0,route:"/search/ticket/open"},{label:r.__("closed tickets"),icon:"check-circle-outline",iconColor:"fill-green-400",count:((m=(D=r.customer)==null?void 0:D.ticketsCount)==null?void 0:m.closed)||0,route:"/search/ticket/closed"}]},null,8,["density","items"])]}),_:1},8,["modelValue","title"])]}),_:1},8,["modelValue","title","icon","entity","actions"])}}}),Rs=U({__name:"TicketSidebarCustomer",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const a=s,{persistentStates:e}=me(),i=t,n=ye(),l=y(()=>Number(a.context.formValues.customer_id)),{user:o,secondaryOrganizations:r,objectAttributes:d,loadAllSecondaryOrganizations:k}=Ei(l),f=p=>{if(!n.config.ui_sidebar_open_ticket_indicator_colored)return ne.Info;switch(a.context.screenType===N.TicketDetailView&&(p-=1),p){case 0:return ne.Info;case 1:return ne.Warning;case 2:default:return ne.Danger}},I=y(()=>{var D,m;const p=__("Open tickets"),c=(m=(D=o.value)==null?void 0:D.ticketsCount)==null?void 0:m.open;if(!c)return;const C=f(Number(c));return{label:p,value:c,type:C}});return ee(l,p=>{if(!p){i("hide");return}i("show")}),l.value&&i("show"),(p,c)=>(u(),g(ke,{key:p.sidebar,sidebar:p.sidebar,"sidebar-plugin":p.sidebarPlugin,selected:p.selected,badge:I.value},{default:h(()=>[b(o)?(u(),g(Us,{key:0,modelValue:b(e),"onUpdate:modelValue":c[0]||(c[0]=C=>he(e)?e.value=C:null),context:p.context,"sidebar-plugin":p.sidebarPlugin,customer:b(o),"secondary-organizations":b(r),"object-attributes":b(d),onLoadMoreSecondaryOrganizations:b(k)},null,8,["modelValue","context","sidebar-plugin","customer","secondary-organizations","object-attributes","onLoadMoreSecondaryOrganizations"])):E("",!0)]),_:1},8,["sidebar","sidebar-plugin","selected","badge"]))}}),Ps={title:__("Customer"),component:Rs,permissions:["ticket.agent"],screens:[N.TicketDetailView,N.TicketCreate],icon:"person",order:1e3,available:s=>!!(s.formValues.customer_id&&typeof s.formValues.customer_id=="number")},zs={class:"flex flex-col gap-0.5"},Ms={key:0,role:"list",class:"flex flex-wrap gap-0.5"},Ie=U({__name:"ExternalReferenceContent",props:{label:{},values:{}},setup(s){return(t,a)=>{const e=R("CommonLabel");return u(),w("div",zs,[T(e,{size:"small",class:"block text-stone-200 dark:text-neutral-500"},{default:h(()=>[j(O(t.label),1)]),_:1}),Pe(t.$slots,"default",{},()=>[t.values?(u(),w("div",Ms,[(u(!0),w(F,null,ie(t.values,(i,n)=>(u(),g(e,{key:i,role:"listitem",class:"text-gray-100 dark:text-neutral-400"},{default:h(()=>[j(O(`${i}${n<t.values.length-1?",":""}`),1)]),_:2},1024))),128))])):E("",!0)])])}}}),Ns={class:"flex gap-2"},jt=U({__name:"ExternalReferenceLink",props:{id:{},showId:{type:Boolean},title:{},link:{},isEditable:{type:Boolean},tooltip:{}},emits:["remove"],setup(s){const t=s,a=y(()=>t.showId?`#${t.id} ${t.title}`:t.title),{isTouchDevice:e}=nt();return(i,n)=>{const l=R("CommonLink"),o=$e("tooltip");return u(),w("div",Ns,[T(l,{class:"grow",size:"medium",external:"","open-in-new-tab":"",link:i.link},{default:h(()=>[j(O(a.value),1)]),_:1},8,["link"]),i.isEditable?ae((u(),g(H,{key:0,icon:"x-lg",size:"small",variant:"remove",class:Q({"opacity-0 group-hover:opacity-100 focus-visible:opacity-100":!b(e)}),onClick:n[0]||(n[0]=r=>i.$emit("remove",{id:i.id}))},null,8,["class"])),[[o,i.tooltip]]):E("",!0)])}}}),Fs=["aria-label"],Bs=U({__name:"IssueTrackerBadgeList",props:{badges:{}},setup(s){return(t,a)=>{const e=R("CommonBadge");return u(),w("div",{"aria-label":t.$t("List of issue labels"),class:"flex flex-wrap gap-1",role:"list"},[(u(!0),w(F,null,ie(t.badges,i=>(u(),g(e,{key:i.title,style:Xt({backgroundColor:i.color,color:i.textColor}),role:"listitem",class:"!rounded-full border-neutral-100 ltr:border rtl:border dark:border-gray-900"},{default:h(()=>[j(O(i.title),1)]),_:2},1032,["style"]))),128))],8,Fs)}}}),xs={class:"group flex gap-2"},Qs={class:"grow space-y-2.5"},qs=U({__name:"IssueTrackerItem",props:{issue:{},isEditable:{type:Boolean}},emits:["unlink"],setup(s){const t=s,a=y(()=>t.issue.state===Be.Open?"text-yellow-500":"text-green-400"),e=y(()=>{switch(t.issue.state){case Be.Closed:return"check-circle-outline";case Be.Open:default:return"check-circle-no"}});return(i,n)=>{var o,r;const l=R("CommonIcon");return u(),w("div",xs,[T(l,{role:"status",class:Q(["flex-shrink-0",a.value]),label:i.__("Issue status"),"aria-roledescription":i.$t("issue status: %s",i.$t(i.issue.state)),name:e.value,size:"small"},null,8,["class","label","aria-roledescription","name"]),G("div",Qs,[T(jt,{id:i.issue.issueId,"is-editable":i.isEditable,link:i.issue.url,"show-id":"",title:i.issue.title,tooltip:i.$t("Unlink issue"),onRemove:n[0]||(n[0]=d=>i.$emit("unlink",i.issue))},null,8,["id","is-editable","link","title","tooltip"]),i.issue.milestone?(u(),g(Ie,{key:0,label:i.$t("Milestone"),values:[i.issue.milestone]},null,8,["label","values"])):E("",!0),(o=i.issue.assignees)!=null&&o.length?(u(),g(Ie,{key:1,label:i.issue.assignees.length>1?i.$t("Assignees"):i.$t("Assignee"),values:i.issue.assignees},null,8,["label","values"])):E("",!0),(r=i.issue.labels)!=null&&r.length?(u(),g(Ie,{key:2,label:i.$t("Labels")},{default:h(()=>[T(Bs,{badges:i.issue.labels},null,8,["badges"])]),_:1},8,["label"])):E("",!0)])])}}}),We=P`
    query ticketExternalReferencesIssueTrackerItemList($issueTrackerType: EnumTicketExternalReferencesIssueTrackerType!, $ticketId: ID, $issueTrackerLinks: [UriHttpString!]) {
  ticketExternalReferencesIssueTrackerItemList(
    issueTrackerType: $issueTrackerType
    input: {issueTrackerLinks: $issueTrackerLinks, ticketId: $ticketId}
  ) {
    assignees
    issueId
    labels {
      color
      textColor
      title
    }
    milestone
    state
    title
    url
  }
}
    `;function Gs(s,t={}){return re(We,s,t)}const Ks=(s,t,a,e)=>{const i=q(!1),n=new de(Gs(()=>({ticketId:e,issueTrackerType:t,issueTrackerLinks:e?void 0:a.value}),()=>({enabled:s===N.TicketCreate?a.value.length>0:!!e,fetchPolicy:s===N.TicketCreate?"cache-first":"cache-and-network"})),{errorShowNotification:!1}),l=n.loading(),o=n.result(),r=n.operationError(),d={[Te.Github]:__("GitHub"),[Te.Gitlab]:__("GitLab")},k=y(()=>r.value?tt.t("Error fetching information from %s. Please contact your administrator.",d[t]):null),f=y(()=>{var c;return(c=o.value)==null?void 0:c.ticketExternalReferencesIssueTrackerItemList}),I=y(()=>f.value!==void 0?!1:l.value),p=y(()=>{var c;return(c=f.value)==null?void 0:c.map(C=>C.url)});return e&&ee(a,c=>{if(Me(c,p.value)||i.value){i.value=!1;return}n.refetch()}),{isLoadingIssues:I,issueList:f,skipNextLinkUpdate:i,error:k}},Hs=P`
    mutation ticketExternalReferencesIssueTrackerItemAdd($issueTrackerLink: UriHttpString!, $issueTrackerType: EnumTicketExternalReferencesIssueTrackerType!, $ticketId: ID) {
  ticketExternalReferencesIssueTrackerItemAdd(
    issueTrackerLink: $issueTrackerLink
    issueTrackerType: $issueTrackerType
    ticketId: $ticketId
  ) {
    issueTrackerItem {
      assignees
      issueId
      labels {
        color
        textColor
        title
      }
      milestone
      state
      title
      url
    }
    errors {
      ...errors
    }
  }
}
    ${te}`;function Zs(s={}){return W(Hs,s)}const Ws=P`
    mutation ticketExternalReferencesIssueTrackerItemRemove($issueTrackerLink: UriHttpString!, $issueTrackerType: EnumTicketExternalReferencesIssueTrackerType!, $ticketId: ID!) {
  ticketExternalReferencesIssueTrackerItemRemove(
    issueTrackerLink: $issueTrackerLink
    issueTrackerType: $issueTrackerType
    ticketId: $ticketId
  ) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function Ys(s={}){return W(Ws,s)}const Xs={class:"space-y-6"},Js={key:1,role:"list",class:"space-y-5"},Ut=U({__name:"IssueTrackerList",props:{screenType:{},isTicketEditable:{type:Boolean},trackerType:{},flyoutConfig:{},issueLinks:{},form:{},ticketId:{}},emits:["error"],setup(s,{expose:t,emit:a}){const e=s,i=a,{isLoadingIssues:n,issueList:l,skipNextLinkUpdate:o,error:r}=Ks(e.screenType,e.trackerType,le(e,"issueLinks"),e.ticketId);ee(r,()=>{i("error",r.value)});const d=new J(Ys(),{errorShowNotification:!1}),k=m=>{const{cache:v}=De(),_={query:We,variables:{issueTrackerType:e.trackerType,ticketId:e.ticketId,issueTrackerLinks:e.ticketId?void 0:e.issueLinks}},A=v.readQuery(_);if(!A)return;const $=Ce(A);return v.writeQuery({..._,data:{ticketExternalReferencesIssueTrackerItemList:A.ticketExternalReferencesIssueTrackerItemList.filter(L=>L.issueId!==m.issueId)}}),()=>{v.writeQuery({..._,data:$})}},f=async m=>{var _,A;const v=k(m);if(e.screenType===N.TicketCreate){const $=(_=e.form)==null?void 0:_.findNodeByName("externalReferences"),{values:L}=e.form;return!$||!$.value||!L.externalReferences||!L.externalReferences[e.trackerType]||$==null?void 0:$.input({...L.externalReferences,[e.trackerType]:(A=L==null?void 0:L.externalReferences[e.trackerType])==null?void 0:A.filter(z=>z!==m.url)},!1)}return d.send({issueTrackerLink:m.url,issueTrackerType:e.trackerType,ticketId:e.ticketId}).catch(()=>v)},I=new J(Zs({update:(m,{data:v})=>{var z;if(!v)return;const{ticketExternalReferencesIssueTrackerItemAdd:_}=v;if(!(_!=null&&_.issueTrackerItem))return;const A={query:We,variables:{issueTrackerType:e.trackerType,ticketId:e.ticketId,issueTrackerLinks:e.ticketId?void 0:e.issueLinks}};let $=m.readQuery(A);(z=$==null?void 0:$.ticketExternalReferencesIssueTrackerItemList)!=null&&z.find(B=>{var x;return B.issueId===((x=_==null?void 0:_.issueTrackerItem)==null?void 0:x.issueId)})||($={...$,ticketExternalReferencesIssueTrackerItemList:[...($==null?void 0:$.ticketExternalReferencesIssueTrackerItemList)||[],_==null?void 0:_.issueTrackerItem]},e.ticketId||(A.variables.issueTrackerLinks=[...e.issueLinks||[],_.issueTrackerItem.url]),m.writeQuery({...A,data:{...$}}))}}),{errorShowNotification:!1}),p=async m=>(o.value=!0,I.send({issueTrackerLink:m,issueTrackerType:e.trackerType,ticketId:e.ticketId}).then(v=>{var _,A,$;if(e.screenType===N.TicketCreate){const L=(A=(_=v==null?void 0:v.ticketExternalReferencesIssueTrackerItemAdd)==null?void 0:_.issueTrackerItem)==null?void 0:A.url;if(!L)return;const z=($=e.form)==null?void 0:$.findNodeByName("externalReferences");if(!z)return;let B=Ce(z.value);B||(B={}),B[e.trackerType]=[...B[e.trackerType]||[],L],z==null||z.input(B,!1)}}).finally(()=>{o.value=!1})),c=ue({component:()=>ce(()=>import("./IssueTrackerLinkFlyout-C7Kc7G8o.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,18,19,20,21,22,23,24,25,26,16,27,28,29,30,31,32,33])),name:e.flyoutConfig.name}),C=()=>{c.open({...e.flyoutConfig,issueLinks:e.issueLinks,onSubmit:m=>p(m)})},D=y(()=>{var m,v;return e.ticketId?l.value!==void 0&&l.value.length===0&&e.isTicketEditable:((m=e.form)==null?void 0:m.formInitialSettled)&&!((v=e.issueLinks)!=null&&v.length)});return t({openFlyout:C}),(m,v)=>(u(),g(Ee,{loading:b(n),error:b(r)},{default:h(()=>[G("div",Xs,[D.value?(u(),g(H,{key:0,size:"medium",variant:"primary",class:"block ltr:w-full rtl:w-full",onClick:C},{default:h(()=>[j(O(m.$t("Link Issue")),1)]),_:1})):(u(),w("div",Js,[(u(!0),w(F,null,ie(b(l),_=>(u(),g(qs,{key:_.issueId,role:"listitem","is-editable":m.isTicketEditable,issue:_,onUnlink:f},null,8,["is-editable","issue"]))),128))]))])]),_:1},8,["loading","error"]))}}),Rt=(s,t)=>{const a=y(()=>{var l;return((l=t.value.isTicketEditable)==null?void 0:l.value)??!0}),e=y(()=>{var l,o,r,d;return t.value.screenType===N.TicketCreate?((l=t.value.formValues.externalReferences)==null?void 0:l[s])||[]:((d=(r=(o=t.value.ticket)==null?void 0:o.value)==null?void 0:r.externalReferences)==null?void 0:d[s])||[]}),i=y(()=>{var l;return!((l=e.value)!=null&&l.length)&&!a.value}),n=y(()=>{var l,o;return(l=e.value)!=null&&l.length?{label:__("Issues"),type:ne.Info,value:(o=e.value)==null?void 0:o.length}:void 0});return{hideSidebar:i,isTicketEditable:a,issueLinks:e,openIssuesBadge:n}},en=U({__name:"TicketSidebarGitHub",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const a=s,{persistentStates:e}=me(),i=t,{hideSidebar:n,issueLinks:l,isTicketEditable:o,openIssuesBadge:r}=Rt(Te.Github,le(a,"context")),d=ge("issue-tracker-list"),k=q(null),f=c=>{k.value=c},I={name:"link-github-issue",icon:a.sidebarPlugin.icon,label:__("GitHub: Link issue"),inputPlaceholder:"https://github.com/organization/repository/issues/42"};a.context.screenType===N.TicketDetailView?ee(n,c=>{i(c?"hide":"show")},{immediate:!0}):Le(()=>{i("show")});const p=y(()=>{var c;return(c=l.value)!=null&&c.length&&!k.value?[{key:"link-github-issue",label:__("Link Issue"),show:()=>o.value,onClick:()=>{var C;return(C=d.value)==null?void 0:C.openFlyout()},icon:"link-45deg"}]:[]});return(c,C)=>(u(),g(ke,{key:c.sidebar,sidebar:c.sidebar,"sidebar-plugin":c.sidebarPlugin,selected:c.selected,badge:b(r)},{default:h(()=>[T(pe,{modelValue:b(e).scrollPosition,"onUpdate:modelValue":C[0]||(C[0]=D=>b(e).scrollPosition=D),title:c.sidebarPlugin.title,icon:c.sidebarPlugin.icon,actions:p.value},{default:h(()=>{var D,m;return[T(Ut,{ref:"issue-tracker-list","screen-type":c.context.screenType,"is-ticket-editable":b(o),form:c.context.form,"ticket-id":(m=(D=c.context.ticket)==null?void 0:D.value)==null?void 0:m.id,"issue-links":b(l),"tracker-type":b(Te).Github,"flyout-config":I,onError:f},null,8,["screen-type","is-ticket-editable","form","ticket-id","issue-links","tracker-type"])]}),_:1},8,["modelValue","title","icon","actions"])]),_:1},8,["sidebar","sidebar-plugin","selected","badge"]))}}),tn={title:__("GitHub"),component:en,permissions:["ticket.agent"],screens:[N.TicketDetailView,N.TicketCreate],icon:"github",order:4e3,available:()=>ye().config.github_integration},sn=U({__name:"TicketSidebarGitLab",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const a=s,{persistentStates:e}=me(),i=t,{hideSidebar:n,issueLinks:l,isTicketEditable:o,openIssuesBadge:r}=Rt(Te.Gitlab,le(a,"context")),d=ge("issue-tracker-list"),k=q(null),f=c=>{k.value=c},I={name:"link-gitlab-issue",icon:a.sidebarPlugin.icon,label:__("GitLab: Link issue"),inputPlaceholder:"https://git.example.com/group1/project1/-/issues/1"};a.context.screenType===N.TicketDetailView?ee(n,c=>{i(c?"hide":"show")},{immediate:!0}):Le(()=>{i("show")});const p=y(()=>{var c;return(c=l.value)!=null&&c.length&&!k.value?[{key:"link-gilab-issue",label:__("Link Issue"),show:()=>o.value,onClick:()=>{var C;return(C=d.value)==null?void 0:C.openFlyout()},icon:"link-45deg"}]:[]});return(c,C)=>(u(),g(ke,{key:c.sidebar,sidebar:c.sidebar,"sidebar-plugin":c.sidebarPlugin,selected:c.selected,badge:b(r)},{default:h(()=>[T(pe,{modelValue:b(e).scrollPosition,"onUpdate:modelValue":C[0]||(C[0]=D=>b(e).scrollPosition=D),title:c.sidebarPlugin.title,icon:c.sidebarPlugin.icon,actions:p.value},{default:h(()=>{var D,m;return[T(Ut,{ref:"issue-tracker-list","screen-type":c.context.screenType,"is-ticket-editable":b(o),form:c.context.form,"ticket-id":(m=(D=c.context.ticket)==null?void 0:D.value)==null?void 0:m.id,"issue-links":b(l),"tracker-type":b(Te).Gitlab,"flyout-config":I,onError:f},null,8,["screen-type","is-ticket-editable","form","ticket-id","issue-links","tracker-type"])]}),_:1},8,["modelValue","title","icon","actions"])]),_:1},8,["sidebar","sidebar-plugin","selected","badge"]))}}),nn={title:__("GitLab"),component:sn,permissions:["ticket.agent"],screens:[N.TicketDetailView,N.TicketCreate],icon:"gitlab",order:5e3,available:()=>ye().config.gitlab_integration},Pt=P`
    fragment IdoitObjectAttributes on TicketExternalReferencesIdoitObject {
  idoitObjectId
  link
  title
  type
  status
}
    `,Ye=P`
    query ticketExternalReferencesIdoitObjectList($ticketId: ID, $idoitObjectIds: [Int!]) {
  ticketExternalReferencesIdoitObjectList(
    input: {ticketId: $ticketId, idoitObjectIds: $idoitObjectIds}
  ) {
    ...IdoitObjectAttributes
  }
}
    ${Pt}`;function an(s={},t={}){return re(Ye,s,t)}const on=(s,t)=>{const{cache:a}=De();return{removeObjectListCacheUpdate:n=>{const l={query:Ye,variables:{ticketId:t.value,idoitObjectIds:t.value?void 0:s.value}},o=a.readQuery(l);if(!o)return;const r=Ce(o);return t.value||(l.variables.idoitObjectIds=s.value.filter(d=>d!==n)),a.writeQuery({...l,data:{ticketExternalReferencesIdoitObjectList:o.ticketExternalReferencesIdoitObjectList.filter(d=>d.idoitObjectId!==n)}}),()=>a.writeQuery({...l,data:r})},modifyObjectItemAddCache:(n,{data:l})=>{var f,I;if(!l)return;const{ticketExternalReferencesIdoitObjectAdd:o}=l;if(!((f=o==null?void 0:o.idoitObjects)!=null&&f.length))return;const r={query:Ye,variables:{ticketId:t.value,idoitObjectIds:t.value?void 0:s.value}};let d=n.readQuery(r);(I=d==null?void 0:d.ticketExternalReferencesIdoitObjectList)!=null&&I.find(p=>{var c;return(c=o==null?void 0:o.idoitObjects)==null?void 0:c.some(C=>C.idoitObjectId===p.idoitObjectId)})||(d={...d,ticketExternalReferencesIdoitObjectList:[...(d==null?void 0:d.ticketExternalReferencesIdoitObjectList)||[],...o.idoitObjects]},t.value||(r.variables.idoitObjectIds=[...s.value||[],...o.idoitObjects.map(p=>p.idoitObjectId)]),n.writeQuery({...r,data:{...d}}))}}},rn=s=>({addObjectIdsToForm:e=>{var o;if(!e)return;const i=e.map(r=>r.idoitObjectId),n=(o=s.value)==null?void 0:o.findNodeByName("externalReferences");if(!n)return;let l=Ce(n.value);l||(l={}),l.idoit=[...l.idoit||[],...i],n==null||n.input(l,!1)},removeObjectFromForm:async e=>{var o,r;const i=(o=s.value)==null?void 0:o.findNodeByName("externalReferences"),{values:n}=s.value;if(!(i!=null&&i.value)||!((r=n.externalReferences)!=null&&r.idoit))return;let l=Ce(i.value);return l||(l={}),l.idoit=l.idoit.filter(d=>d!==e),i==null?void 0:i.input(l,!1)}}),ln=P`
    mutation ticketExternalReferencesIdoitObjectAdd($idoitObjectIds: [Int!]!, $ticketId: ID) {
  ticketExternalReferencesIdoitObjectAdd(
    idoitObjectIds: $idoitObjectIds
    ticketId: $ticketId
  ) {
    idoitObjects {
      ...IdoitObjectAttributes
    }
    errors {
      ...errors
    }
  }
}
    ${Pt}
${te}`;function cn(s={}){return W(ln,s)}const un=P`
    mutation ticketExternalReferencesIdoitObjectRemove($ticketId: ID!, $idoitObjectId: Int!) {
  ticketExternalReferencesIdoitObjectRemove(
    ticketId: $ticketId
    idoitObjectId: $idoitObjectId
  ) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function dn(s={}){return W(un,s)}const mn={class:"space-y-6",tabindex:"-1"},kn=U({__name:"TicketSidebarIdoitContent",props:se({sidebarPlugin:{},objectIds:{},screenType:{},isTicketEditable:{type:Boolean},ticketId:{},form:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=s,a=oe(s,"modelValue"),e=q(!1),{open:i}=ue({name:"idoit",component:()=>ce(()=>import("./IdoitFlyout-DyMAwuk1.js"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,9,10,11,12,13,14,36,18,19,20,21,22,23,24,25,26,16,27,28,29,30,31,32,33,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56]))}),n=new de(an(()=>({ticketId:t.ticketId,idoitObjectIds:t.ticketId?void 0:t.objectIds}),()=>{var $;return{enabled:t.screenType===N.TicketCreate?(($=t.objectIds)==null?void 0:$.length)>0:!!t.ticketId,fetchPolicy:t.screenType===N.TicketCreate?"cache-first":"cache-and-network"}}),{errorShowNotification:!1}),l=n.result(),o=n.loading(),r=n.operationError(),d=y(()=>r.value?__("Error fetching information from i-doit. Please contact your administrator."):null),k=y(()=>{var $;return(($=l.value)==null?void 0:$.ticketExternalReferencesIdoitObjectList)||[]}),{removeObjectListCacheUpdate:f,modifyObjectItemAddCache:I}=on(le(t,"objectIds"),le(t,"ticketId")),{addObjectIdsToForm:p,removeObjectFromForm:c}=rn(le(t,"form")),C=new J(dn()),D=async({id:$})=>{const L=f($);return t.screenType===N.TicketCreate?c($):C.send({idoitObjectId:$,ticketId:t.ticketId}).catch(()=>L)},m=new J(cn({update:I})),v=async $=>(e.value=!0,m.send({idoitObjectIds:$.objectIds,ticketId:t.ticketId}).then(L=>{var z;t.screenType===N.TicketCreate&&p((z=L==null?void 0:L.ticketExternalReferencesIdoitObjectAdd)==null?void 0:z.idoitObjects)}).finally(()=>{e.value=!1})),_=()=>i({objectIds:t.objectIds,ticketId:t.ticketId,onSubmit:v,icon:t.sidebarPlugin.icon}),A=y(()=>{var $;return($=t.objectIds)!=null&&$.length&&!d.value?[{key:"link-idoit-object",label:__("Link objects"),show:()=>t.isTicketEditable,onClick:_,icon:"link-45deg"}]:[]});return t.ticketId&&ee(()=>t.objectIds,$=>{if(Me($,k.value.map(L=>L.idoitObjectId))||e.value){e.value=!1;return}n.refetch()}),($,L)=>(u(),g(pe,{modelValue:a.value.scrollPosition,"onUpdate:modelValue":L[0]||(L[0]=z=>a.value.scrollPosition=z),title:$.sidebarPlugin.title,icon:$.sidebarPlugin.icon,actions:A.value},{default:h(()=>{var z,B;return[(z=$.objectIds)!=null&&z.length?E("",!0):(u(),g(H,{key:0,size:"medium",variant:"primary",class:"block ltr:w-full rtl:w-full",onClick:_},{default:h(()=>[j(O($.$t("Link Objects")),1)]),_:1})),(B=$.objectIds)!=null&&B.length?(u(),g(Ee,{key:1,loading:b(o),error:d.value},{default:h(()=>[G("div",mn,[(u(!0),w(F,null,ie(k.value,x=>(u(),w("div",{key:x.idoitObjectId,class:"group space-y-2",role:"group"},[T(jt,{id:x.idoitObjectId,title:x.title,link:x.link,"is-editable":$.isTicketEditable,tooltip:$.$t("Unlink object"),onRemove:D},null,8,["id","title","link","is-editable","tooltip"]),T(Ie,{label:$.$t("ID"),values:[x.idoitObjectId.toString()]},null,8,["label","values"]),T(Ie,{label:$.$t("Status"),values:[x.status]},null,8,["label","values"]),T(Ie,{label:$.$t("Type"),values:[x.type]},null,8,["label","values"])]))),128))])]),_:1},8,["loading","error"])):E("",!0)]}),_:1},8,["modelValue","title","icon","actions"]))}}),pn=U({__name:"TicketSidebarIdoit",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const a=s,{persistentStates:e}=me(),i=t,n=y(()=>{var f;return((f=a.context.isTicketEditable)==null?void 0:f.value)??!0}),{isDarkMode:l}=it(Li()),o=y(()=>{const f=l.value?`${a.sidebarPlugin.icon}-light`:`${a.sidebarPlugin.icon}-dark`;return{...a.sidebarPlugin,icon:f}}),r=y(()=>{var f,I,p,c,C;return a.context.screenType===N.TicketCreate?((f=a.context.formValues.externalReferences)==null?void 0:f.idoit)||[]:((C=(c=(p=(I=a.context.ticket)==null?void 0:I.value)==null?void 0:p.preferences)==null?void 0:c.idoit)==null?void 0:C.object_ids)||[]}),d=y(()=>{var f,I;return(f=r.value)!=null&&f.length?{label:__("Objects"),type:ne.Info,value:(I=r.value)==null?void 0:I.length}:void 0}),k=y(()=>{var f;return!((f=r.value)!=null&&f.length)&&!n.value});return a.context.screenType===N.TicketDetailView?ee(k,f=>{i(f?"hide":"show")},{immediate:!0}):Le(()=>{i("show")}),(f,I)=>(u(),g(ke,{key:f.sidebar,sidebar:f.sidebar,"sidebar-plugin":o.value,selected:f.selected,badge:d.value},{default:h(()=>{var p,c;return[T(kn,{modelValue:b(e),"onUpdate:modelValue":I[0]||(I[0]=C=>he(e)?e.value=C:null),"screen-type":f.context.screenType,"ticket-id":(c=(p=f.context.ticket)==null?void 0:p.value)==null?void 0:c.id,"sidebar-plugin":o.value,"object-ids":r.value,form:f.context.form,"is-ticket-editable":n.value},null,8,["modelValue","screen-type","ticket-id","sidebar-plugin","object-ids","form","is-ticket-editable"])]}),_:1},8,["sidebar","sidebar-plugin","selected","badge"]))}}),fn={title:__("i-doit"),component:pn,permissions:["ticket.agent"],screens:[N.TicketDetailView,N.TicketCreate],icon:"i-doit-logo",order:6e3,available:()=>ye().config.idoit_integration},bn={key:0},gn={class:"space-y-2"},Qe=4,vn=U({__name:"TicketAccountedTime",props:{ticket:{}},setup(s){const{timeAccountingDisplayUnit:t,timeAccountingConfig:a}=ji(),e=y(()=>{var k;return(k=s.ticket)==null?void 0:k.timeUnit}),i=q(!1),n=y(()=>{const k=[{name:__("Total"),timeUnit:e.value}];return a.value.time_accounting_types&&k.push(...s.ticket.timeUnitsPerType||[]),k}),l=y(()=>i.value?n.value:n.value.slice(0,Qe)),o=y(()=>n.value.length>Qe&&l.value!==n.value),r=y(()=>n.value.length-Qe),d=y(()=>l.value.length>1);return(k,f)=>{const I=R("CommonLabel");return e.value?(u(),w("div",bn,[G("ul",gn,[(u(!0),w(F,null,ie(l.value,({name:p,timeUnit:c},C)=>(u(),w("li",{key:p,class:Q(["flex gap-2 first:font-semibold",{"border-stone-200 first:border-b first:border-solid first:pb-1 dark:border-neutral-500":d.value}])},[T(I,{id:`accounted-time-${p}`,size:"small",class:Q(["text-black! dark:text-white!",{uppercase:C===0}])},{default:h(()=>[j(O(k.$t(p)),1)]),_:2},1032,["id","class"]),T(I,{size:"small","aria-labelledby":`accounted-time-label-${p}`,"aria-describedby":`accounted-time-unit-${p}`,class:"text-black! ltr:ml-auto rtl:mr-auto dark:text-white!"},{default:h(()=>[j(O(c==null?void 0:c.toFixed(2)),1)]),_:2},1032,["aria-labelledby","aria-describedby"]),T(I,{id:`accounted-time-unit-${p}`,size:"small",class:"text-stone-200! dark:text-neutral-500!","aria-description":k.$t("Accounted time unit")},{default:h(()=>[j(O(b(t)),1)]),_:2},1032,["id","aria-description"])],2))),128))]),o.value?(u(),g(H,{key:0,class:"mt-1 hover:outline-transparent! ltr:float-right ltr:-mr-2 ltr:-ml-2 rtl:float-left rtl:-mr-2 rtl:-ml-2",variant:"secondary",onClick:f[0]||(f[0]=p=>i.value=!0)},{default:h(()=>[j(O(k.$t("Show %s more",r.value))+"…",1)]),_:1})):E("",!0)])):E("",!0)}}}),Xe=P`
    query linkList($objectId: ID!, $targetType: String!) {
  linkList(objectId: $objectId, targetType: $targetType) {
    type
    item {
      ... on Ticket {
        id
        internalId
        title
        state {
          id
          name
        }
        stateColorCode
      }
      ... on KnowledgeBaseAnswerTranslation {
        id
      }
    }
  }
}
    `;function hn(s,t={}){return re(Xe,s,t)}const yn=P`
    subscription linkUpdates($objectId: ID!, $targetType: String!) {
  linkUpdates(objectId: $objectId, targetType: $targetType) {
    links {
      item {
        ... on Ticket {
          id
          internalId
          title
          state {
            id
            name
          }
          stateColorCode
        }
        ... on KnowledgeBaseAnswerTranslation {
          id
        }
      }
      type
    }
  }
}
    `,In=()=>({linkTypes:Object.keys(xe).map(t=>({value:xe[t],label:t})).sort(t=>t.value===xe.Normal?-1:1)}),Tn=(s,t)=>{const{linkTypes:a}=In(),e=y(()=>{var k;return(k=s.value)==null?void 0:k.id}),i=new de(hn(()=>({objectId:e.value,targetType:t}))),n=i.result(),l=i.loading();i.subscribeToMore(()=>({document:yn,variables:{objectId:e.value,targetType:t},updateQuery:(k,{subscriptionData:f})=>{var I;return(I=f.data)!=null&&I.linkUpdates.links?{linkList:f.data.linkUpdates.links}:null}}));const o=y(()=>{var k,f;return(k=n.value)!=null&&k.linkList?(f=n.value)==null?void 0:f.linkList:[]}),r=y(()=>a.map(k=>({...k,id:di(),links:o.value.filter(f=>f.type===k.value)})).filter(k=>k.links.length>0)),d=y(()=>r.value.some(k=>k.links.length>0));return{linkListIsLoading:l,linkTypesWithLinks:r,hasLinks:d}},_n=P`
    mutation linkRemove($input: LinkInput!) {
  linkRemove(input: $input) {
    success
    errors {
      message
      field
    }
  }
}
    `;function Cn(s={}){return W(_n,s)}const $n={class:"flex flex-col gap-2"},Sn={key:0,class:"flex w-full flex-col rounded-lg bg-blue-200 px-2.5 dark:bg-gray-700"},wn=U({__name:"TicketLinks",props:{ticket:{},isTicketEditable:{type:Boolean}},setup(s,{expose:t}){const e=le(s,"ticket"),{hasLinks:i,linkTypesWithLinks:n,linkListIsLoading:l}=Tn(e,"Ticket"),{isTouchDevice:o}=nt(),{waitForVariantConfirmation:r}=He(),{notify:d}=ze(),k=async(c,C)=>{if(!e.value)return;new J(Cn({variables:{input:{sourceId:c,targetId:e.value.id,type:C}},update(m){var A,$;const v={objectId:(A=e.value)==null?void 0:A.id,targetType:"Ticket"},_=m.readQuery({query:Xe,variables:v});_&&m.writeQuery({query:Xe,data:{linkList:($=_==null?void 0:_.linkList)==null?void 0:$.filter(L=>!(L.item.id===c&&L.type===C))},variables:v})}}),{errorShowNotification:!1}).send().then(m=>{var v;(v=m==null?void 0:m.linkRemove)!=null&&v.success&&d({type:_e.Success,message:__("Link removed successfully")})})},f=async(c,C)=>{await r("delete")&&k(c,C)},I=ue({name:"ticket-link",component:()=>ce(()=>import("./TicketLinksFlyout-D2di-eBe.js"),__vite__mapDeps([57,6,2,3,4,7,1,5,8,9,10,11,12,13,14,18,19,20,21,22,23,24,25,26,16,27,28,29,30,31,32,33,58,59,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56]))}),p=()=>{I.open({sourceTicket:e})};return t({hasLinks:i}),(c,C)=>{const D=R("CommonLabel"),m=$e("tooltip");return u(),g(Ee,{loading:b(l)},{default:h(()=>[G("div",$n,[b(i)?(u(),w("div",Sn,[(u(!0),w(F,null,ie(b(n),(v,_)=>(u(),w("div",{key:v.id},[T(D,{size:"small",class:"text-stone-200! dark:text-neutral-500!"},{default:h(()=>[j(O(c.$t(v.label)),1)]),_:2},1024),(u(!0),w(F,null,ie(v.links,A=>(u(),w("div",{key:A.item.id,class:"group/link relative flex items-center"},[T(ot,{class:"h-12 items-center!",ticket:A.item,classes:{indicator:"mt-0",label:"mt-0 line-clamp-1"}},null,8,["ticket"]),c.isTicketEditable?(u(),g(H,{key:0,"aria-label":c.$t("Delete this link"),class:Q([{"opacity-0 transition-opacity":!b(o)},"text-white group-hover/link:opacity-100 focus:opacity-100"]),icon:"x-lg",size:"small",variant:"remove",onClick:we($=>f(A.item.id,A.type),["stop"])},null,8,["aria-label","class","onClick"])):E("",!0)]))),128)),_!==b(n).length-1?(u(),g(yi,{key:0})):E("",!0)]))),128))])):(u(),g(D,{key:1,size:"small"},{default:h(()=>[j(O(c.$t("No links added yet.")),1)]),_:1})),c.isTicketEditable?ae((u(),g(H,{key:2,size:"medium",class:"self-end",icon:"plus-square-fill",onClick:p},null,512)),[[m,c.$t("Add link")]]):E("",!0)])]),_:1},8,["loading"])}}}),Dn={class:"flex flex-col gap-2"},Ln={class:"flex w-full flex-col rounded-lg bg-blue-200 px-3 py-3.5 dark:bg-gray-700"},En={key:0,class:"flex flex-wrap gap-2 pt-2.5"},Vn=U({__name:"TicketSubscribers",props:{ticket:{}},setup(s){const a=le(s,"ticket"),{isSubscribed:e,isSubscriptionLoading:i,toggleSubscribe:n,subscribers:l,totalSubscribers:o}=Ui(a);let r=!1;ee(()=>e.value,()=>{r=!0,et(()=>{r=!1})});const d=async()=>r?!1:n();return(k,f)=>{const I=R("FormKit");return u(),w("div",Dn,[G("div",Ln,[G("div",{class:Q(["flex gap-2",{"border-b border-neutral-100 pb-2 dark:border-gray-900":b(l).length}])},[T(I,{type:"toggle","model-value":b(e),label:k.__("Subscribe me"),variants:{true:k.__("yes"),false:k.__("no")},disabled:b(i),"outer-class":"grow","wrapper-class":"!px-0 $remove:h-10",onInputRaw:d},null,8,["model-value","label","variants","disabled"])],2),b(o)>0?(u(),w("div",En,[(u(!0),w(F,null,ie(b(l),p=>(u(),g(st,{key:p.user.id,entity:p.user,access:p.access,size:"small"},null,8,["entity","access"]))),128))])):E("",!0)])])}}}),On=P`
    mutation tagAssignmentAdd($objectId: ID!, $tag: String!) {
  tagAssignmentAdd(objectId: $objectId, tag: $tag) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function An(s={}){return W(On,s)}const jn=P`
    mutation tagAssignmentRemove($objectId: ID!, $tag: String!) {
  tagAssignmentRemove(objectId: $objectId, tag: $tag) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function Un(s={}){return W(jn,s)}const Rn={class:"flex flex-col gap-2"},je=5,Pn=U({__name:"TicketTags",props:{ticket:{},isTicketEditable:{type:Boolean}},setup(s){const t=s,a=q(!1),e=y(()=>{var m,v;return(m=t.ticket)!=null&&m.tags&&t.ticket.tags.length>je&&!a.value?t.ticket.tags.slice(0,je):((v=t.ticket)==null?void 0:v.tags)??[]}),i=y(()=>{var m,v;return((v=(m=t.ticket)==null?void 0:m.tags)==null?void 0:v.length)??0}),n=()=>{a.value=!0};Jt(()=>{a.value=!1});const l=q(!1),o=()=>{l.value=!0,et(()=>{var v,_;const m=(_=(v=Dt("newTag"))==null?void 0:v.context)==null?void 0:_.activate;typeof m=="function"&&m()})},r=()=>{l.value=!1},d=new J(An({}),{errorNotificationMessage:__("Ticket tag could not be added.")}),k=m=>{t.ticket&&De().cache.modify({id:De().cache.identify(t.ticket),fields:{tags:()=>m}})},{notify:f}=ze(),I=m=>{var A;const v=m;if(!((A=t.ticket)!=null&&A.id)||!v||e.value.includes(v))return;const _=[...t.ticket.tags||[],v];k(_),_.length>je&&(a.value=!0),d.send({objectId:t.ticket.id,tag:v}).then(()=>{f({type:_e.Success,id:"ticket-tag-added-successfully",message:__("Ticket tag added successfully.")})})},p=new J(Un({}),{errorNotificationMessage:__("Ticket tag could not be removed.")}),c=m=>{var _;if(!((_=t.ticket)!=null&&_.id)||!e.value.includes(m))return;const v=(t.ticket.tags||[]).filter(A=>A!==m);k(v),p.send({objectId:t.ticket.id,tag:m}).then(()=>{f({type:_e.Success,id:"ticket-tag-removed-successfully",message:__("Ticket tag removed successfully.")})})},{isTouchDevice:C}=nt(),{config:D}=ye();return(m,v)=>{var z;const _=R("CommonLink"),A=R("CommonLabel"),$=R("FormKit"),L=$e("tooltip");return u(),w("div",Rn,[e.value.length?(u(),w("div",{key:0,class:Q(["flex w-full flex-col",{"rounded-lg bg-blue-200 px-2.5 dark:bg-gray-700":m.isTicketEditable}])},[(u(!0),w(F,null,ie(e.value,B=>(u(),w("div",{key:B,class:"group flex h-10 grow items-center gap-1.5"},[T(A,{class:"grow","prefix-icon":"tag"},{default:h(()=>[T(_,{class:"line-clamp-1 text-sm leading-snug",link:"#"},{default:h(()=>[j(O(B),1)]),_:2},1024)]),_:2},1024),m.isTicketEditable?ae((u(),g(H,{key:0,class:Q([{"opacity-0 transition-opacity":!b(C)},"group-hover:opacity-100 focus:opacity-100"]),icon:"x-lg",size:"small",variant:"remove",onClick:we(x=>c(B),["stop"])},null,8,["class","onClick"])),[[L,m.$t("Remove this tag")]]):E("",!0)]))),128)),!a.value&&i.value>je?(u(),g(Ot,{key:0,class:"mb-2.5 self-end",entities:e.value,"total-count":i.value,onClick:n},null,8,["entities","total-count"])):E("",!0)],2)):(u(),g(A,{key:1,size:"small"},{default:h(()=>[j(O(m.$t("No tags added yet.")),1)]),_:1})),l.value?(u(),g($,{key:2,id:"newTag",ref:"new-tag",type:"tags",label:m.__("Add tag"),"label-sr-only":!0,multiple:!1,"can-create":b(D).tag_new,exclude:(z=m.ticket)==null?void 0:z.tags,"on-deactivate":r,onInput:I},null,8,["label","can-create","exclude"])):m.isTicketEditable?ae((u(),g(H,{key:3,size:"medium",class:"self-end",icon:"plus-square-fill",onClick:o},null,512)),[[L,m.$t("Add tag")]]):E("",!0)])}}}),pt="ticket-merge",ft="ticket-change-customer",bt="ticket-history",zn=U({__name:"TicketSidebarInformationContent",props:se({context:{},sidebarPlugin:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=s,a=oe(s,"modelValue"),{ticket:e}=Ve(),{isTicketAgent:i,isTicketEditable:n}=wt(e),{open:l}=ue({name:pt,component:()=>ce(()=>import("./TicketMergeFlyout-DexMxunL.js"),__vite__mapDeps([60,2,3,4,6,7,1,5,8,9,10,11,12,13,14,61,18,19,20,21,22,23,24,25,26,16,27,28,29,30,31,32,33,58,59]))}),{open:o}=ue({name:bt,component:()=>ce(()=>import("./TicketHistoryFlyout-BhLoj9zT.js"),__vite__mapDeps([62,9,10,3,2,4,6,7,19,8,5,11,1,12,13,14,20,21,22,23,24,25,26,16,27,28,29,30,18,31,32,33,63]))}),{open:r}=ue({name:ft,component:()=>ce(()=>import("./TicketChangeCustomerFlyout-fDcamutV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]))}),d=y(()=>[{key:bt,label:__("History"),icon:"clock-history",show:()=>i.value,onClick:()=>o({ticket:e})},{key:pt,label:__("Merge"),icon:"merge",show:()=>i.value&&n.value,onClick:()=>l({ticket:e}),currentTaskbarTabId:t.context.currentTaskbarTabId},{key:ft,label:__("Change customer"),icon:"person",show:()=>i.value&&n.value,onClick:()=>r({ticket:e})}]);return(k,f)=>(u(),g(pe,{modelValue:a.value.scrollPosition,"onUpdate:modelValue":f[5]||(f[5]=I=>a.value.scrollPosition=I),title:k.sidebarPlugin.title,icon:k.sidebarPlugin.icon,actions:d.value},{default:h(()=>{var I,p,c,C;return[T(ve,{id:"ticket-attributes",modelValue:a.value.collapseAttributes,"onUpdate:modelValue":f[0]||(f[0]=D=>a.value.collapseAttributes=D),title:k.__("Attributes")},{default:h(()=>f[6]||(f[6]=[G("div",{id:"ticketEditAttributeForm"},null,-1)])),_:1},8,["modelValue","title"]),b(i)&&(b(n)||(p=(I=b(e))==null?void 0:I.tags)!=null&&p.length)?(u(),g(ve,{key:0,id:"ticket-tags",modelValue:a.value.collapseTags,"onUpdate:modelValue":f[1]||(f[1]=D=>a.value.collapseTags=D),title:k.__("Tags")},{default:h(()=>[T(Pn,{ticket:b(e),"is-ticket-editable":b(n)},null,8,["ticket","is-ticket-editable"])]),_:1},8,["modelValue","title"])):E("",!0),b(i)?ae((u(),g(ve,{key:1,id:"ticket-links",modelValue:a.value.collapseLinks,"onUpdate:modelValue":f[2]||(f[2]=D=>a.value.collapseLinks=D),title:k.__("Links")},{default:h(()=>[T(wn,{ref:"ticketLinksInstance",ticket:b(e),"is-ticket-editable":b(n)},null,8,["ticket","is-ticket-editable"])]),_:1},8,["modelValue","title"])),[[qe,b(n)||((c=k.$refs.ticketLinksInstance)==null?void 0:c.hasLinks)]]):E("",!0),(C=b(e))!=null&&C.timeUnit&&b(i)?(u(),g(ve,{key:2,id:"ticket-time-accounting",modelValue:a.value.collapseTimeAccounting,"onUpdate:modelValue":f[3]||(f[3]=D=>a.value.collapseTimeAccounting=D),title:k.__("Accounted Time")},{default:h(()=>[T(vn,{ticket:b(e)},null,8,["ticket"])]),_:1},8,["modelValue","title"])):E("",!0),b(i)?(u(),g(ve,{key:3,id:"ticket-subscribers",modelValue:a.value.collapseSubscribers,"onUpdate:modelValue":f[4]||(f[4]=D=>a.value.collapseSubscribers=D),title:k.__("Subscribers")},{default:h(()=>[T(Vn,{ticket:b(e)},null,8,["ticket"])]),_:1},8,["modelValue","title"])):E("",!0)]}),_:1},8,["modelValue","title","icon","actions"]))}}),Mn=U({__name:"TicketSidebarInformation",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const a=s,{persistentStates:e}=me(),i=y(()=>a.context.form),{isDirty:n}=Ai(i);return t("show"),(o,r)=>(u(),g(ke,{key:o.sidebar,sidebar:o.sidebar,"sidebar-plugin":o.sidebarPlugin,selected:o.selected,"update-indicator":b(n)},{default:h(()=>[T(zn,{modelValue:b(e),"onUpdate:modelValue":r[0]||(r[0]=d=>he(e)?e.value=d:null),context:o.context,"sidebar-plugin":o.sidebarPlugin},null,8,["modelValue","context","sidebar-plugin"])]),_:1},8,["sidebar","sidebar-plugin","selected","update-indicator"]))}}),Nn={title:__("Ticket"),component:Mn,permissions:["ticket.agent","ticket.customer"],screens:[N.TicketDetailView],icon:"chat-left-text",order:100},Fn=U({__name:"TicketSidebarOrganizationContent",props:se({organization:{},organizationMembers:{},objectAttributes:{},context:{},sidebarPlugin:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:se(["load-more-members"],["update:modelValue"]),setup(s){const t=oe(s,"modelValue"),a=[{key:"edit-organization",label:__("Edit Organization"),icon:"organization-edit",show:e=>e==null?void 0:e.policy.update,onClick:e=>{console.log(e,"Edit organization")}}];return(e,i)=>{const n=R("CommonLabel"),l=R("CommonLink");return u(),g(pe,{modelValue:t.value.scrollPosition,"onUpdate:modelValue":i[2]||(i[2]=o=>t.value.scrollPosition=o),title:e.sidebarPlugin.title,icon:e.sidebarPlugin.icon,entity:e.organization,actions:a},{default:h(()=>[T(l,{link:`/organizations/${e.organization.internalId}`,class:"flex gap-2"},{default:h(()=>[T(_t,{class:"p-3.5",entity:e.organization,size:"normal"},null,8,["entity"]),T(n,{size:"large",class:"dark:text-white!"},{default:h(()=>[j(O(e.organization.name),1)]),_:1})]),_:1},8,["link"]),T(St,{object:e.organization,attributes:e.objectAttributes,"skip-attributes":["name","vip","active"]},null,8,["object","attributes"]),T(At,{id:"organization-members",modelValue:t.value.collapseMembers,"onUpdate:modelValue":i[0]||(i[0]=o=>t.value.collapseMembers=o),type:b(Oe).User,label:e.__("Members"),entity:e.organizationMembers,onLoadMore:i[1]||(i[1]=o=>e.$emit("load-more-members"))},null,8,["modelValue","type","label","entity"])]),_:1},8,["modelValue","title","icon","entity"])}}}),Bn=U({__name:"TicketSidebarOrganization",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const a=s,{persistentStates:e}=me(),i=t,n=y(()=>Number(a.context.formValues.customer_id)),o=new de(zi(()=>({userInternalId:n.value,secondaryOrganizationsCount:3}),()=>({enabled:!!n.value,fetchPolicy:"cache-first"}))).result(),r=y(()=>{var c;return(c=o.value)==null?void 0:c.user});ee(r,c=>{if(!(c!=null&&c.organization)){i("hide");return}i("show")});const d=y(()=>{var c,C,D,m;return(c=a.context.formValues)!=null&&c.organization_id?Number((C=a.context.formValues)==null?void 0:C.organization_id):(m=(D=r.value)==null?void 0:D.organization)==null?void 0:m.internalId}),{organization:k,organizationMembers:f,objectAttributes:I,loadAllMembers:p}=Pi(d);return(c,C)=>(u(),g(ke,{key:c.sidebar,sidebar:c.sidebar,"sidebar-plugin":c.sidebarPlugin,selected:c.selected},{default:h(()=>[b(k)?(u(),g(Fn,{key:0,modelValue:b(e),"onUpdate:modelValue":C[0]||(C[0]=D=>he(e)?e.value=D:null),context:c.context,"sidebar-plugin":c.sidebarPlugin,organization:b(k),"organization-members":b(f),"object-attributes":b(I),onLoadMoreMembers:b(p)},null,8,["modelValue","context","sidebar-plugin","organization","organization-members","object-attributes","onLoadMoreMembers"])):E("",!0)]),_:1},8,["sidebar","sidebar-plugin","selected"]))}}),xn={title:__("Organization"),component:Bn,permissions:["ticket.agent"],screens:[N.TicketDetailView,N.TicketCreate],icon:"buildings",order:2e3,available:s=>!!(s.formValues.customer_id&&typeof s.formValues.customer_id=="number")},Ae=P`
    fragment ticketSharedDraftStartAttributes on TicketSharedDraftStart {
  id
  name
  updatedAt
  updatedBy {
    id
    internalId
    firstname
    lastname
    fullname
    email
    phone
    image
    outOfOffice
    outOfOfficeStartAt
    outOfOfficeEndAt
    active
  }
}
    `,Qn=P`
    query ticketSharedDraftStartList($groupId: ID!) {
  ticketSharedDraftStartList(groupId: $groupId) {
    ...ticketSharedDraftStartAttributes
  }
}
    ${Ae}`;function qn(s,t={}){return re(Qn,s,t)}const Gn=P`
    subscription ticketSharedDraftStartUpdateByGroup($groupId: ID!) {
  ticketSharedDraftStartUpdateByGroup(groupId: $groupId) {
    sharedDraftStarts {
      ...ticketSharedDraftStartAttributes
    }
  }
}
    ${Ae}`,Kn=(s,t)=>{const a=new de(qn(()=>({groupId:s.value}),{fetchPolicy:"cache-first"}),{errorCallback:t}),e=a.result(),i=a.loading(),n=y(()=>{var l;return(l=e.value)==null?void 0:l.ticketSharedDraftStartList});return a.subscribeToMore(()=>({document:Gn,variables:{groupId:s.value},updateQuery:(l,{subscriptionData:o})=>{var r,d;return(d=(r=o.data)==null?void 0:r.ticketSharedDraftStartUpdateByGroup)!=null&&d.sharedDraftStarts?{ticketSharedDraftStartList:o.data.ticketSharedDraftStartUpdateByGroup.sharedDraftStarts}:null}})),{loading:i,sharedDraftStartList:n,sharedDraftStartListQuery:a}},Hn=P`
    mutation ticketSharedDraftStartCreate($name: String!, $input: TicketSharedDraftStartInput!) {
  ticketSharedDraftStartCreate(name: $name, input: $input) {
    sharedDraft {
      ...ticketSharedDraftStartAttributes
    }
    errors {
      ...errors
    }
  }
}
    ${Ae}
${te}`;function Zn(s={}){return W(Hn,s)}const Wn=P`
    mutation ticketSharedDraftStartUpdate($sharedDraftId: ID!, $input: TicketSharedDraftStartInput!) {
  ticketSharedDraftStartUpdate(input: $input, sharedDraftId: $sharedDraftId) {
    sharedDraft {
      ...ticketSharedDraftStartAttributes
    }
    errors {
      ...errors
    }
  }
}
    ${Ae}
${te}`;function Yn(s={}){return W(Wn,s)}const Xn=P`
    mutation ticketSharedDraftStartDelete($sharedDraftId: ID!) {
  ticketSharedDraftStartDelete(sharedDraftId: $sharedDraftId) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function Jn(s={}){return W(Xn,s)}const ea=P`
    query ticketSharedDraftStartSingle($sharedDraftId: ID!) {
  ticketSharedDraftStartSingle(sharedDraftId: $sharedDraftId) {
    ...ticketSharedDraftStartAttributes
    content
  }
}
    ${Ae}`;function ta(s,t={}){return re(ea,s,t)}const ia=P`
    mutation ticketSharedDraftZoomDelete($sharedDraftId: ID!) {
  ticketSharedDraftZoomDelete(sharedDraftId: $sharedDraftId) {
    success
    errors {
      ...errors
    }
  }
}
    ${te}`;function sa(s={}){return W(ia,s)}const na=P`
    fragment ticketSharedDraftZoomAttributes on TicketSharedDraftZoom {
  id
  ticketId
  newArticle
  ticketAttributes
  updatedAt
  updatedBy {
    id
    internalId
    firstname
    lastname
    fullname
    email
    phone
    image
    outOfOffice
    outOfOfficeStartAt
    outOfOfficeEndAt
    active
  }
}
    `,aa=P`
    query ticketSharedDraftZoomShow($sharedDraftId: ID!) {
  ticketSharedDraftZoomShow(sharedDraftId: $sharedDraftId) {
    ...ticketSharedDraftZoomAttributes
  }
}
    ${na}`;function oa(s,t={}){return re(aa,s,t)}const ra=()=>{const s=(e,i)=>{const{article:n,...l}=(i==null?void 0:i.values)||{};return n&&(n.type=n.articleType,n.to=(n.to||[]).join(", "),n.cc=(n.cc||[]).join(", "),n.body=Lt(n.body)),{ticketId:e,formId:i==null?void 0:i.formId,newArticle:n||{},ticketAttributes:l}},t=ue({name:"shared-draft",component:()=>ce(()=>import("./TicketSharedDraftFlyout-D8RqO8NH.js"),__vite__mapDeps([64,6,2,3,4,7,8,9,10,5,11,14,19,1,12,13,20,21,22,23,24,25,26,16,27,28,29,30,18,31,32,33]))});return{mapSharedDraftParams:s,openSharedDraftFlyout:(e,i,n)=>{t.open({sharedDraftId:i,form:n,draftType:e,metaInformationQuery:e==="start"?ta:oa,deleteMutation:e==="start"?Jn:sa})}}},la={class:"py-1"},ca={key:0,class:"flex flex-col divide-y divide-solid divide-neutral-100 dark:divide-gray-900"},ua={class:"flex grow flex-col"},da={key:0},ma=U({__name:"TicketSidebarSharedDraftStartContent",props:se({sharedDraftStartList:{},context:{},sidebarPlugin:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=s,a=oe(s,"modelValue"),e=y(()=>Ue("Group",Number(t.context.formValues.group_id))),i=y(()=>Ue("Ticket::SharedDraftStart",Number(t.context.formValues.shared_draft_id))),n=q(""),{notify:l}=ze(),o=new J(Zn()),r=["articleSenderType","attachments","group_id","security","shared_draft_id","ticket_duplicate_detection"],d=()=>Object.fromEntries(Object.entries(t.context.formValues).filter(([v])=>!r.includes(v))),k=()=>({...d(),formSenderType:t.context.formValues.articleSenderType,cc:(t.context.formValues.cc||[]).join(", "),tags:(t.context.formValues.tags||[]).join(", "),body:Lt(t.context.formValues.body)}),f=vt(),I=y(()=>`sharedDraftTitle-${f.meta.taskbarTabEntityKey}`),p=async()=>{var _,A;const v=Dt(I.value);v&&(v.store.set(Ri({key:"submitted",value:!0,visible:!1})),!Object.keys(((_=v.context)==null?void 0:_.messages)||{}).length&&o.send({name:n.value.trim(),input:{formId:(A=t.context.form)==null?void 0:A.formId,groupId:e.value,content:k()}}).then(()=>{v.reset(),l({id:"shared-draft-created",type:_e.Success,message:__("Shared draft has been created successfully.")})}))},c=new J(Yn()),C=()=>{var v;i.value&&c.send({sharedDraftId:i.value,input:{formId:(v=t.context.form)==null?void 0:v.formId,groupId:e.value,content:k()}}).then(()=>{l({id:"shared-draft-updated",type:_e.Success,message:__("Shared draft has been updated successfully.")})})},{openSharedDraftFlyout:D}=ra(),m=v=>{D("start",v,t.context.form)};return(v,_)=>{const A=R("FormKit"),$=R("CommonLink"),L=R("CommonDateTime"),z=R("CommonLabel"),B=$e("tooltip");return u(),g(pe,{modelValue:a.value.scrollPosition,"onUpdate:modelValue":_[1]||(_[1]=x=>a.value.scrollPosition=x),title:v.sidebarPlugin.title,icon:v.sidebarPlugin.icon},{default:h(()=>{var x;return[T(A,{id:I.value,modelValue:n.value,"onUpdate:modelValue":_[0]||(_[0]=Y=>n.value=Y),type:"text",label:v.__("Create a shared draft"),placeholder:v.__("Name"),validation:"required:trim",link:"/","link-icon":"plus-square-fill","link-label":v.__("Create Shared Draft"),onLinkClick:we(p,["prevent"]),onKeypress:ei(we(p,["prevent"]),["enter"])},null,8,["id","modelValue","label","placeholder","link-label","onKeypress"]),G("div",la,[(x=v.sharedDraftStartList)!=null&&x.length?(u(),w("div",ca,[(u(!0),w(F,null,ie(v.sharedDraftStartList,Y=>(u(),w("div",{key:Y.id,class:"flex items-center gap-1.5 py-2.5"},[G("div",ua,[ae((u(),g($,{link:"#",class:"line-clamp-1","aria-label":v.$t("Preview Shared Draft"),onClick:we(Se=>m(Y.id),["prevent"])},{default:h(()=>[j(O(Y.name),1)]),_:2},1032,["aria-label","onClick"])),[[B,Y.name]]),T(z,{class:"line-clamp-1 text-stone-200! dark:text-neutral-500!",size:"small"},{default:h(()=>[T(L,{"date-time":Y.updatedAt},null,8,["date-time"]),Y.updatedBy?ae((u(),w("span",da,[j(" • "+O(Y.updatedBy.fullname),1)])),[[B,Y.updatedBy.fullname]]):E("",!0)]),_:2},1024)]),i.value===Y.id?ae((u(),g(H,{key:0,variant:"submit",size:"small",icon:"arrow-repeat",onClick:C},null,512)),[[B,v.__("Update Shared Draft")]]):E("",!0)]))),128))])):(u(),g(z,{key:1,class:"text-stone-200! dark:text-neutral-500!",size:"small"},{default:h(()=>[j(O(v.$t("No shared drafts yet")),1)]),_:1}))])]}),_:1},8,["modelValue","title","icon"])}}}),ka=U({__name:"TicketSidebarSharedDraftStart",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const a=s,{persistentStates:e}=me(),i=t,n=y(()=>Ue("Group",Number(a.context.formValues.group_id))),l=d=>d.type===mi.UnknownError?(i("hide"),!1):!0,{sharedDraftStartListQuery:o,sharedDraftStartList:r}=Kn(n,l);return o.onResult(({data:d})=>{d!=null&&d.ticketSharedDraftStartList&&i("show")}),(d,k)=>(u(),g(ke,{key:d.sidebar,sidebar:d.sidebar,"sidebar-plugin":d.sidebarPlugin,selected:d.selected},{default:h(()=>[b(r)?(u(),g(ma,{key:0,modelValue:b(e),"onUpdate:modelValue":k[0]||(k[0]=f=>he(e)?e.value=f:null),context:d.context,"sidebar-plugin":d.sidebarPlugin,"shared-draft-start-list":b(r)},null,8,["modelValue","context","sidebar-plugin","shared-draft-start-list"])):E("",!0)]),_:1},8,["sidebar","sidebar-plugin","selected"]))}}),pa={title:__("Shared Drafts"),component:ka,permissions:["ticket.agent"],screens:[N.TicketCreate],icon:"file-text",order:3e3,available:s=>!!s.formValues.group_id},fa=Symbol("article-context-key"),ba=()=>({context:Je(fa)});q({visible:!1,index:0,images:[]});const ga=s=>{const{showImage:t}=_i(s),a=ue({name:"common-calendar-preview",component:()=>ce(()=>import("./CommonCalendarPreviewFlyout-EsrCnnze.js"),__vite__mapDeps([65,56,8,2,3,4,9,10,6,7,5,11,66,18,19,1,12,13,14,20,21,22,23,24,25,26,16,27,28,29,30,31,32,33]))});return{showPreview:(i,n)=>{i==="image"&&t(n),i==="calendar"&&a.open({fileId:n.id,fileType:n.type,fileName:n.name})}}},va={key:0,class:"flex flex-col rounded-lg bg-blue-200 p-1 text-gray-100 dark:bg-gray-700 dark:text-neutral-400"},ha=U({__name:"TicketSidebarAttachmentContent",props:se({ticketAttachments:{},loading:{type:Boolean},context:{},sidebarPlugin:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=s,a=oe(s,"modelValue"),{attachments:e}=Mi({attachments:le(t,"ticketAttachments")}),{showPreview:i}=ga(y(()=>e.value));return(n,l)=>{const o=R("CommonLabel");return u(),g(pe,{modelValue:a.value.scrollPosition,"onUpdate:modelValue":l[0]||(l[0]=r=>a.value.scrollPosition=r),title:n.sidebarPlugin.title,icon:n.sidebarPlugin.icon},{default:h(()=>[T(Ee,{loading:n.loading},{default:h(()=>[n.ticketAttachments&&n.ticketAttachments.length>0?(u(),w("div",va,[(u(!0),w(F,null,ie(b(e),r=>(u(),g(Ci,{key:r.internalId,"download-url":r.downloadUrl,"preview-url":r.preview,file:r,"no-preview":!n.$c.ui_ticket_zoom_attachments_preview,"no-remove":"",onPreview:(d,k)=>b(i)(k,r)},null,8,["download-url","preview-url","file","no-preview","onPreview"]))),128))])):(u(),g(o,{key:1},{default:h(()=>[j(O(n.$t("No attached files")),1)]),_:1}))]),_:1},8,["loading"])]),_:1},8,["modelValue","title","icon"])}}}),ya=P`
    query ticketAttachments($ticketId: ID!) {
  ticketAttachments(ticketId: $ticketId) {
    id
    internalId
    name
    size
    type
    preferences
  }
}
    `;function Ia(s,t={}){return re(ya,s,t)}const Ta=s=>{const{ticketId:t}=Ve(),a=new de(Ia(()=>({ticketId:t.value}),{fetchPolicy:s})),e=a.result(),i=a.loading(),n=y(()=>{var l,o;return(l=e.value)!=null&&l.ticketAttachments?(o=e.value)==null?void 0:o.ticketAttachments:[]});return{ticketAttachmentsQuery:a,ticketAttachments:n,loading:i}},_a=U({__name:"TicketSidebarAttachment",props:{sidebar:{},selected:{type:Boolean},context:{},sidebarPlugin:{}},emits:["show","hide"],setup(s,{emit:t}){const{persistentStates:a}=me(),e=t,{ticketAttachments:i,ticketAttachmentsQuery:n,loading:l}=Ta(),{context:o}=ba();ee(o.articles,(d,k)=>{k!==void 0&&n.refetch()}),ee(i,d=>{if(d.length===0){e("hide");return}e("show")});const r=y(()=>{const d=__("Attachments");return{type:ne.Info,value:i.value.length,label:d}});return(d,k)=>(u(),g(ke,{key:d.sidebar,sidebar:d.sidebar,"sidebar-plugin":d.sidebarPlugin,selected:d.selected,badge:r.value},{default:h(()=>[T(ha,{modelValue:b(a),"onUpdate:modelValue":k[0]||(k[0]=f=>he(a)?a.value=f:null),context:d.context,"sidebar-plugin":d.sidebarPlugin,"ticket-attachments":b(i),loading:b(l)},null,8,["modelValue","context","sidebar-plugin","ticket-attachments","loading"])]),_:1},8,["sidebar","sidebar-plugin","selected","badge"]))}}),Ca={title:__("Attachments"),component:_a,permissions:["ticket.agent","ticket.customer"],screens:[N.TicketDetailView],icon:"paperclip",order:7e3,available:()=>{const{config:s}=ye();return s.ui_ticket_zoom_sidebar_article_attachments}},$a=Object.assign({"./checklist.ts":$s,"./customer.ts":Ps,"./github.ts":tn,"./gitlab.ts":nn,"./idoit.ts":fn,"./information.ts":Nn,"./organization.ts":xn,"./shared-draft-start.ts":pa,"./ticket-article-attachment.ts":Ca}),Sa=Object.entries($a).map(([s,t])=>[s.replace(/^.*\/([^/]+)\.ts$/,"$1"),t]).sort(([,s],[,t])=>s.order-t.order),wa=s=>{const{hasPermission:t}=It();return Sa.filter(([,a])=>t(a.permissions)&&a.screens.includes(s)).reduce((a,[e,i])=>(a[e]=i,a),{})},zt=Symbol("ticket-sidebar"),bo=s=>{const t=q({}),a=q(),e=k=>{t.value[k]=!0},i=k=>{t.value[k]=!1},n=k=>{a.value=k},l=wa(s.value.screenType),o=y(k=>{const f=Object.fromEntries(Object.entries(l).filter(([,I])=>typeof I.available=="function"?I.available(s.value):!0));return k&&Me(k,f)?k:f}),r=y(()=>{var f,I,p;if(!((f=Object.keys(o.value))!=null&&f.length))return null;if(a.value&&o.value[a.value]&&t.value[a.value])return a.value;const k=(p=(I=Object.entries(o.value).filter(([c])=>t.value[c]))==null?void 0:I[0])==null?void 0:p[0];return k===void 0?" ":k}),d=y(()=>!!r.value);ti(zt,{shownSidebars:t,activeSidebar:r,availableSidebarPlugins:o,sidebarPlugins:l,hasSidebar:d,showSidebar:e,hideSidebar:i,switchSidebar:n})},Da=()=>ii(zt),La={class:"flex h-full justify-end"},Ea={id:"ticketSidebar",class:"flex grow flex-col"},go=U({__name:"TicketSidebar",props:{context:{},isCollapsed:{type:Boolean},toggleCollapse:{type:Function}},setup(s){const t=s,{activeSidebar:a,availableSidebarPlugins:e,shownSidebars:i,showSidebar:n,hideSidebar:l,switchSidebar:o}=Da(),r=d=>{t.isCollapsed&&t.toggleCollapse(),o(d)};return(d,k)=>(u(),w("div",La,[ae(G("div",Ea,null,512),[[qe,!d.isCollapsed]]),G("div",{class:Q(["flex flex-col items-center gap-2.5 border-neutral-100 px-2.5 py-3 transition-[border] dark:border-gray-900",{"border-s":!d.isCollapsed}])},[(u(!0),w(F,null,ie(b(e),(f,I)=>ae((u(),g(yt(f.component),{key:I,selected:b(a)===I,sidebar:I,"sidebar-plugin":f,context:d.context,onClick:r,onShow:p=>b(n)(I),onHide:p=>b(l)(I)},null,40,["selected","sidebar","sidebar-plugin","context","onShow","onHide"])),[[qe,b(i)[I]]])),128))],2)]))}}),Va={class:"group flex grow cursor-pointer items-center"},Oa={class:"truncate"},vo=U({__name:"CommonDropdown",props:se({items:{},orientation:{default:"bottom"},actionLabel:{}},{modelValue:{},modelModifiers:{}}),emits:se(["handle-action"],["update:modelValue"]),setup(s,{emit:t}){const a=s,e=t,{popover:i,popoverTarget:n,isOpen:l,toggle:o}=Ct(),r=oi(),d=y(()=>{var c;return((c=r.localeData)==null?void 0:c.dir)===ri.Rtl?"start":"end"}),k=oe(s,"modelValue"),f=y(()=>{var c;return k.value?tt.t((c=k.value)==null?void 0:c.label):a.actionLabel}),I=c=>{k.value=c,o()},p=y(()=>a.items.map(c=>({...c,onClick:()=>e("handle-action",c)})));return(c,C)=>{const D=R("CommonIcon");return u(),w(F,null,[T($t,{ref_key:"popover",ref:i,owner:b(n),placement:d.value,orientation:c.orientation},{default:h(()=>[k.value?(u(),g(Ke,{key:0,popover:b(i),items:c.items},si({_:2},[ie(c.items,m=>({name:`item-${m.key}`,fn:h(()=>[G("div",Va,[T(Ii,{class:"flex grow items-center gap-2 p-2.5",label:m.label,variant:m.variant,link:m.link,icon:m.icon,"label-placeholder":m.labelPlaceholder,role:"checkbox","aria-checked":k.value.key===m.key,onClick:v=>I(m)},{leading:h(()=>[T(D,{class:Q({"opacity-0":k.value.key!==m.key}),size:"tiny",name:"check2"},null,8,["class"])]),_:2},1032,["label","variant","link","icon","label-placeholder","aria-checked","onClick"])])])}))]),1032,["popover","items"])):(u(),g(Ke,{key:1,popover:b(i),items:p.value},null,8,["popover","items"]))]),_:1},8,["owner","placement","orientation"]),T(H,ni(c.$attrs,{ref_key:"popoverTarget",ref:n,class:["group",{"hover:bg-blue-600! hover:text-black dark:hover:bg-blue-900! dark:hover:text-white":!b(l),"bg-blue-800! text-white! outline! outline-offset-1! outline-blue-800! hover:bg-blue-800!":b(l)}],size:"large",variant:"secondary",onClick:b(o)}),{label:h(()=>[G("span",Oa,O(f.value),1),T(D,{size:"small",decorative:"",class:Q(["pointer-events-none shrink-0 text-stone-200 dark:text-neutral-500 dark:group-hover:text-white",{"text-white dark:text-white":b(l),"group-hover:text-black dark:group-hover:text-white":!b(l)}]),name:"chevron-up"},null,8,["class"])]),_:1},16,["class","onClick"])],64)}}});export{fa as A,Pt as I,Xe as L,N as T,vo as _,co as a,ko as b,bo as c,Da as d,go as e,uo as f,na as g,ra as h,ot as i,Ve as j,ga as k,ba as l,po as m,In as n,fo as p,mo as u};
//# sourceMappingURL=CommonDropdown.vue_vue_type_script_setup_true_lang-DOCvnZ_a.js.map
