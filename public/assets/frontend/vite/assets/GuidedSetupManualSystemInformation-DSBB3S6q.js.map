{"version":3,"file":"GuidedSetupManualSystemInformation-DSBB3S6q.js","sources":["../../../../../app/frontend/apps/desktop/pages/guided-setup/graphql/mutations/setSystemInformation.api.ts","../../../../../app/frontend/apps/desktop/pages/guided-setup/views/GuidedSetupManual/GuidedSetupManualSystemInformation.vue"],"sourcesContent":["import * as Types from '#shared/graphql/types.ts';\n\nimport gql from 'graphql-tag';\nimport { ErrorsFragmentDoc } from '../../../../../../shared/graphql/fragments/errors.api';\nimport * as VueApolloComposable from '@vue/apollo-composable';\nimport * as VueCompositionApi from 'vue';\nexport type ReactiveFunction<TParam> = () => TParam;\n\nexport const GuidedSetupSetSystemInformationDocument = gql`\n    mutation guidedSetupSetSystemInformation($input: SystemInformation!) {\n  guidedSetupSetSystemInformation(input: $input) {\n    success\n    errors {\n      ...errors\n    }\n  }\n}\n    ${ErrorsFragmentDoc}`;\nexport function useGuidedSetupSetSystemInformationMutation(options: VueApolloComposable.UseMutationOptions<Types.GuidedSetupSetSystemInformationMutation, Types.GuidedSetupSetSystemInformationMutationVariables> | ReactiveFunction<VueApolloComposable.UseMutationOptions<Types.GuidedSetupSetSystemInformationMutation, Types.GuidedSetupSetSystemInformationMutationVariables>> = {}) {\n  return VueApolloComposable.useMutation<Types.GuidedSetupSetSystemInformationMutation, Types.GuidedSetupSetSystemInformationMutationVariables>(GuidedSetupSetSystemInformationDocument, options);\n}\nexport type GuidedSetupSetSystemInformationMutationCompositionFunctionResult = VueApolloComposable.UseMutationReturn<Types.GuidedSetupSetSystemInformationMutation, Types.GuidedSetupSetSystemInformationMutationVariables>;","<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport { shallowRef, computed, reactive } from 'vue'\nimport { useRouter } from 'vue-router'\n\nimport Form from '#shared/components/Form/Form.vue'\nimport type {\n  FormSubmitData,\n  FormValues,\n} from '#shared/components/Form/types.ts'\nimport { useBaseUrl } from '#shared/composables/useBaseUrl.ts'\nimport { useLogoUrl } from '#shared/composables/useLogoUrl.ts'\nimport { MutationHandler } from '#shared/server/apollo/handler/index.ts'\nimport { useApplicationStore } from '#shared/stores/application.ts'\n\nimport GuidedSetupActionFooter from '../../components/GuidedSetupActionFooter.vue'\nimport { useSystemSetup } from '../../composables/useSystemSetup.ts'\nimport { useGuidedSetupSetSystemInformationMutation } from '../../graphql/mutations/setSystemInformation.api.ts'\n\nimport type { SystemInformationData } from '../../types/setup-manual.ts'\n\nconst router = useRouter()\nconst application = useApplicationStore()\n\nconst { logoUrl } = useLogoUrl()\n\nconst { setTitle } = useSystemSetup()\nsetTitle(__('System Information'))\n\nconst systemInformationSchema = [\n  {\n    isLayout: true,\n    element: 'div',\n    attrs: {\n      class: 'grid gap-y-2.5',\n    },\n    children: [\n      {\n        name: 'organization',\n        label: __('Organization name'),\n        type: 'text',\n        required: true,\n        placeholder: __('Company Inc.'),\n      },\n      {\n        name: 'logo',\n        label: __('Organization logo'),\n        type: 'imageUpload',\n        props: {\n          placeholderImagePath: logoUrl,\n        },\n      },\n      {\n        if: '$isSystemOnlineService !== true',\n        name: 'url',\n        label: __('System URL'),\n        type: 'text',\n        required: true,\n        validation: 'url',\n        help: __('The URL of this installation of Zammad.'),\n      },\n    ],\n  },\n]\n\nconst { baseUrl } = useBaseUrl()\n\nconst initialValues: FormValues = {\n  organization: application.config.organization,\n  url: baseUrl.value,\n}\n\nconst form = shallowRef()\n\nconst isSystemOnlineService = computed(\n  () => application.config.system_online_service,\n)\n\nconst schemaData = reactive({\n  isSystemOnlineService,\n})\n\nconst dateTimeFormatOptions = Intl?.DateTimeFormat\n  ? new Intl.DateTimeFormat().resolvedOptions()\n  : null\n\nconst locale = dateTimeFormatOptions?.locale\nconst timezone = dateTimeFormatOptions?.timeZone\n\nconst setSystemInformation = async (formData: SystemInformationData) => {\n  const setSystemInformationMutation = new MutationHandler(\n    useGuidedSetupSetSystemInformationMutation({}),\n  )\n\n  return setSystemInformationMutation\n    .send({\n      input: {\n        organization: formData.organization,\n        logo: formData.logo,\n        url: formData.url,\n        localeDefault: locale,\n        timezoneDefault: timezone,\n      },\n    })\n    .then(() => {\n      if (application.config.system_online_service) {\n        router.push('/guided-setup/manual/channels/email-pre-configured')\n        return\n      }\n\n      router.push('/guided-setup/manual/email-notification')\n    })\n}\n</script>\n\n<template>\n  <Form\n    id=\"set-system-manual\"\n    ref=\"form\"\n    form-class=\"mb-2.5\"\n    :schema=\"systemInformationSchema\"\n    :schema-data=\"schemaData\"\n    :initial-values=\"initialValues\"\n    @submit=\"\n      setSystemInformation($event as FormSubmitData<SystemInformationData>)\n    \"\n  />\n  <GuidedSetupActionFooter\n    :form=\"form\"\n    :submit-button-text=\"__('Save and Continue')\"\n  />\n</template>\n"],"names":["GuidedSetupSetSystemInformationDocument","gql","ErrorsFragmentDoc","useGuidedSetupSetSystemInformationMutation","options","VueApolloComposable.useMutation","router","useRouter","application","useApplicationStore","logoUrl","useLogoUrl","setTitle","useSystemSetup","systemInformationSchema","baseUrl","useBaseUrl","initialValues","form","shallowRef","isSystemOnlineService","computed","schemaData","reactive","dateTimeFormatOptions","locale","timezone","setSystemInformation","formData","MutationHandler"],"mappings":"oyCAQO,MAAMA,EAA0CC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASjDC,CAAiB,GACP,SAAAC,EAA2CC,EAA2T,GAAI,CACjX,OAAAC,EAAuIL,EAAyCI,CAAO,CAChM,kECEA,MAAME,EAASC,IACTC,EAAcC,IAEd,CAAE,QAAAC,GAAYC,IAEd,CAAE,SAAAC,GAAaC,IACZD,EAAA,GAAG,oBAAoB,CAAC,EAEjC,MAAME,EAA0B,CAC9B,CACE,SAAU,GACV,QAAS,MACT,MAAO,CACL,MAAO,gBACT,EACA,SAAU,CACR,CACE,KAAM,eACN,MAAO,GAAG,mBAAmB,EAC7B,KAAM,OACN,SAAU,GACV,YAAa,GAAG,cAAc,CAChC,EACA,CACE,KAAM,OACN,MAAO,GAAG,mBAAmB,EAC7B,KAAM,cACN,MAAO,CACL,qBAAsBJ,CACxB,CACF,EACA,CACE,GAAI,kCACJ,KAAM,MACN,MAAO,GAAG,YAAY,EACtB,KAAM,OACN,SAAU,GACV,WAAY,MACZ,KAAM,GAAG,yCAAyC,CACpD,CACF,CACF,CAAA,EAGI,CAAE,QAAAK,GAAYC,IAEdC,EAA4B,CAChC,aAAcT,EAAY,OAAO,aACjC,IAAKO,EAAQ,KAAA,EAGTG,EAAOC,IAEPC,EAAwBC,EAC5B,IAAMb,EAAY,OAAO,qBAAA,EAGrBc,EAAaC,EAAS,CAC1B,sBAAAH,CAAA,CACD,EAEKI,EAAwB,iBAAM,eAChC,IAAI,KAAK,eAAe,EAAE,gBAC1B,EAAA,KAEEC,EAASD,GAAA,YAAAA,EAAuB,OAChCE,EAAWF,GAAA,YAAAA,EAAuB,SAElCG,EAAuB,MAAOC,GACG,IAAIC,EACvC1B,EAA2C,CAAA,CAAE,CAAA,EAI5C,KAAK,CACJ,MAAO,CACL,aAAcyB,EAAS,aACvB,KAAMA,EAAS,KACf,IAAKA,EAAS,IACd,cAAeH,EACf,gBAAiBC,CACnB,CAAA,CACD,EACA,KAAK,IAAM,CACN,GAAAlB,EAAY,OAAO,sBAAuB,CAC5CF,EAAO,KAAK,oDAAoD,EAChE,MACF,CAEAA,EAAO,KAAK,yCAAyC,CAAA,CACtD"}