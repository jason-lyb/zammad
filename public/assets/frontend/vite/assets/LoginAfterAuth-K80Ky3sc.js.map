{"version":3,"file":"LoginAfterAuth-K80Ky3sc.js","sources":["../../../../../app/frontend/apps/desktop/pages/authentication/views/LoginAfterAuth.vue"],"sourcesContent":["<!-- Copyright (C) 2012-2025 Zammad Foundation, https://zammad-foundation.org/ -->\n\n<script setup lang=\"ts\">\nimport { ref, nextTick, watch } from 'vue'\nimport { onBeforeRouteLeave, useRouter } from 'vue-router'\n\nimport LayoutPublicPage from '#desktop/components/layout/LayoutPublicPage/LayoutPublicPage.vue'\n\nimport { useAfterAuthPlugins } from '../after-auth/composable/useAfterAuthPlugins.ts'\n\nimport type { RouteLocationRaw } from 'vue-router'\n\ndefineOptions({\n  beforeRouteEnter(to) {\n    const { currentPlugin } = useAfterAuthPlugins()\n    if (!currentPlugin.value) {\n      return to.redirectedFrom ? false : '/'\n    }\n  },\n})\n\nconst { currentPlugin, data } = useAfterAuthPlugins()\n\nconst finished = ref(false)\n\nonBeforeRouteLeave(() => {\n  if (!finished.value) return false\n})\n\nwatch(\n  () => currentPlugin.value?.name,\n  (name) => {\n    if (name) {\n      finished.value = false\n    }\n  },\n)\n\nconst router = useRouter()\n\n// TODO 2023-05-17 Sheremet V.A. - call a query to get a possible next after auth handler\nconst redirect = async (route: RouteLocationRaw) => {\n  finished.value = true\n  await nextTick()\n  return router.replace(route)\n}\n</script>\n\n<template>\n  <LayoutPublicPage box-size=\"small\" :title=\"currentPlugin?.title\">\n    <div class=\"m-auto w-full max-w-md\">\n      <div class=\"flex grow flex-col justify-center\">\n        <div v-if=\"currentPlugin\" class=\"grow\">\n          <component\n            :is=\"currentPlugin.component\"\n            :data=\"data\"\n            @redirect=\"redirect\"\n          />\n        </div>\n      </div>\n    </div>\n  </LayoutPublicPage>\n</template>\n"],"names":["currentPlugin","data","useAfterAuthPlugins","finished","ref","onBeforeRouteLeave","watch","_a","name","router","useRouter","redirect","route","nextTick"],"mappings":"g9CAqBA,KAAM,CAAE,cAAAA,EAAe,KAAAC,CAAK,EAAIC,EAAoB,EAE9CC,EAAWC,EAAI,EAAK,EAE1BC,EAAmB,IAAM,CACnB,GAAA,CAACF,EAAS,MAAc,MAAA,EAAA,CAC7B,EAEDG,EACE,IAAM,OAAA,OAAAC,EAAAP,EAAc,QAAd,YAAAO,EAAqB,MAC1BC,GAAS,CACJA,IACFL,EAAS,MAAQ,GAErB,CAAA,EAGF,MAAMM,EAASC,IAGTC,EAAW,MAAOC,IACtBT,EAAS,MAAQ,GACjB,MAAMU,EAAS,EACRJ,EAAO,QAAQG,CAAK"}