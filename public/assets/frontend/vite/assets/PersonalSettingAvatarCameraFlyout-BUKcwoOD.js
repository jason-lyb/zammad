import{f as B,r as H,aH as V,c as b,ba as j,w as N,a1 as C,m as r,D as i,y as s,I as c,U as k,V as w,p as y,q as P,u as x,E as U,Q as m,M as l}from"./vue-oicRkvo0.js";import{c as I}from"./desktop-l0eJ1dZN.js";import{_ as q}from"./CommonFlyout.vue_vue_type_script_setup_true_lang-Cr1ukr3s.js";import{l as z}from"./overviewAttributes.api-C09LSZ8O.js";import"./vendor-C11O1Xx8.js";import"./commonjsHelpers-BosuxZz1.js";import"./routes-CgLO9M4y.js";import"./vite-FJshFMF2.js";import"./apollo-Cj5TVUDk.js";import"./lodash-pFOI14f-.js";import"./Form.vue_vue_type_script_setup_true_lang-B6L-6HzY.js";import"./formkit-5nol1GBe.js";import"./FormGroup.vue_vue_type_script_setup_true_lang-DIx-HUKU.js";import"./useForm-CUKec4n5.js";import"./useCopyToClipboard-CjkPg__g.js";import"./theme-Bv2ClBzZ.js";import"./datepicker-BBNcWeHz.js";import"./date-B2UyDZN7.js";import"./autocompleteTags.api-CG5-cm_A.js";import"./autocompleteSearchTicket.api-DfOQWGlO.js";import"./ticketUpdates.api-BhGIG_Ti.js";import"./ticketAttributes.api-rqx5ITab.js";import"./useTicketCreateArticleType-D7iVcJ_6.js";import"./types-Cu-Nkl7K.js";import"./useTicketCreateView-HCH46SPv.js";import"./CommonOverlayContainer.vue_vue_type_script_setup_true_lang-CxyKmNUC.js";import"./LayoutSidebar.vue_vue_type_script_setup_true_lang-BO1pkKrb.js";import"./useFlyout-KZXqW5RR.js";const F={class:"flex flex-col items-center gap-6 pt-12 pb-10"},O={class:"h-64 min-h-64 w-64 min-w-64 rounded-full border border-black dark:border-white"},E={key:0,class:"relative h-64 min-h-64 w-64 min-w-64 overflow-hidden rounded-full border border-black bg-blue-200 text-stone-200 dark:border-white dark:bg-gray-700 dark:text-neutral-500"},L=["aria-label","srcObject"],M={key:2,class:"flex flex-row gap-2"},S=256,d=256,R=B({__name:"PersonalSettingAvatarCameraFlyout",emits:["avatar-captured"],setup(W){const a=H(),u=V("camera"),n=b(()=>!u.value||u.value==="denied"),$=b(()=>n.value?"camera-video-off":"camera-video"),{stream:p,start:v,stop:f}=j({constraints:{video:{width:256,height:256}}});n.value||v();const h=()=>{const e=document.querySelector("canvas");if(e)return e},g=e=>{if(!e)return;const t=e.getContext("2d");if(t)return t},_=()=>{var t;a.value&&(a.value=void 0);const e=h();e&&((t=g(e))==null||t.clearRect(0,0,e.width,e.height))};N(n,e=>{if(e){_(),f();return}v()});const A=()=>{if(!p.value)return;const e=h();if(!e)return;const t=g(e);if(!t)return;e.width=d,e.height=S;const o=document.querySelector("video");o&&(t.translate(d,0),t.scale(-1,1),t.drawImage(o,(o.videoWidth-o.videoHeight)/2,0,o.videoHeight,o.videoHeight,0,0,d,S),a.value={content:e.toDataURL("image/png"),name:"avatar.png",type:"image/png"})};return(e,t)=>{const o=C("CommonIcon"),D=C("CommonAlert");return r(),i(q,{"header-title":e.__("Camera"),"footer-action-options":{actionLabel:e.__("Save"),actionButton:{variant:"submit",disabled:!a.value}},"header-icon":"camera",name:"avatar-camera-capture",onAction:t[0]||(t[0]=Q=>e.$emit("avatar-captured",a.value)),onClose:x(f)},{default:s(()=>[c("div",F,[k(c("canvas",O,null,512),[[w,a.value]]),a.value?U("",!0):(r(),y("div",E,[P(o,{name:$.value,size:"xl",class:"absolute top-1/2 -translate-y-1/2 ltr:left-1/2 ltr:-translate-x-1/2 rtl:right-1/2 rtl:translate-x-1/2"},null,8,["name"]),k(c("video",{class:"h-full w-full object-cover","aria-label":e.$t("Use the camera to take a photo for the avatar."),srcObject:x(p),autoplay:""},null,8,L),[[w,!n.value]])])),n.value?(r(),i(D,{key:1,variant:"danger"},{default:s(()=>[m(l(e.$t("Accessing your camera is forbidden. Please check your settings.")),1)]),_:1})):(r(),y("div",M,[a.value?(r(),i(I,{key:1,variant:"remove",size:"medium",onClick:_},{default:s(()=>[m(l(e.$t("Discard Snapshot")),1)]),_:1})):(r(),i(I,{key:0,variant:"primary",size:"medium",onClick:A},{default:s(()=>[m(l(e.$t("Capture From Camera")),1)]),_:1}))]))])]),_:1},8,["header-title","footer-action-options","onClose"])}}}),ke=z(R,[["__scopeId","data-v-149df943"]]);export{ke as default};
//# sourceMappingURL=PersonalSettingAvatarCameraFlyout-BUKcwoOD.js.map
