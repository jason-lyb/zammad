import{_ as T}from"./Form.vue_vue_type_script_setup_true_lang-B6L-6HzY.js";import{u as h}from"./useForm-CUKec4n5.js";import{n as w}from"./vendor-C11O1Xx8.js";import{T as F,U as l}from"./PersonalSettingTokenAccess-BWcVhEA-.js";import{X as U,Y as $}from"./overviewAttributes.api-C09LSZ8O.js";import{e as L,M as g}from"./apollo-Cj5TVUDk.js";import{r as M}from"./routes-CgLO9M4y.js";import{_ as N}from"./CommonFlyout.vue_vue_type_script_setup_true_lang-Cr1ukr3s.js";import{c as P}from"./useFlyout-KZXqW5RR.js";import{_ as q}from"./CommonInputCopyToClipboard.vue_vue_type_script_setup_true_lang-CO4uQ3Xg.js";import{f as x,r as B,c as D,a1 as I,m as i,D as d,y as f,p as S,q as k,Q as V,M as E,u as m}from"./vue-oicRkvo0.js";import"./formkit-5nol1GBe.js";import"./FormGroup.vue_vue_type_script_setup_true_lang-DIx-HUKU.js";import"./lodash-pFOI14f-.js";import"./commonjsHelpers-BosuxZz1.js";import"./vite-FJshFMF2.js";import"./desktop-l0eJ1dZN.js";import"./useCopyToClipboard-CjkPg__g.js";import"./theme-Bv2ClBzZ.js";import"./datepicker-BBNcWeHz.js";import"./date-B2UyDZN7.js";import"./autocompleteTags.api-CG5-cm_A.js";import"./autocompleteSearchTicket.api-DfOQWGlO.js";import"./ticketUpdates.api-BhGIG_Ti.js";import"./ticketAttributes.api-rqx5ITab.js";import"./useTicketCreateArticleType-D7iVcJ_6.js";import"./types-Cu-Nkl7K.js";import"./useTicketCreateView-HCH46SPv.js";import"./LayoutContent.vue_vue_type_script_setup_true_lang-SafgfcNL.js";import"./LayoutMain.vue_vue_type_script_setup_true_lang-DIWzj6-0.js";import"./LayoutSidebar.vue_vue_type_script_setup_true_lang-BO1pkKrb.js";import"./useResizeGridColumns-CieKHty_.js";import"./useBreadcrumb-DUhE6wbZ.js";import"./CommonOverlayContainer.vue_vue_type_script_setup_true_lang-CxyKmNUC.js";const O=w`
    mutation userCurrentAccessTokenAdd($input: UserAccessTokenInput!) {
  userCurrentAccessTokenAdd(input: $input) {
    token {
      ...tokenAttributes
    }
    tokenValue
    errors {
      ...errors
    }
  }
}
    ${F}
${U}`;function Q(u={}){return L(O,u)}const Y={key:0,class:"flex flex-col gap-3"},we=x({__name:"PersonalSettingNewAccessTokenFlyout",setup(u){const{form:s}=h(),_=$([{type:"text",name:"name",label:__("Name"),required:!0},{type:"date",name:"expires_at",label:__("Expiration date"),props:{futureOnly:!0}},{type:"permissions",name:"permissions",label:"Permissions",props:{options:[]},required:!0}]),y=new g(Q({update:(o,{data:e})=>{var c;if(!e)return;const{userCurrentAccessTokenAdd:r}=e;if(!(r!=null&&r.token))return;let t=o.readQuery({query:l});(c=t==null?void 0:t.userCurrentAccessTokenList)!=null&&c.find(v=>{var p;return v.id===((p=r.token)==null?void 0:p.id)})||(t={...t,userCurrentAccessTokenList:[r.token,...(t==null?void 0:t.userCurrentAccessTokenList)||[]]},o.writeQuery({query:l,data:t}))}}),{errorNotificationMessage:__("The access token could not be created.")}),n=B(""),A=o=>y.send({input:{name:o.name,expiresAt:o.expires_at,permission:o.permissions}}).then(e=>{var r;(r=e==null?void 0:e.userCurrentAccessTokenAdd)!=null&&r.tokenValue&&(n.value=e.userCurrentAccessTokenAdd.tokenValue)}),C=D(()=>n.value?{actionLabel:__("OK, I have copied my token"),actionButton:{variant:"primary"},hideCancelButton:!0}:{actionLabel:__("Create"),actionButton:{variant:"submit",type:"submit"},form:s.value}),b=()=>{n.value&&P("new-access-token")};return(o,e)=>{var t;const r=I("CommonLabel");return i(),d(N,{"header-title":o.__("New Personal Access Token"),"footer-action-options":C.value,"header-icon":"key","no-close-on-action":"",name:"new-access-token",onAction:e[1]||(e[1]=a=>b()),onActivated:(t=m(s))==null?void 0:t.triggerFormUpdater},{default:f(()=>[n.value?(i(),S("div",Y,[k(r,null,{default:f(()=>[V(E(o.$t("For security reasons, the API token is shown only once. You'll need to save it somewhere secure before continuing.")),1)]),_:1}),k(q,{value:n.value,label:o.__("Your Personal Access Token"),"copy-button-text":o.__("Copy Token")},null,8,["value","label","copy-button-text"])])):(i(),d(T,{key:1,ref_key:"form",ref:s,schema:m(_),"form-updater-id":m(M).FormUpdaterUpdaterUserCurrentNewAccessToken,"form-updater-initial-only":"","should-autofocus":"",onSubmit:e[0]||(e[0]=a=>A(a))},null,8,["schema","form-updater-id"]))]),_:1},8,["header-title","footer-action-options","onActivated"])}}});export{we as default};
//# sourceMappingURL=PersonalSettingNewAccessTokenFlyout-DP1QVHe4.js.map
